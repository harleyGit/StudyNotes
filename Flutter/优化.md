> </h>
- [UIä¼˜åŒ–](#UIä¼˜åŒ–)
	- [widgetå¤ç”¨ä¼˜åŒ–](#widgetå¤ç”¨ä¼˜åŒ–)
		- [é¿å…ä¸å¿…è¦çš„setState()](#é¿å…ä¸å¿…è¦çš„setState()) 
		- [ä½¿ç”¨constæ„é€ å‡½æ•°](#ä½¿ç”¨constæ„é€ å‡½æ•°) 
		- [constä¿®é¥°StatelessWidget](#constä¿®é¥°StatelessWidget) 
		- [å±€éƒ¨UIå˜åŒ–ï¼Œä½¿ç”¨ValueListenableBuilderä»£æ›¿setState](#å±€éƒ¨UIå˜åŒ–ï¼Œä½¿ç”¨ValueListenableBuilderä»£æ›¿setState)
		- [ListView.builderä»£æ›¿ListView](#ListView.builderä»£æ›¿ListView)	
		- [ä½¿ç”¨`AutomaticKeepAliveClientMixin`ä¿æŒé¡µé¢çŠ¶æ€](#ä½¿ç”¨`AutomaticKeepAliveClientMixin`ä¿æŒé¡µé¢çŠ¶æ€)	
		- [ä½¿ç”¨ `RepaintBoundary` å‡å°‘é‡ç»˜](#ä½¿ç”¨`RepaintBoundary`å‡å°‘é‡ç»˜)
	- [è€—æ—¶æ“ä½œ](#è€—æ—¶æ“ä½œ)
		- [compute](#compute)
	- [åˆç†åˆ·æ–°èŒƒå›´](#åˆç†åˆ·æ–°èŒƒå›´)
	- [å†…å­˜å›¾ç‰‡ä¼˜åŒ–](#å†…å­˜å›¾ç‰‡ä¼˜åŒ–)
		- [æ»šå‡ºå±å¹•çš„åŠ¨å›¾æš‚åœæ’­æ”¾](#æ»šå‡ºå±å¹•çš„åŠ¨å›¾æš‚åœæ’­æ”¾)



<br/><br/><br/><br/><br/>

***
<br/>

> <h1 id='UIä¼˜åŒ–'>UIä¼˜åŒ–</h1>
<br/>

> <h2 id="widgetå¤ç”¨ä¼˜åŒ–">widgetå¤ç”¨ä¼˜åŒ–</h2>
><h3  id="é¿å…ä¸å¿…è¦çš„setState()">é¿å…ä¸å¿…è¦çš„ `setState()</h3>

**é”™è¯¯å†™æ³•ï¼ˆæ•´ä¸ª `build()` æ–¹æ³•éƒ½åœ¨ `setState` å†…ï¼‰**

```dart
@override
Widget build(BuildContext context) {
  setState(() {  // âŒ è¿™é‡Œä¸åº”è¯¥åŒ…è£¹æ•´ä¸ª `build`
    counter++;
    text = "Counter is $counter";
  });

  return Scaffold(
    body: Center(child: Text(text)),
    floatingActionButton: FloatingActionButton(
      onPressed: () {}, // è¿™é‡Œ `onPressed` ä¸ºç©º
    ),
  );
}
```

âŒ é—®é¢˜ï¼š

- æ¯æ¬¡ build() è¢«è°ƒç”¨éƒ½ä¼šè§¦å‘ setState()ï¼Œç„¶å setState è§¦å‘ build()ï¼Œå¯¼è‡´æ— é™é‡å»ºï¼ˆæ­»å¾ªç¯ï¼‰ã€‚
- Flutter åªéœ€è¦åœ¨çŠ¶æ€æ›´æ–°æ—¶é‡å»º UIï¼Œè€Œä¸æ˜¯ä¸€ç›´æ›´æ–°çŠ¶æ€ã€‚

<br/><br/>
**æ­£ç¡®çš„åšæ³•æ˜¯ï¼š**

```dart
@override
Widget build(BuildContext context) {
  return Scaffold(
    body: Center(child: Text(text)),
    floatingActionButton: FloatingActionButton(
      onPressed: () {
	      setState(() {  // âœ… `setState` åªåŒ…è£¹çŠ¶æ€æ›´æ–°éƒ¨åˆ†
		      counter++;
		      text = "Counter is $counter";
	      });
      }, // è¿™é‡Œ `onPressed` ä¸ºç©º
    ),
  );
}
```

<br/><br/>
> <h3  id="ä½¿ç”¨constæ„é€ å‡½æ•°">ä½¿ç”¨constæ„é€ å‡½æ•°</h3>
å¦‚æœä¸€ä¸ª Widget **ä¸ä¾èµ–å¤–éƒ¨çŠ¶æ€å˜åŒ–**ï¼Œå¯ä»¥ç”¨ `const`ï¼ŒFlutter å°±ä¸ä¼šé‡æ–°åˆ›å»ºå®ƒï¼š

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return const MaterialApp(
      home: MyHomePage(),
    );
  }
}

class MyHomePage extends StatefulWidget {
  const MyHomePage({Key? key}) : super(key: key);

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  int counter = 0;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("Flutter const ä¼˜åŒ–ç¤ºä¾‹")),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            // âœ… ä½¿ç”¨ constï¼Œé¿å…ä¸å¿…è¦çš„é‡å»º
            const Text(
              "å›ºå®šæ–‡æœ¬ï¼Œä¸ä¼šå›  setState é‡æ–°åˆ›å»º",
              style: TextStyle(fontSize: 16),
            ),
            const SizedBox(height: 20),

            // âŒ è¿™é‡Œçš„ Text ä¼šåœ¨ setState æ—¶é‡æ–°åˆ›å»º
            Text(
              "è®¡æ•°: $counter",
              style: const TextStyle(fontSize: 24),
            ),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          setState(() {
            counter++;
          });
        },
        child: const Icon(Icons.add),
      ),
    );
  }
}
```


<br/><br/>
><h3  id="constä¿®é¥°StatelessWidget">constä¿®é¥°StatelessWidget</h3>

**ğŸ“Œ ä¸ºä»€ä¹ˆ `const` å¯ä»¥ä¼˜åŒ–æ€§èƒ½ï¼Ÿ**
Flutter é‡‡ç”¨ **"Widget æ ‘æ¯”å¯¹ (Widget Reconciliation)"** æœºåˆ¶ï¼Œæ¥å†³å®šå“ªäº› Widget éœ€è¦è¢«é‡å»ºï¼Œå“ªäº›å¯ä»¥å¤ç”¨ã€‚  

**å¦‚æœ Widget æ˜¯ `const`ï¼ŒFlutter å‘ç°å®ƒçš„å‚æ•°æ²¡æœ‰å˜åŒ–ï¼Œå°±ä¸ä¼šé‡æ–°åˆ›å»ºå®ƒï¼Œç›´æ¥å¤ç”¨æ—§çš„å®ä¾‹ã€‚**

---

- **ğŸ“ ç¤ºä¾‹ï¼šæœªä¼˜åŒ–ï¼ˆæ¯æ¬¡éƒ½é‡æ–°åˆ›å»º Widgetï¼‰**

```dart
class MyWidget extends StatelessWidget {
  final String text;
  
  const MyWidget({Key? key, required this.text}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    print("MyWidget è¢«é‡å»ºäº†: $text");
    return Text(text);
  }
}

class MyHomePage extends StatefulWidget {
  const MyHomePage({Key? key}) : super(key: key);

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  int counter = 0;

  @override
  Widget build(BuildContext context) {
    print("MyHomePage build() è¢«è°ƒç”¨");

    return Scaffold(
      appBar: AppBar(title: const Text("Flutter const ä¼˜åŒ–ç¤ºä¾‹")),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            // è¿™ä¸ª Widget ä¾èµ– counterï¼Œæ¯æ¬¡ setState éƒ½ä¼šé‡å»º
            Text("è®¡æ•°: $counter"),

            // è¿™é‡Œ MyWidget æ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ›å»º
            MyWidget(text: "æˆ‘æ˜¯ä¸ä¼šå˜çš„ï¼"),  
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          setState(() {
            counter++;
          });
        },
        child: const Icon(Icons.add),
      ),
    );
  }
}
```
- **ğŸ” è¿è¡Œç»“æœ**

ç‚¹å‡» `FloatingActionButton`ï¼š

```bash
MyHomePage build() è¢«è°ƒç”¨
MyWidget è¢«é‡å»ºäº†: æˆ‘æ˜¯ä¸ä¼šå˜çš„ï¼
```
**âŒ å³ä½¿ `MyWidget(text: "æˆ‘æ˜¯ä¸ä¼šå˜çš„ï¼")` çš„å†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œä»ç„¶ä¼šè¢«é‡å»ºï¼**

---

- **âœ… ä½¿ç”¨ `const` ä¼˜åŒ–ï¼ˆé¿å… Widget é‡æ–°åˆ›å»ºï¼‰**

```dart
class MyHomePage extends StatefulWidget {
  const MyHomePage({Key? key}) : super(key: key);

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  int counter = 0;

  @override
  Widget build(BuildContext context) {
    print("MyHomePage build() è¢«è°ƒç”¨");

    return Scaffold(
      appBar: AppBar(title: const Text("Flutter const ä¼˜åŒ–ç¤ºä¾‹")),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Text("è®¡æ•°: $counter"),

            // âœ… è¿™é‡ŒåŠ ä¸Š constï¼ŒFlutter å‘ç° text æ²¡å˜ï¼Œå°±ä¸ä¼šé‡å»º
            const MyWidget(text: "æˆ‘æ˜¯ä¸ä¼šå˜çš„ï¼"),  
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          setState(() {
            counter++;
          });
        },
        child: const Icon(Icons.add),
      ),
    );
  }
}
```
- **ğŸ§ è¿è¡Œç»“æœ**

ç‚¹å‡» `FloatingActionButton`ï¼š

```bash
MyHomePage build() è¢«è°ƒç”¨
```
**âœ… ç°åœ¨ `MyWidget` æ²¡æœ‰é‡æ–°åˆ›å»ºï¼ŒFlutter ç›´æ¥å¤ç”¨äº†æ—§çš„ Widgetï¼**

è¿™æ ·**åªè¦å‚æ•°ç›¸åŒï¼ŒFlutter å°±ä¸ä¼šé‡æ–°åˆ›å»ºè¯¥ Widget**ï¼Œæé«˜æ€§èƒ½ã€‚

<br/><br/>
><h3 id="å±€éƒ¨UIå˜åŒ–ï¼Œä½¿ç”¨ValueListenableBuilderä»£æ›¿setState">å±€éƒ¨UIå˜åŒ–ï¼Œä½¿ç”¨ValueListenableBuilderä»£æ›¿setState</h3>
å¦‚æœåªæ˜¯å±€éƒ¨ UI å˜åŒ–ï¼Œå¯ä»¥ç”¨ `ValueListenableBuilder`ï¼Œé¿å…é‡å»ºæ•´ä¸ª Widgetï¼š

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return const MaterialApp(
      home: MyHomePage(),
    );
  }
}

class MyHomePage extends StatefulWidget {
  const MyHomePage({Key? key}) : super(key: key);

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  // ä½¿ç”¨ ValueNotifier æ¥ç®¡ç†çŠ¶æ€
  final ValueNotifier<int> _counter = ValueNotifier<int>(0);

  @override
  Widget build(BuildContext context) {
    print("ğŸ”„ MyHomePage build() è¢«è°ƒç”¨");

    return Scaffold(
      appBar: AppBar(title: const Text("ValueListenableBuilder ç¤ºä¾‹")),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            // è¿™é‡Œçš„ Widget ä¸ä¼šé‡æ–°æ„å»º
            const Text(
              "è¿™ä¸ªæ–‡æœ¬ä¸ä¼šå› è®¡æ•°å™¨å˜åŒ–è€Œé‡æ–°æ„å»º",
              style: TextStyle(fontSize: 16),
            ),
            const SizedBox(height: 20),

            // âœ… åªä¼šæ›´æ–° Text ç»„ä»¶ï¼Œè€Œä¸ä¼šé‡å»ºæ•´ä¸ª Column
            ValueListenableBuilder<int>(
              valueListenable: _counter,
              builder: (context, value, child) {
                print("ğŸ”„ ä»… Text ç»„ä»¶é‡æ–°æ„å»º");
                return Text(
                  "è®¡æ•°: $value",
                  style: const TextStyle(fontSize: 24),
                );
              },
            ),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          _counter.value += 1; // âœ… ä»…æ›´æ–° ValueNotifierï¼Œä¸å½±å“æ•´ä¸ª Widget
        },
        child: const Icon(Icons.add),
      ),
    );
  }

  @override
  void dispose() {
    _counter.dispose(); // é‡Šæ”¾èµ„æº
    super.dispose();
  }
}
```

<br/><br/>
><h3  id="ListView.builderä»£æ›¿ListView"> âœ… ListView.builderä»£æ›¿ListView</h3>
é”™è¯¯ï¼š

```dart
ListView(
  children: items.map((item) => ListTile(title: Text(item))).toList(),
);
```
ä¼˜åŒ–ï¼š

```dart
ListView.builder(
  itemCount: items.length,
  itemBuilder: (context, index) {
    return ListTile(title: Text(items[index]));
  },
);
```
è¿™æ · Flutter **ä¸ä¼šä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰å­ Widget**ï¼Œè€Œæ˜¯**æŒ‰éœ€åŠ è½½**ã€‚

<br/><br/>
><h3  id="ä½¿ç”¨`AutomaticKeepAliveClientMixin`ä¿æŒé¡µé¢çŠ¶æ€"> âœ… ä½¿ç”¨`AutomaticKeepAliveClientMixin`ä¿æŒé¡µé¢çŠ¶æ€</h3>
é»˜è®¤æƒ…å†µä¸‹ï¼ŒTab åˆ‡æ¢æ—¶é¡µé¢ä¼šè¢«é”€æ¯ï¼Œå¯ä»¥ä½¿ç”¨ 

`AutomaticKeepAliveClientMixin` è®©é¡µé¢ä¿æŒçŠ¶æ€ï¼š

```dart
class MyPage extends StatefulWidget {
  @override
  _MyPageState createState() => _MyPageState();
}

class _MyPageState extends State<MyPage> with AutomaticKeepAliveClientMixin {
  @override
  bool get wantKeepAlive => true; // ä¿æŒçŠ¶æ€

  @override
  Widget build(BuildContext context) {
    super.build(context); // å¿…é¡»è°ƒç”¨ super.build
    return Text("é¡µé¢ä¸ä¼šè¢«é”€æ¯");
  }
}
```

<br/><br/>
><h3  id="ä½¿ç”¨`RepaintBoundary`å‡å°‘é‡ç»˜"> âœ…ä½¿ç”¨`RepaintBoundary`å‡å°‘é‡ç»˜</h3>
å¦‚æœæŸä¸ª Widget **ä¸ä¼šé¢‘ç¹æ›´æ–°**ï¼Œå¯ä»¥ç”¨ `RepaintBoundary`ï¼Œè®© Flutter **åªé‡ç»˜å˜åŒ–çš„éƒ¨åˆ†**ï¼š
- åŠ  RepaintBoundary â†’ setState() å¯èƒ½å¯¼è‡´æ•´ä¸ªå±å¹•é‡ç»˜
- åŠ ä¸Š RepaintBoundary â†’ åªé‡ç»˜å¿…è¦çš„éƒ¨åˆ†

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return const MaterialApp(
      debugShowCheckedModeBanner: false,
      home: MyHomePage(),
    );
  }
}

class MyHomePage extends StatefulWidget {
  const MyHomePage({Key? key}) : super(key: key);

  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  final ValueNotifier<int> _counter = ValueNotifier<int>(0);

  @override
  Widget build(BuildContext context) {
    print("ğŸ”„ MyHomePage build() è¢«è°ƒç”¨");

    return Scaffold(
      appBar: AppBar(title: const Text("RepaintBoundary ç¤ºä¾‹")),
      body: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          // âœ… ä»…æ›´æ–°è¿™ä¸ªåŒºåŸŸçš„ç»˜åˆ¶ï¼Œé¿å…å½±å“æ•´ä¸ªå±å¹•
          RepaintBoundary(
            child: CounterDisplay(counter: _counter),
          ),

          // âœ… è¿™ä¸ªç»„ä»¶ä¹Ÿä¸ä¼šå› è®¡æ•°å™¨å˜åŒ–è€Œé‡å»º
          const Text(
		        "è¿™æ˜¯ä¸€ä¸ªé™æ€ Footerï¼Œä¹Ÿä¸ä¼šå› è®¡æ•°å™¨å˜åŒ–è€Œé‡å»º",
		        style: TextStyle(fontSize: 16),
		      ),
        ],
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          _counter.value += 1; // ä»…æ›´æ–° ValueNotifierï¼Œä¸å½±å“æ•´ä¸ªé¡µé¢
        },
        child: const Icon(Icons.add),
      ),
    );
  }

  @override
  void dispose() {
    _counter.dispose(); // é‡Šæ”¾èµ„æº
    super.dispose();
  }
}

/// âœ… ä»… `CounterDisplay` è¿™ä¸ªç»„ä»¶ä¼šé‡æ–°ç»˜åˆ¶ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå±å¹•
class CounterDisplay extends StatelessWidget {
  final ValueNotifier<int> counter;

  const CounterDisplay({Key? key, required this.counter}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    print("CounterDisplay build() è¢«è°ƒç”¨");
    return ValueListenableBuilder<int>(
      valueListenable: counter,
      builder: (context, value, child) {
        print("ğŸ”„ CounterDisplay æ›´æ–°: $value");
        return Text(
          "è®¡æ•°: $value",
          style: const TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
        );
      },
    );
  }
}
}
```

è¿™æ · `ComplexWidget` åªæœ‰åœ¨è‡ªèº«æ•°æ®å˜åŒ–æ—¶æ‰ä¼šé‡æ–°ç»˜åˆ¶ï¼Œè€Œä¸æ˜¯æ•´ä¸ªçˆ¶çº§ Widgetã€‚

---

- **4. æ€»ç»“**
| **ä¼˜åŒ–æ–¹å¼**              | **ä½œç”¨** |
|--------------------------|--------------------------------|
| é¿å…ä¸å¿…è¦çš„ `setState()` | åªæ›´æ–°å¿…è¦çš„çŠ¶æ€ï¼Œå‡å°‘é‡å»ºèŒƒå›´ |
| ä½¿ç”¨ `const` å…³é”®å­—       | é¿å…ä¸å¿…è¦çš„ Widget é‡æ–°åˆ›å»º |
| `ValueListenableBuilder`  | å±€éƒ¨æ›´æ–°ï¼Œå‡å°‘ `setState` å½±å“ |
| `ListView.builder`       | æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘å†…å­˜å ç”¨ |
| `AutomaticKeepAliveClientMixin` | ä¿æŒ Tab é¡µé¢çš„çŠ¶æ€ |
| `RepaintBoundary`        | é™åˆ¶é‡ç»˜èŒƒå›´ï¼Œæé«˜æ€§èƒ½ |

**æ ¸å¿ƒåŸåˆ™**
- **Flutter å…¶å®ä¸ä¼šé¢‘ç¹é”€æ¯å’Œåˆ›å»ºå¯¹è±¡**ï¼Œå®ƒä¼šå°½é‡**å¤ç”¨ `Element` å’Œ `RenderObject`**ï¼Œæ‰€ä»¥é¿å…ä¸å¿…è¦çš„ `setState()` æ‰æ˜¯å…³é”®ã€‚
- **å¦‚æœ UI å¤æ‚ï¼Œå°½é‡ä½¿ç”¨ `const`ã€`RepaintBoundary` å’Œ `ListView.builder`ï¼Œå‡å°‘é‡å»ºå’Œé‡ç»˜èŒƒå›´ã€‚**


<br/><br/><br/>
> <h2 id='è€—æ—¶æ“ä½œ'>è€—æ—¶æ“ä½œ</h2>


<br/><br/>
> <h2 id='compute'>compute</h2>
åœ¨Flutterä¸­ï¼Œcomputeæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨åå°éš”ç¦»çš„Isolateä¸­æ‰§è¡Œè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œä»¥é¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œä¿æŒåº”ç”¨ç¨‹åºçš„å“åº”æ€§ã€‚Isolatesæ˜¯Flutterä¸­çš„å¹¶å‘æ‰§è¡Œå•å…ƒï¼Œå¯ä»¥åœ¨ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ä¸­è¿è¡Œï¼Œä¸ä¸**ä¸»Isolate**å…±äº«å†…å­˜ã€‚

<br/>
ä»¥ä¸‹æ˜¯ä½¿ç”¨computeå‡½æ•°çš„ç®€å•ç¤ºä¾‹ï¼Œå‡è®¾æœ‰ä¸€ä¸ªè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚è®¡ç®—é˜¶ä¹˜ï¼š

```
import 'dart:async';
import 'dart:isolate';

// è®¡ç®—é˜¶ä¹˜çš„å‡½æ•°
int calculateFactorial(int n) {
  if (n == 0 || n == 1) {
    return 1;
  } else {
    return n * calculateFactorial(n - 1);
  }
}

// å…¥å£å‡½æ•°ï¼Œé€šè¿‡computeåœ¨åå°Isolateä¸­æ‰§è¡Œè®¡ç®—
Future<void> main() async {
  // è¦è®¡ç®—é˜¶ä¹˜çš„æ•°
  int number = 5;

  // ä½¿ç”¨computeå‡½æ•°åœ¨åå°Isolateä¸­æ‰§è¡Œè®¡ç®—
  int result = await compute(calculateFactorial, number);

  print('The factorial of $number is $result');
}
```

å¯¹äºä¸€äº›è€—æ—¶æ“ä½œ,æˆ‘ä»¬å¯ä»¥æ”¾åœ¨computeä¸­


![flutter1_70](./../Pictures/flutter1_70.png)



<br/><br/>
> <h2 id='åˆç†åˆ·æ–°èŒƒå›´'>åˆç†åˆ·æ–°èŒƒå›´</h2>

RepaintBoundaryæ˜¯ä¸€ä¸ªå°éƒ¨ä»¶ï¼Œç”¨äºéš”ç¦»å…¶å­æ ‘çš„ç»˜åˆ¶ï¼Œå¹¶å°†å…¶ç»˜åˆ¶ç»“æœç¼“å­˜èµ·æ¥ã€‚è¿™å¯ä»¥å¸®åŠ©æé«˜æ€§èƒ½ï¼Œå› ä¸ºåªæœ‰åœ¨å­æ ‘å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°ç»˜åˆ¶ã€‚è¿™å¯¹äºåŒ…å«å¤æ‚æˆ–é¢‘ç¹å˜åŒ–çš„å­æ ‘çš„æƒ…å†µå¾ˆæœ‰ç”¨ï¼Œå¯ä»¥å‡å°‘ä¸å¿…è¦çš„ç»˜åˆ¶æ“ä½œã€‚

è¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨RepainBoundaryè¿›è¡ŒæŠŠç›¸å…³ç»„ä»¶è¿›è¡ŒåŒ…è£…,ä½†æ˜¯è¿™ä¸ªä¸æ˜¯æ‰€æœ‰çš„ä½ éƒ½åŒ…ä¸€å±‚,è¿™æ ·ä¼šå½±å“æ€§èƒ½çš„.

![flutter1_71](./../Pictures/flutter1_71.png)



æ¯”å¦‚ä»–çš„éƒ¨åˆ†æºç :

![flutter1_72](./../Pictures/flutter1_72.png)
![flutter1_73](./../Pictures/flutter1_73.png)

<br/><br/>
**ä»£ç ç¤ºä¾‹:**

```
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        appBar: AppBar(
          title: Text('RepaintBoundary Example'),
        ),
        body: Center(
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              RepaintBoundary(
                child: MyCustomWidget(),
              ),
              ElevatedButton(
                onPressed: () {
                  // é€šè¿‡è°ƒç”¨ MyCustomWidget ä¸­çš„å…¨å±€æ–¹æ³•æ¥è§¦å‘é‡æ–°ç»˜åˆ¶
                  MyCustomWidget.triggerRepaint();
                },
                child: Text('Trigger Repaint'),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

class MyCustomWidget extends StatefulWidget {
  static void triggerRepaint() {
    // åœ¨è¿™é‡Œæ‰§è¡Œé‡æ–°ç»˜åˆ¶çš„é€»è¾‘
    // è¿™å¯ä»¥æ˜¯ä»»ä½•è§¦å‘å­æ ‘é‡æ–°ç»˜åˆ¶çš„é€»è¾‘
    // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ GlobalKey æ¥å¼•ç”¨ MyCustomWidgetState
    _globalKey.currentState?.triggerRedraw();
  }

  @override
  MyCustomWidgetState createState() => MyCustomWidgetState();
}

class MyCustomWidgetState extends State<MyCustomWidget> {
  static MyCustomWidgetState? _globalKey;

  @override
  void initState() {
    super.initState();
    // ä½¿ç”¨å…¨å±€çš„ GlobalKey æ¥å¼•ç”¨ MyCustomWidgetState
    if (_globalKey == null) {
      _globalKey = this;
    }
  }

  void triggerRedraw() {
    // åœ¨è¿™é‡Œæ‰§è¡Œé‡æ–°ç»˜åˆ¶çš„é€»è¾‘
    // è¿™å¯ä»¥æ˜¯ä»»ä½•è§¦å‘é‡æ–°ç»˜åˆ¶çš„é€»è¾‘
    setState(() {});
  }

  @override
  Widget build(BuildContext context) {
    return Container(
      width: 100,
      height: 100,
      color: Colors.blue,
      child: Center(
        child: Text('I can be redrawn!'),
      ),
    );
  }
}

```

åœ¨è¿™ä¸ªä¿®æ­£åçš„ç¤ºä¾‹ä¸­ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œé€šè¿‡è°ƒç”¨MyCustomWidget.triggerRepaint()æ–¹æ³•æ¥è§¦å‘é‡æ–°ç»˜åˆ¶ï¼Œè¯¥æ–¹æ³•å†…éƒ¨å®é™…ä¸Šè°ƒç”¨äº†_globalKey.currentState?.triggerRedraw()ï¼Œè¿›è€Œè§¦å‘MyCustomWidgetStateä¸­çš„triggerRedrawæ–¹æ³•ï¼Œè¾¾åˆ°é‡æ–°ç»˜åˆ¶çš„æ•ˆæœã€‚


<br/><br/>
> <h2 id='å†…å­˜å›¾ç‰‡ä¼˜åŒ–'>å†…å­˜å›¾ç‰‡ä¼˜åŒ–</h2>

å›¾ç‰‡ç”Ÿæˆæµç¨‹

![flutter1_74](./../Pictures/flutter1_74.png)

<br/>
3ç§å›¾ç‰‡å­˜åœ¨çš„æ–¹å¼:

![flutter1_75](./../Pictures/flutter1_75.png)
![flutter1_76](./../Pictures/flutter1_76.png)


<br/>
å›¾ç‰‡è§£ç åçš„å½±å“è¿˜æ˜¯è›®å¤§çš„:

![flutter1_77](./../Pictures/flutter1_77.png)


<br/><br/><br/>
> <h2 id='æ»šå‡ºå±å¹•çš„åŠ¨å›¾æš‚åœæ’­æ”¾'>æ»šå‡ºå±å¹•çš„åŠ¨å›¾æš‚åœæ’­æ”¾</h2>


VisibilityDetectorå¹¶ä¸æ˜¯Flutteræ¡†æ¶è‡ªå¸¦çš„ç»„ä»¶ï¼Œè€Œæ˜¯ç”±ç¤¾åŒºæä¾›çš„ä¸€ä¸ªæ’ä»¶ï¼ˆpackageï¼‰ã€‚è¿™ä¸ªæ’ä»¶å…è®¸ä½ æ£€æµ‹ä¸€ä¸ªå°éƒ¨ä»¶çš„å¯è§æ€§ï¼Œä»¥ä¾¿åœ¨è¯¥å°éƒ¨ä»¶å˜å¾—å¯è§æˆ–ä¸å¯è§æ—¶æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚

ä½ å¯ä»¥åœ¨pubspec.yamlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–æ¥ä½¿ç”¨visibility_detectoræ’ä»¶ï¼š

```
dependencies:
  visibility_detector: ^0.2.0
```
ç„¶åè¿è¡Œ flutter pub get æ¥è·å–ä¾èµ–ã€‚


<br/>
å¯¹äºåŠ¨å›¾,æ»šå‡ºå±å¹•åå¯ä»¥ä½¿å…¶æš‚åœæ’­æ”¾:
![flutter1_78](./../Pictures/flutter1_78.png)


**ä»£ç ç¤ºä¾‹:**

```
import 'package:flutter/material.dart';
import 'package:visibility_detector/visibility_detector.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        appBar: AppBar(
          title: Text('VisibilityDetector Example'),
        ),
        body: Center(
          child: VisibilityDetector(
            key: Key('unique_key'),
            onVisibilityChanged: (visibilityInfo) {
              print('Widget visibility changed: ${visibilityInfo.visibleFraction}');
            },
            child: Container(
              width: 200,
              height: 200,
              color: Colors.blue,
              child: Center(
                child: Text('I am visible!'),
              ),
            ),
          ),
        ),
      ),
    );
  }
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒVisibilityDetectoråŒ…è£…äº†ä¸€ä¸ªContainerï¼Œå½“è¿™ä¸ªContaineråœ¨å±å¹•ä¸Šå¯è§æˆ–ä¸å¯è§æ—¶ï¼ŒonVisibilityChangedå›è°ƒä¼šè¢«è°ƒç”¨ã€‚ä½ å¯ä»¥åœ¨è¿™ä¸ªå›è°ƒä¸­æ‰§è¡Œç‰¹å®šçš„æ“ä½œï¼Œæ¯”å¦‚åœ¨éƒ¨ä»¶å¯è§æ—¶åŠ è½½æ•°æ®ï¼Œæˆ–è€…åœ¨ä¸å¯è§æ—¶åœæ­¢ä¸€äº›æ“ä½œã€‚


<br/><br/>
å›¾ç‰‡å†…å­˜å³°å€¼,å¯¹äºè¯·æ±‚çš„:

![flutter1_79](./../Pictures/flutter1_79.png)

<br/><br/>
> <h2 id=''></h2>

![flutter1_7](./../Pictures/flutter1_7.png)

![flutter1_7](./../Pictures/flutter1_7.png)




- **原理**
- **CGAffineTransform**
	- 消失收回效果

<br/>

***
<br/>

># 原理

&emsp;  `UIView`有`CGAffineTransform`类型的属性`transform，它是定义在二维空间上完成View的平移，旋转，缩放等效果的实现。

&emsp;  CGAffineTransform是一个映射转换3*3的矩阵，用来绘画2D图像。可以实现放大、缩小、平移。其结构体为：

```
struct CGAffineTransform {
  CGFloat a, b, c, d;
  CGFloat tx, ty;
};


```

&emsp;  CGAffineTransform是一个结构体，里面有（a，b，c，d，tx，ty）六个参数，对应着一个3 * 3 的矩阵，有九个参数，默认值是[ 1 0 0 1 0 0 ]。如下图：

![3*3矩阵](https://upload-images.jianshu.io/upload_images/4677158-b1d65b62d60f5e5c.jpeg)

- **`参数的用处：`**
	-  a: 用来控制在x轴方向上的缩放；
	-  b: 旋转会用到，初始值0。
	-  c: 旋转会用到，初始值0。
	-  d: 用来控制在y轴方向上的缩放；
	-  tx: 视图x轴平移，初始值0，没有平移。
	-  ty: 视图y轴平移，初始值0，没有平移。

&emsp;  为了把**二维图形的旋转、缩放、平移变化**统一在一个坐标系里,引入了[齐次坐标的概念](https://blog.csdn.net/jeffasd/article/details/77944822),**即把一个图形用一个三维矩阵表示**,其中第三列总是(0,0,1),用来作为坐标系的标准。所以**所有的变化都由前两列完成**.

<br/>

***
<br/>

># 公式计算

![矩阵计算](https://upload-images.jianshu.io/upload_images/143910-d52c70522fcffdc7.png)

设原坐标设为`(x,y,1)`
![x轴、y轴方向上的平移量
](https://upload-images.jianshu.io/upload_images/2959789-981d7cabf88ddf19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![计算后的x、y的值](https://upload-images.jianshu.io/upload_images/2959789-f1bad7294d34a3d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

```
上图中的tx 和ty 记做 t小x ，t小y

                  |a    b    0|
  [x,y,1]  *      |c    d    0|     =     [ax+cy+t小x   bx+dy+t小y  1] ;
```
通过矩阵运算后的坐标[ax+cy+t小x bx+dy+t小y 1]


<br/>

***
<br/>

># CGAffineTransform

```
/*
CGAffineTransform transform  = CGAffineTransformMake(CGFloat a,CGFloat b,CGFloat c,CGFloa td,CGFloat tx,CGFloat ty)
*/

//CGAffineTransformIdentity是系统提供的一个常量,没有做任何的转换
//其值为：[ 1 0 0 1 0 0 ](和原图一样的transform)
CGAffineTransform  transform = CGAffineTransformIdentity;
```
默认的CGAffineTransformIdentity






<br/>
<br/>

**示例**

```

//1.先正常创建collectionview 
_collectionview=[[UICollectionView alloc]initWithFrame:CGRectMake(0,kScreenHeigth-100-SafeAreaBoHttomHeight, kScreenWidth, 100) 
collectionViewLayout:layout];
//2.相对移动 往下移动高的距离（本例为100）,还有一种方法，创建时y的坐标就再加上高，达到同样的效果
   _collectionview.transform = CGAffineTransformMakeTranslation(0, 100);
//3.加个view的简单动画，设个觉得可以的动画时间
 [UIView animateWithDuration:0.4 animations:^{
            self.collectionview.transform = CGAffineTransformMakeTranslation(0, 0);
        }];

```

<br/>

- **消失收回的效果**

原理和推出一样，在动画结束后消失视图

```
//先移动试图到底部，动画结束，移除视图
  [UIView animateWithDuration:0.4 animations:^{
        self.collectionview.transform = CGAffineTransformMakeTranslation(0, 100);
    } completion:^(BOOL finished) {
         [self removeFromSuperview];
    }];
```












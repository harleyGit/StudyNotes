
- **åˆ†ç±»**
- **æ‰©å±•**
	- **Demo**
	- **NSStringåˆ†ç±»Demo**
- **NSProxy(ä¼ªå¤šç»§æ‰¿)**



<br/>

***
<br/>



># åˆ†ç±»



```
objc_setAssociatedObject(id _Nonnull object, const void * _Nonnull key, id _Nullable value, objc_AssociationPolicy policy)

```

- id object ï¼šå…³è”çš„æºå¯¹è±¡
- const void *keyï¼šå…³è”çš„key
- id valueï¼šå…³è”å¯¹è±¡ï¼Œé€šè¿‡å°†æ­¤ä¸ªå€¼ç½®æˆnilæ¥æ¸…é™¤å…³è”ã€‚
- objc_AssociationPolicy policyï¼šå…³è”çš„ç­–ç•¥
	å…³é”®ç­–ç•¥æ˜¯ä¸€ä¸ªenumå€¼
	- 	OBJC_ASSOCIATION_ASSIGN = 0,      <æŒ‡å®šä¸€ä¸ªå¼±å¼•ç”¨å…³è”çš„å¯¹è±¡>
	- 	OBJC_ASSOCIATION_RETAIN_NONATOMIC = 1,<æŒ‡å®šä¸€ä¸ªå¼ºå¼•ç”¨å…³è”çš„å¯¹è±¡>
	- 	OBJC_ASSOCIATION_COPY_NONATOMIC = 3,  <æŒ‡å®šç›¸å…³çš„å¯¹è±¡å¤åˆ¶>
	- 	OBJC_ASSOCIATION_RETAIN = 01401,      <æŒ‡å®šå¼ºå‚è€ƒ>
	- 	OBJC_ASSOCIATION_COPY = 01403    <æŒ‡å®šç›¸å…³çš„å¯¹è±¡å¤åˆ¶>


<br/>

> **Demo**

```
- (void) personTest {
    
    
    static char overviewKey;
    NSArray *array = [[NSArray alloc] initWithObjects:@"one", @"two", nil];
    NSString * overview = [[NSString alloc] initWithFormat:@"%@",@"First three numbers"];
    objc_setAssociatedObject(array, &overviewKey, overview, OBJC_ASSOCIATION_RETAIN);
    NSString *associatedObject = (NSString *)objc_getAssociatedObject(array, &overviewKey);
    NSLog(@"ğŸ associatedObject:%@", associatedObject);
    
    objc_setAssociatedObject(array, &overviewKey, nil, OBJC_ASSOCIATION_ASSIGN);
    NSString *associatedObject2 = (NSString *)objc_getAssociatedObject(array, &overviewKey);

    NSLog(@"ğŸŠ associatedObject:%@", associatedObject2);
}
```

æ‰“å°ï¼š

```
 ğŸ associatedObject:First three numbers
 ğŸŠ associatedObject:(null)

```


<br/>

> **NSStringåˆ†ç±»Demo**

`NSStringåˆ†ç±».hæ–‡ä»¶`

```
#import <Foundation/Foundation.h>

NS_ASSUME_NONNULL_BEGIN

@interface NSString (Tool)


/// åˆ†ç±»æ·»åŠ å±æ€§(ä½¿ç”¨è¿è¡Œæ—¶)
@property(nonatomic, copy)NSString *name;

@end
```
<br/>

`.mæ–‡ä»¶`

```
#import "NSString+Tool.h"
#import <objc/runtime.h>

static const void *nameKey = &nameKey;

@implementation NSString (Tool)


- (void)setName:(NSString *)name {
    
    
   /**
    *  æ ¹æ®æŸä¸ªå¯¹è±¡ï¼Œè¿˜æœ‰keyï¼Œè¿˜æœ‰å¯¹åº”çš„ç­–ç•¥(copy,strongç­‰) åŠ¨æ€çš„å°†å€¼è®¾ç½®åˆ°è¿™ä¸ªå¯¹è±¡çš„keyä¸Š
    *
    *  @param object æŸä¸ªå¯¹è±¡
    *  @param key    å±æ€§å,æ ¹æ®keyå»è·å–å…³è”çš„å¯¹è±¡, æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œæ˜¯ä¸€ä¸ªåœ°å€(è¿™é‡Œæ³¨æ„ï¼Œåœ°å€å¿…é¡»æ˜¯ä¸å˜çš„ï¼Œåœ°å€ä¸åŒä½†æ˜¯å†…å®¹ç›¸åŒçš„ä¹Ÿä¸ç®—åŒä¸€ä¸ªkey)
    *  @param value  è¦è®¾ç½®çš„å€¼
    *  @param policy ç­–ç•¥(copy,strongï¼Œassignç­‰)
    */
    objc_setAssociatedObject(self, &nameKey, name, OBJC_ASSOCIATION_COPY_NONATOMIC);
}

- (NSString *)name {
    return objc_getAssociatedObject(self, nameKey);
}

@end



//è°ƒç”¨
 NSString *test = @"å¤§å¤´çˆ¸çˆ¸";
 test.name = @"å¼ å…‰åŒ—";
 NSLog(@"å­—ç¬¦ä¸²åˆ†ç±»å±æ€§nameå€¼ï¼š %@", test.name);
```
æ‰“å°ï¼š

`2019-11-16 19:36:41.693406+0800 HGSWB[19518:789236] å­—ç¬¦ä¸²åˆ†ç±»å±æ€§nameå€¼ï¼š å¼ å…‰åŒ—
`





<br/>

***
<br/>


># æ‰©å±•




<br/>

***
<br/>


># NSProxy(ä¼ªå¤šç»§æ‰¿)

[NSProxy](https://www.jianshu.com/p/923f119333d8)


<br/>

***
<br/>

å‚è€ƒèµ„æ–™ï¼š

[iOSåˆ†ç±»ä¸èƒ½æ·»åŠ å±æ€§åŸå› çš„æ¢ç´¢](https://blog.csdn.net/u012409247/article/details/80206229)

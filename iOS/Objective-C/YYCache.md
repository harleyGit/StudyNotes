> <h2 id=""></h2>
- [**简介**](#简介)
- [**参考资料**](#参考资料)
	- [YYCache设计思路](https://blog.ibireme.com/2015/10/26/yycache/)





> <h1 id="简介">简介</h1>

&emsp; YYCache包括了内存缓存和磁盘缓存两部分。

&emsp; 对于内存缓存可以说作者为了提升性能无所不用其极，使用Core Foundation提供的C字典CFMutableDictionaryRef来存储封装的缓存对象，并构造了一个双向链表，维护链表并使用LRU淘汰算法来剔除超过限制的缓存对象，使用pthread_mutext互斥锁来保证线程安全，包括释放对象使用了一个小技巧使得可以在子线程中释放，而不需要在主线程中执行，直接访问ivar而不使用getter/setter，一系列的优化方法使得YYCache的内存缓存效率超过了NSCache及其他第三方库。

&emsp; 对于磁盘缓存，作者参考了NSURLCache的实现及其他第三方的实现，采用文件系统结合SQLite的实现方式，实验发现对于20KB以上的数据，文件系统的读写速度高于SQLite，所以当数据大于20KB时直接将数据保存在文件系统中，在数据库中保存元数据，并添加索引，数据小于20KB时直接保存在数据库中，这样，就能够快速统计相关数据来实现淘汰。SDWebImage的磁盘缓存使用的只有文件系统。

&emsp; 读了YYCache源码让我明白了，不能一味的迷信苹果为我们提供的类，为了追求更极致的性能需要做大量的对比试验来确定技术方案。


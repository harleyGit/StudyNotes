> <h2 id=''></h2>
- [**CoreData**](#CoreData)
	- [åŸºç¡€ä½¿ç”¨](#åŸºç¡€ä½¿ç”¨)
- [**æŒä¹…åŒ–**](#æŒä¹…åŒ–)
	- [åºåˆ—åŒ–å’Œååºåˆ—åŒ–](#åºåˆ—åŒ–å’Œååºåˆ—åŒ–)
- **å‚è€ƒèµ„æ–™**
	- [CoreDataæŒä¹…åŒ–å­˜å‚¨æ•°æ®è‡³ SQLite](https://www.jianshu.com/p/f4d0f42398df)
	- [æ·»åŠ ä¸æŸ¥è¯¢æ•°æ®](https://yq.aliyun.com/articles/39426)
	- [CoreDataå…¥é—¨](https://www.cnblogs.com/mjios/archive/2013/02/26/2932999.html)



<br/>
<br/>

***
<br/>


> <h1 id='CoreData'>CoreData</h1>

![ios_oc1_22.png](./../../Pictures/ios_oc1_22.png)

- **NSManagedObjectContextï¼š**æ•°æ®åº“æ“ä½œï¼Œ ç®¡ç†å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œç±»ä¼¼äºåº”ç”¨ç¨‹åºå’Œæ•°æ®å­˜å‚¨é—´çš„ä¸€å—ç¼“å†²åŒºï¼Œä½ å¯ä»¥å¢åˆ æ”¹æŸ¥ç®¡ç†å¯¹è±¡ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œä»æŒä¹…åŒ–å­˜å‚¨ï¼ˆæ–‡ä»¶ï¼‰ä¸­æŸ¥è¯¢çš„æ•°æ®åœ¨è¿™ä¸ªå®¹å™¨ä¸­å½¢æˆå¯¹è±¡å›¾ï¼Œå¯¹è¿™äº›å¯¹è±¡å›¾ä¸­çš„å¯¹è±¡æ“ä½œéƒ½ä¼šå­˜å‚¨åœ¨è¿™ä¸ªå®¹å™¨é‡Œï¼Œç›´åˆ°å‘å‡ºæŒ‡ä»¤è®©å®¹å™¨ä¸­çš„å†…å®¹åŒæ­¥åˆ°ç£ç›˜ã€‚

- **NSManagedObjectContext:**å‘èµ·saveæ“ä½œï¼Œæ‰ä¼šé€šè¿‡NSPersistentStoreCoordinateä¸æ•°æ®äº¤äº’å¹¶æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œè¿™æ ·é¿å…äº†å› æ•°æ®æ“ä½œè€Œå¸¦æ¥çš„I/Oæ“ä½œï¼Œæé«˜äº†æ•ˆç‡

- **NSManagedObjectï¼š** è¡¨è®°å½•ï¼Œä¸€ä¸ªç®¡ç†å¯¹è±¡ä»£è¡¨ä½ æƒ³è¦ä¿å­˜åˆ°æ•°æ®å­˜å‚¨ä¸­çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç±»ä¼¼äºSQLä¸­çš„ä¸€æ¡è®°å½•ï¼Œå¹¶ä¸”åŒ…å«ä¸€äº›å¯¹è±¡å±æ€§ã€‚ç®€å•ç‚¹æ¥è¯´ï¼ŒNSManagedObject å°±æ˜¯NSManagedObjectContextå¯¹è±¡å›¾ä¸­çš„å®é™…å¯¹è±¡ã€‚ç”±NSManagedObjectContextç®¡ç†ã€‚NSManagedObjectContextä¼šå­˜å‚¨è¿™äº›å¯¹è±¡çš„å˜åŒ–æ¥æ”¯æŒé‡åšå’Œæ’¤é”€ã€‚

- **NSPersistentStoreCoordinatorï¼š**æ•°æ®åº“å­˜å‚¨æ–¹å¼ï¼Œ æŒä¹…åŒ–å­˜å‚¨åè°ƒè€… ï¼ŒåŒ…å«æ•°æ®å­˜å‚¨çš„åå­—å’Œä½ç½®ï¼Œç®€å•ç‚¹æ¥è¯´å®ƒæ˜¯è¿æ¥ä¸¤ç«¯çš„çº½å¸¦ã€‚æ‰€ä»¥æ•´ä¸ªæµç¨‹å°±æ˜¯ï¼š
	- 1ã€æ•°æ®ï¼ˆNSManagedObjectï¼‰è¢«åˆ›å»ºä¿®æ”¹æˆ–åˆ é™¤ç­‰ç­‰ï¼Œè¿™äº›éƒ½è¢«contextçœ‹åœ¨çœ¼é‡Œï¼Œç„¶åä½ è¦ä¿å­˜äº†ï¼ŒcontextæŠŠä¿®æ”¹çš„ä¿¡æ¯æäº¤ç»™ï¼Œcontextæ ¹æ®æ•°æ®ä¿¡æ¯æ‰¾åˆ°æ­£ç¡®çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ ¹æ®æ•°æ®æ¨¡å‹ï¼Œæ­£ç¡®çš„æŠŠæ•°æ®å†™å…¥åˆ°æ•°æ®åº“æ–‡ä»¶é‡Œã€‚
	- 2ã€æŸ¥è¯¢æ—¶ï¼ŒcontextæŠŠæŸ¥è¯¢æ¡ä»¶æäº¤ç»™Coordinatorï¼Œå®ƒå»æ•°æ®åº“æ–‡ä»¶é‡ŒæŠŠæ•°æ®æŸ¥å‡ºæ¥ï¼Œç»™context,contextå†æŠŠè¿™äº›æ•°æ®å’Œä»¥åœ¨å®ƒç®¡ç†å†…çš„ç»“åˆã€‚

- **NSPersistentStoreï¼š** æ˜¯æŒä¹…åŒ–å­˜å‚¨æ ¸å¿ƒæ•°æ®çš„æŠ½è±¡ç±»ï¼Œå¯ä»¥ç†è§£ä¸ºæŒä¹…åŒ–å­˜å‚¨åŒºï¼Œå®ƒçš„ä¸»è¦è´£ä»»æ˜¯æŠŠå¯¹è±¡å›¾ä¸­çš„ä¿¡æ¯mapåˆ°å®é™…çš„å­˜å‚¨ä¿¡æ¯ã€‚æŒä¹…åŒ–å­˜å‚¨åŒºæ”¯æŒçš„æ•°æ®ç±»å‹ä¸ºSQLiteã€äºŒè¿›åˆ¶ã€XMLå’Œå†…å­˜ã€‚

<br/>

&emsp; SQLite å’ŒFileSystemå°±æ˜¯ä¿å­˜åˆ°æŒä¹…åŒ–å­˜å‚¨çš„æ–‡ä»¶ï¼ŒCoreDataæ”¯æŒSQLiteçš„æ•°æ®æ ¼å¼ã€‚ä½†æ˜¯æ³¨æ„ï¼ŒcoreDataä¸æ˜¯DBMSï¼Œå¹¶ä¸èƒ½ç®¡ç†SQLite 



<br/>

> <h2 id='åŸºç¡€ä½¿ç”¨'>åŸºç¡€ä½¿ç”¨</h2>


- **1.åˆ›å»ºNSManagedObjectModel**

```
// åŠ è½½ï¼šModel.xcdatamodeld æ–‡ä»¶
lazy var managedObjectModel: NSManagedObjectModel = {

	if self.isTestMode {
	
	    return NSManagedObjectModel.mergedModel(from: Bundle.allBundles)! //è¿æ¥é¡¹ç›®ä¸­æ‰€æœ‰çš„ .xcdatamodeld æ–‡ä»¶ä¸ºä¸€ä¸ªdatamodelï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æ–¹æ³•ï¼ŒæŠŠå¤šä¸ªentityæ”¾åœ¨å„è‡ªçš„xcodemodelæ–‡ä»¶ä¸­åˆ†å¼€ç®¡ç†ï¼Œç„¶åç”¨è¿™ä¸ªå‡½æ•°è¿æ¥èµ·æ¥ç”Ÿæˆä¸€ä¸ªdatamodel
	
	}
	
	let modelURL = Bundle.main.url(forResource: "Model", withExtension: "momd")!
	
	return NSManagedObjectModel(contentsOf: modelURL)!

}()
```




<br/>
<br/>




> <h2 id=''></h2>


<br/>
<br/>



> <h2 id=''></h2>


<br/>
<br/>


<br/>
<br/>

***
<br/>


> <h1 id='æŒä¹…åŒ–'>æŒä¹…åŒ–</h1>

- **æŒä¹…åŒ–ä¸‰ä¸ªå¸¸è§æ–¹æ³•**
	- plist
	- NSUserDefault
	- æ•°æ®åº“

&emsp; ä¸ç®¡æ˜¯å“ªä¸€ç§æ–¹æ¡ˆï¼Œéƒ½ä¸å¯èƒ½ç›´æ¥å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„å¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦å°†è‡ªå®šä¹‰çš„å¯¹è±¡åºåˆ—åŒ–æˆNSDataï¼Œæ‰èƒ½æŒä¹…åŒ–ã€‚

&emsp; éœ€è¦ç”¨åˆ°çš„æ—¶å€™ï¼Œå°±ç”¨æ•°æ®åº“ä¸­å–å‡ºï¼Œç„¶åååºåˆ—åŒ–ï¼Œæ¢å¤æˆå¯¹è±¡

<br/>

> <h2 id='åºåˆ—åŒ–å’Œååºåˆ—åŒ–'>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h2>

&emsp; å¦‚æœè‡ªå®šä¹‰å¯¹è±¡è¦æƒ³è½¬æˆNSDataï¼Œéœ€è¦æœä»NSCodingåè®®ã€‚å¹¶å®ç°å…¶ä¸­çš„ä¸¤ä¸ªæ–¹æ³•ã€‚

![ios_oc1_31](./../../Pictures/ios_oc1_31.webp)

<br/>

&emsp; iOS6ä¸­ï¼Œè‹¹æœå¼•å…¥äº†ä¸€ä¸ªæ–°çš„åè®®ï¼Œæ˜¯åŸºäºNSCodingçš„ï¼Œå«åšNSSecureCodingã€‚NSSecureCodingå’ŒNSCodingæ˜¯ä¸€æ ·çš„ï¼Œé™¤äº†åœ¨è§£ç æ—¶è¦åŒæ—¶æŒ‡å®škeyå’Œè¦è§£ç çš„å¯¹è±¡çš„ç±»ï¼Œå¦‚æœè¦æ±‚çš„ç±»å’Œä»æ–‡ä»¶ä¸­è§£ç å‡ºçš„å¯¹è±¡çš„ç±»ä¸åŒ¹é…ï¼ŒNSCoderä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå‘Šè¯‰ä½ æ•°æ®å·²ç»è¢«ç¯¡æ”¹äº†ã€‚å¤§éƒ¨åˆ†æ”¯æŒNSCodingçš„ç³»ç»Ÿå¯¹è±¡éƒ½å·²ç»å‡çº§åˆ°æ”¯æŒNSSecureCodingã€‚

**DEMO**

**Person.h**

```
@interface Person : NSObject<NSSecureCoding>

@property (nonatomic, copy) NSString *name;

@property (nonatomic, copy) NSString *numberID;
```

<br/>

**Person.m**

```
@implementation Foo

- (void)encodeWithCoder:(nonnull NSCoder *)aCoder {
    [aCoder encodeObject:self.name forKey:NSStringFromSelector(@selector(name))];
    [aCoder encodeFloat:self.numberID forKey:NSStringFromSelector(@selector(numberID))];
}

- (nullable instancetype)initWithCoder:(nonnull NSCoder *)aDecoder {
    if (self = [super init]) {
        self.name = [aDecoder decodeObjectForKey:NSStringFromSelector(@selector(name))];
        self.numberID = [aDecoder decodeFloatForKey:NSStringFromSelector(@selector(numberID))];
    }
    return self;
}

+ (BOOL)supportsSecureCoding
{
    return YES;
}

-(NSString *)description{
    return [NSString stringWithFormat:@"bar:%@ ; baz:%f",self.bar, self.baz];
}

@end

```

<br/>

**ä½¿ç”¨:**

```
Person *person = [[Person alloc] init];
person.name = @"ç¥ˆæ±‚è€…Kael";
person.numberID = 24;

NSError *error0;
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:person requiringSecureCoding:YES error:&error0];
NSLog(@"data --- %@", data);

NSError *error1;
Person *person1 = [NSKeyedUnarchiver unarchivedObjectOfClass:[Person class] fromData:data error:&error1];
NSLog(@"foo1 = %@", person1);

```


æ‰“å°:

```
NSCodingDemo[1081:41952] data --- <62706c69 73743030 d4010203 04050616 17582476 65727369 6f6e5824 6f626a65 63747359 24617263 68697665 72542474 6f701200 0186a0a4 07080f10 55246e75 6c6cd309 0a0b0c0d 0e546b42 6172546b 42617a56 24636c61 73738002 2241c000 00800367 79486c42 8005004b 00610065 006cd211 1213145a 24636c61 73736e61 6d655824 636c6173 73657353 466f6fa2 1315584e 534f626a 6563745f 100f4e53 4b657965 64417263 68697665 72d11819 54726f6f 74800108 111a232d 32373c42 494e535a 5c616372 77828b8f 929badb0 b5000000 00000001 01000000 00000000 1a000000 00000000 00000000 00000000 b7>

NSCodingDemo[1081:41952] foo1 = bar:ç¥ˆæ±‚è€…Kael ; baz:24.000000å¤åˆ¶ä»£ç 

```

<br/>

```
///æµ‹è¯•å±æ€§@selectorå’Œåºåˆ—å·å’Œååºåˆ—åŒ–
-(void) testUUIDMethod {
    self.testUUID = [NSUUID UUID].UUIDString;
    
    NSLog(@"ğŸ‡¨ğŸ‡« testUUID: %@,  @selector(testUUID): %@", self.testUUID, NSStringFromSelector(@selector(testUUID)));
}
```

æ‰“å°:

```
2022-09-17 11:39:36.619385+0800 MLC[54350:1043294] ğŸ‡¨ğŸ‡« testUUID: 503BBFA7-CA58-4CC0-BFDE-50F2925F897D,  @selector(testUUID): testUUID
(lldb) po @selector(testUUID)
"testUUID"

(lldb) p @selector(testUUID)
(SEL) $1 = "testUUID"
(lldb) 
```



<br/>
<br/>




<br/>
<br/>

***
<br/>


> <h1 id=''></h1>

<br/>

> <h2 id=''></h2>


<br/>
<br/>






<br/>
<br/>

***
<br/>

> <h1 id=''></h1>


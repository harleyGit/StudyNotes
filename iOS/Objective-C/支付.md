
> <h2 id=''></h2>
- [**ApplePay**](#ApplePay)
	- [ApplePayå†…è´­é›†æˆ](#ApplePayå†…è´­é›†æˆ)
		- [æ²™ç®±æµ‹è¯•è´¦å·åˆ›å»º](#æ²™ç®±æµ‹è¯•è´¦å·åˆ›å»º)
	- [åè®°](#åè®°)
		- [æ²™ç›’è´¦å·æ³¨æ„äº‹é¡¹](#æ²™ç›’è´¦å·æ³¨æ„äº‹é¡¹)
		- [å…³äºè¯ä¹¦çš„é—®é¢˜](#å…³äºè¯ä¹¦çš„é—®é¢˜)
	- [è‹¹æœå†…è´­ä¸¤ç§æ¨¡å¼](#è‹¹æœå†…è´­ä¸¤ç§æ¨¡å¼)
		- [æœåŠ¡å™¨æ¨¡å¼](#æœåŠ¡å™¨æ¨¡å¼)
		- [æœ¬åœ°æ¨¡å¼](#æœ¬åœ°æ¨¡å¼)
- [**æ”¯ä»˜å®**](#æ”¯ä»˜å®)
	- [é”™è¯¯è§£å†³](#é”™è¯¯è§£å†³)
- [**å¾®ä¿¡æ”¯ä»˜**](#å¾®ä¿¡æ”¯ä»˜)
- [å¾®ä¿¡åˆ†äº«](#å¾®ä¿¡åˆ†äº«)
	- [åˆ†äº«é“¾æ¥](#åˆ†äº«é“¾æ¥) 
	- [åˆ†äº«æ–‡æœ¬](#åˆ†äº«æ–‡æœ¬) 
	- [åˆ†äº«Music](#åˆ†äº«Music) 
	- [åˆ†äº«Video](#åˆ†äº«Video) 
	- [åˆ†äº«å›¾ç‰‡](#åˆ†äº«å›¾ç‰‡)
- **å‚è€ƒèµ„æ–™**
	- [å¼€å‘æ”¯ä»˜ç¯‡](https://www.cnblogs.com/TheYouth/p/6847014.html?utm_source=itdadao&utm_medium=referral)
	- [iOSé›†æˆApplePay](https://www.cnblogs.com/zhouxihi/p/6528133.html)
	- [Apple Pay-è‹¹æœæ”¯ä»˜](https://www.cnblogs.com/feiyu-mdm/p/5802111.html)
	- [Apple Payå¼€å‘æµç¨‹](https://www.jianshu.com/p/7ea225928726)
	- [Apple Pay ä¸ é“¶è” çš„é›†æˆ](https://www.jianshu.com/p/a3d03688fc5a)
	- [Apple Pay é›†æˆ(I)](https://www.jianshu.com/p/dd81d7ade732)
	- [App Storeæ— æ³•æˆåŠŸæ·»åŠ æ²™ç®±æŠ€æœ¯æµ‹è¯•å‘˜è´¦å·](http://ju.outofmemory.cn/entry/365183)
	- [è‹¹æœIAP(å†…è´­)ä¸­æ²™ç›’è´¦å·ä½¿ç”¨æ³¨æ„äº‹é¡¹](https://www.jianshu.com/p/1ef61a785508)
	- [ç”³è¯·æµç¨‹](http://baijiahao.baidu.com/s?id=1586198840331975300&wfr=spider&for=pc)
	- [IAPåº”ç”¨å†…è´­è¯¦ç»†æ­¥éª¤å’Œé—®é¢˜æ€»ç»“æŒ‡å—](https://www.jianshu.com/p/307a3b7cfd6c)
	- [æ”¯ä»˜å®æ”¯ä»˜é›†æˆ](https://www.cnblogs.com/demodashi/p/8486502.html)
	- [æ”¯ä»˜å®æ”¯ä»˜é›†æˆå®ç°](https://www.jianshu.com/p/a62a4793e84f)
	- [èš‚èšé‡‘æœæ”¯ä»˜é›†æˆ](https://docs.open.alipay.com/204/105295/)
	- [æ”¯ä»˜å®å¼€å‘](https://docs.open.alipay.com/204/105295/)
	- [å¾®ä¿¡æ”¯ä»˜é›†æˆ](https://www.jianshu.com/p/2166b7bac7f0)
	- [å¾®ä¿¡æ”¯ä»˜é›†æˆ](https://www.cnblogs.com/demodashi/p/8486504.html)
	- [å¾®ä¿¡æ”¯ä»˜](https://www.cnblogs.com/goodboy-heyang/p/5255818.html)








<br/>

***
<br/>


> <h1 id='ApplePay'>ApplePay</h1>


[Apple Pay å†…è´­å®˜æ–¹æ–‡æ¡£](https://help.apple.com/app-store-connect/#/devae49fb316)

<br/>



> <h2 id='ApplePayå†…è´­é›†æˆ'>ApplePayå†…è´­é›†æˆ</h2>

![å†…è´­é…ç½®å›¾](https://upload-images.jianshu.io/upload_images/2959789-19fe47b5f5540bdd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

<br/>

&emsp;  åœ¨Apple å†…è´­ä¸­ï¼Œä¸€ä¸ªå†…è´­é¡¹ç›®éœ€è¦ç”³è¯·ä¸€ä¸ªï¼Œæ¯”å¦‚ï¼šæˆ‘ç”³è¯·æœˆã€å¹´ã€ç»ˆèº«VIPï¼Œå°±éœ€è¦å¢åŠ 3ä¸ªå†…è´­é¡¹ç›®ã€‚å¦‚ä¸‹å›¾ï¼š

![3ä¸ªå†…è´­é¡¹ç›®ç”³è¯·æœˆã€å¹´ã€ç»ˆèº«](https://upload-images.jianshu.io/upload_images/2959789-3eb73663fe9f234c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

&emsp;  åœ¨æ¯ä¸ªå†…è´­é¡¹ç›®ä¸­ï¼Œå…¶å®šä»·åªèƒ½æŒ‰ç…§è‹¹æœç»™çš„æ¥è¿›è¡Œè®¾å€¼ï¼Œè‡ªå·±ä¸èƒ½éšä¾¿è¿›è¡Œè®¾å€¼çš„ã€‚å¦‚ä¸‹å›¾ï¼š

![å†…è´­ä»·æ ¼è®¾å€¼](https://upload-images.jianshu.io/upload_images/2959789-43e4c55c7aac623f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)




<br/>
<br/>



> <h2 id='æ²™ç®±æµ‹è¯•è´¦å·åˆ›å»º'>æ²™ç®±æµ‹è¯•è´¦å·åˆ›å»º</h2>



![é€‰æ‹©ç®­å¤´æ‰€æŒ‡çš„é€‰é¡¹](https://upload-images.jianshu.io/upload_images/2959789-057184762f6d01e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![åˆ›å»ºæ²™ç®±è´¦å·](https://upload-images.jianshu.io/upload_images/2959789-819a980017a0e86f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


<br/>

> `æ²™ç›’è´¦å·ä½¿ç”¨æµç¨‹`

â‘   åœ¨iPhoneä¸Šå®‰è£…æµ‹è¯•åŒ…ï¼ˆå¿…é¡»æ˜¯adhocç­¾åè¯ä¹¦æˆ–è€…developç­¾åè¯ä¹¦æ‰“çš„åŒ…ï¼Œä¸èƒ½æ˜¯ä»App Storeä¸Šä¸‹è½½çš„ï¼‰ï¼›

â‘¡  é€€å‡ºè‡ªå·±iPhoneçš„App Storeè´¦å·ï¼ˆå› ä¸ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ²™ç›’è´¦å·ç™»å½•ï¼‰ï¼š

&emsp;  a.æ‰“å¼€App Storeåº”ç”¨é¦–é¡µæ»‘åˆ°æœ€ä¸‹æ–¹--é€‰ä¸­AppleID--æ³¨é”€;
      
&emsp;   b.è®¾ç½®--iTunes Storeä¸App Store--é€‰ä¸­AppleID--æ³¨é”€;

&emsp; &emsp;   åœ¨å•†åŸé€€å‡ºè‡ªå·±çš„Apple è´¦å·åï¼Œä¸è¦ä½¿ç”¨åˆšæ‰åœ¨æ²™ç›’ç”³è¯·çš„è´¦å·(æ²™ç›’è´¦å·æ˜¯ä¸€ä¸ªå‡çš„AppleIDè´¦å·ï¼Œä¸èƒ½ç›´æ¥ç™»å½•çš„ã€‚)ï¼Œé‚£æ ·æ˜¯ç™»å½•ä¸è¿›å»çš„ã€‚å¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š
![æ— æ³•ä½¿ç”¨æ²™ç›’æµ‹è¯•è´¦å·æµ‹è¯•](https://upload-images.jianshu.io/upload_images/2959789-97c7ad8e09466ef6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

&emsp;  `æ²™ç›’è´¦å·`æ˜¯åœ¨å®‰è£…æµ‹è¯•åŒ…å†…è´­ä¹°å•†å“æ—¶ï¼Œç³»ç»Ÿä¼šè®©ä½ è¿›è¡Œç™»å½•ï¼Œè¿™æ—¶æˆ‘ä»¬ç‚¹å‡»â€œä½¿ç”¨ç°æœ‰çš„AppleIDâ€å°±å¯ä»¥è¾“å…¥åˆšæ‰åˆ›å»ºå¥½çš„æ²™ç›’æµ‹è¯•è´¦å·è¿›è¡Œç™»å½•äº†ã€‚

> `æµ‹è¯•ä½¿ç”¨æ²™ç›’æµ‹è¯•è´¦å·ç™»å½•ä½¿ç”¨`

&emsp;  åœ¨æµ‹è¯•åŒ…é‡Œé¢è´­ä¹°å•†å“VIPæ—¶ï¼Œç³»ç»Ÿä¼šè®©ä½ è¿›è¡Œç™»å½•ï¼Œè¿™é‡Œæˆ‘ä»¬ç‚¹å‡»â€œä½¿ç”¨ç°æœ‰çš„AppleIDâ€å°±å¯ä»¥è¾“å…¥åˆšæ‰åˆ›å»ºå¥½çš„æ²™ç›’æµ‹è¯•è´¦å·è¿›è¡Œç™»å½•äº†ã€‚

![ä½¿ç”¨ç”³è¯·çš„æ²™ç›’è´¦å·ç™»å½•](https://upload-images.jianshu.io/upload_images/2959789-908bbae69d3f64a8.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


<br/>

&emsp;  è¾“å…¥è´¦å·ä¹‹åï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°æç¤º`" æ­¤Apple ID åªèƒ½åœ¨iTunes Store ä¸­å›½åº—é¢è´­ä¹°ï¼Œæ‚¨å°†è¢«è·³è½¬è‡³è¯¥é¡µé¢"`ï¼Œç‚¹å‡»ç¡®å®šä¹‹åä¼šè·³è½¬åˆ°App Storeï¼Œå¯¼è‡´è¿™æ¬¡è´­ä¹°å¤±è´¥ã€‚æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å†æ¬¡å›åˆ°æµ‹è¯•åŒ…ï¼Œç„¶åè´­ä¹°å•†å“å°±å¥½äº†ã€‚

&emsp;  åŸå› ï¼šå‡ºç°æç¤ºçš„åŸå› ï¼šå› ä¸ºAppleIDæ˜¯åˆ†åœ°åŒºçš„ã€‚ä¹‹å‰æˆ‘ä»¬åˆ›å»ºæ²™ç›’è´¦å·çš„æ—¶å€™å°±çœ‹åˆ°äº†ï¼Œéœ€è¦é€‰æ‹©åœ°åŒºã€‚App Storeä¹Ÿæ˜¯åˆ†åœ°åŒºçš„ï¼Œå¯¹åº”çš„AppleIDåªèƒ½åœ¨App Storeå¯¹åº”çš„åœ°åŒºè¿›è¡Œä¸‹è½½å’Œè´­ä¹°ä¸œè¥¿ã€‚æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„[harleyTest@123.com](è¿™ä¸ªè´¦å·çš„åœ°åŒºæ˜¯ä¸­å›½ï¼Œæ‰€ä»¥åªèƒ½åœ¨ä¸­å›½åº—é¢ç™»å½•ã€‚ç”±äºæˆ‘ä¹‹å‰çš„ç™»å½•çš„è´¦å·è¶Šå—çš„ï¼Œæ‰€ä»¥æ­¤æ—¶AppStoreåº—é¢æ˜¯è¶Šå—åº—é¢ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™æ¬¡ç™»å½•ï¼Œç³»ç»Ÿä¼šè·³è½¬åˆ°AppStoreåº”ç”¨å°†åº—é¢åˆ‡æ¢åˆ°ä¸­å›½ã€‚å¦å¤–ï¼ŒApp Storeåº”ç”¨åˆ‡æ¢åœ°åŒºçš„æ—¶å€™ï¼Œä¼šæŠ¥ã€Your request produced an errorã€‘ã€‚è¿™ä¸ªä¸éœ€è¦ç®¡ã€‚

<br/>

**`ç‚¹å‡»è´­ä¹°è§†é¢‘VIPä¹‹åï¼ŒæˆåŠŸçš„ä¼šå‡ºç°å¦‚ä¸‹ç›¸åº”æç¤º`**

![ä½¿ç”¨ç”³è¯·çš„æ²™ç›’è´¦å·å¯†ç è¿›è¡Œä»˜æ¬¾](https://upload-images.jianshu.io/upload_images/2959789-21350e55f0f0c6d1.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ³¨æ„äº‹é¡¹ï¼šåœ¨App Store Connectä¸Šåˆ›å»ºå•†å“äº†ä¹‹åï¼Œé™¤äº†éœ€è¦å¡«å•†å“IDï¼Œå•†å“åç§°ï¼Œå•†å“æè¿°ï¼Œä»·æ ¼ç­‰ä¹‹å¤–ï¼Œè¿˜è¦ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡å°±æ˜¯ä¸Šé¢è¿™ä¸ªç•Œé¢ã€‚


<br/>

***
<br/>

># <h1 id='åè®°'>åè®°</h1>


<br/>
<br/>



> <h2 id='æ²™ç›’è´¦å·æ³¨æ„äº‹é¡¹'>æ²™ç›’è´¦å·æ³¨æ„äº‹é¡¹</h2>


&emsp; a. BudleIDï¼Œè¯ä¹¦ï¼Œå•†å“IDç­‰å†…å®¹ä¸€è‡´ï¼Œæ‰èƒ½è¿›è¡Œæ¥ä¸‹æ¥çš„å‚¨å€¼æµ‹è¯•;

&emsp; b. æµ‹è¯•è®¾å¤‡éœ€è¦ä½¿ç”¨ä¸è¶Šç‹±çš„çœŸæœºï¼ˆè¶Šç‹±æœºä¸èƒ½è¿›è¡Œæ²™ç›’å‚¨å€¼ï¼Œæ¨¡æ‹Ÿå™¨ä¹Ÿä¸èƒ½è¿›è¡Œæ²™ç›’å‚¨å€¼ï¼‰

&emsp; c. æ²™ç›’è´¦å·æ˜¯ä¸èƒ½ç›´æ¥åœ¨App Storeè¿›è¡Œç™»å½•çš„ï¼Œåªèƒ½åœ¨ç‚¹å‡»äº†è´­ä¹°å•†å“ä¹‹åï¼Œåœ¨å¼¹å‡ºçš„ç™»å½•æ¡†è¿›è¡Œç™»å½•ã€‚

&emsp; d. çœŸå®çš„AppleIDä¸èƒ½åœ¨adhocè¯ä¹¦å’Œdevelopè¯ä¹¦æ‰“å‡ºæ¥çš„åŒ…è¿›è¡Œæ²™ç›’å‚¨å€¼æµ‹è¯•ï¼Œæ‰€ä»¥åœ¨æ²™ç›’æµ‹è¯•ä¹‹å‰ï¼Œéœ€è¦é€€å‡ºçœŸå®çš„AppleIDè´¦å·

&emsp; e. ä»App Storeä¸Šé¢ä¸‹è½½çš„åŒ…ä¸èƒ½ä½¿ç”¨æ²™ç›’è´¦å·è¿›è¡Œå‚¨å€¼


<br/>
<br/>



> <h2 id='å…³äºè¯ä¹¦çš„é—®é¢˜'>å…³äºè¯ä¹¦çš„é—®é¢˜ï¼š</h2>


&emsp; a .ä½¿ç”¨developç­¾åè¯ä¹¦å’Œadhocç­¾åè¯ä¹¦æ‰“çš„ipaåŒ…ï¼Œæˆ‘æŠŠä»–ä»¬å«åšæµ‹è¯•åŒ…ï¼Œæµ‹è¯•åŒ…åªèƒ½ä½¿ç”¨æ²™ç›’è´¦å·è¿›è¡Œå‚¨å€¼ï¼Œä¸èƒ½ä½¿ç”¨çœŸå®çš„AppleIDè¿›è¡Œå‚¨å€¼

&emsp; b.ä»App Storeåº”ç”¨ä¸‹è½½çš„åŒ…ï¼Œæˆ‘æŠŠä»–ä»¬å«åšçº¿ä¸ŠåŒ…ï¼Œçº¿ä¸ŠåŒ…åªèƒ½ä½¿ç”¨çœŸå®çš„AppleIDè¿›è¡Œå‚¨å€¼ï¼Œä¸èƒ½ä½¿ç”¨æ²™ç›’è´¦å·è¿›è¡Œå‚¨å€¼


<br/>
<br/>



> <h2 id='å°çªé—¨'>å°çªé—¨ï¼š</h2>




&emsp; â‘  å¹³å¸¸æˆ‘ä»¬ä¸Šä¼ åŒ…çš„æ—¶å€™æ˜¯æ‰“åŒ…äº†ipaåŒ…ä¹‹åï¼Œä½¿ç”¨Xcodeé‡Œé¢çš„Application Loaderåº”ç”¨ä¸Šä¼ ipaåŒ…çš„ï¼›
&emsp; â‘  è™½ç„¶å¾ˆå¤šäººä¸Šä¼ åŒ…ä½¿ç”¨çš„æ˜¯appstoreçš„ç­¾åè¯ä¹¦ï¼Œä½†æ˜¯ï¼Œå…¶å®ä½¿ç”¨adhocçš„è¯ä¹¦æ‰“åŒ…çš„ipaåŒ…ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸ä¸Šä¼ å¹¶ä¸”é€å®¡ä¸Šçº¿çš„ã€‚æˆ‘å¹³å¸¸å°±æ˜¯ç”¨adhocçš„è¯ä¹¦æ‰“åŒ…æˆipaåŒ…ï¼Œç»™æµ‹è¯•å¦¹å­æµ‹è¯•ï¼Œæµ‹è¯•å®Œç›´æ¥ç”¨è¿™ä¸ªåŒ…ä¸Šä¼ é€å®¡äº†ã€‚ğŸ˜†ã€‚


<br/>

***
<br/>
<br/>


> <h1 id='è‹¹æœå†…è´­ä¸¤ç§æ¨¡å¼'>è‹¹æœå†…è´­ä¸¤ç§æ¨¡å¼</h1>


<br/>



> <h2 id='æœåŠ¡å™¨æ¨¡å¼'>æœåŠ¡å™¨æ¨¡å¼</h2>



>a.  è°ƒç”¨æœåŠ¡å™¨æ¥å£åˆ›å»ºä¸€ä¸ªå•†å“çš„è®¢å•;

>b.  è¯·æ±‚Appleçš„å•†å“åˆ—è¡¨;

>c.  é€‰å–å•†å“è°ƒç”¨è‹¹æœæ”¯ä»˜;

>d.  æ”¯ä»˜æˆåŠŸï¼ˆä¼šè¿”å›å‡­è¯ï¼‰;

>e.  æŠŠæ”¯ä»˜æˆåŠŸçš„è¿”å›å‡­è¯ä¸Šä¼ åˆ°APPæœåŠ¡å™¨ï¼ˆå¸¦ä¸Šè®¢å•çš„IDï¼Œæœ‰åˆ©äºåå°åˆ¤æ–­æ˜¯å“ªä¸ªè®¢å•æ”¯ä»˜æˆåŠŸï¼‰;

>f.  APPæœåŠ¡å™¨ä¿å­˜è¯¥å‡­è¯ç­‰æ•°æ®å¹¶åƒè‹¹æœæœåŠ¡å™¨å‘èµ·å‡­è¯éªŒè¯ï¼ŒéªŒè¯æˆåŠŸåˆ™å‘é€å•†å“ã€‚


<br/>
<br/>



> <h2 id='æœ¬åœ°æ¨¡å¼'>æœ¬åœ°æ¨¡å¼</h2>


>a.  è¯·æ±‚Appleçš„å•†å“åˆ—è¡¨;

>b.  é€‰å–å•†å“è°ƒç”¨è‹¹æœæ”¯ä»˜;

>c.  æ”¯ä»˜æˆåŠŸï¼ˆä¼šè¿”å›å‡­è¯ï¼‰;

>d.  æŠŠå‡­è¯ä¸å•†å“å‘é€çŠ¶æ€ä¿å­˜åˆ°ä¸€ä¸ªæœ¬åœ°çš„æ•°æ®åº“;

>e.  appè°ƒç”¨appleæœåŠ¡å™¨çš„éªŒè¯API;

>f.  éªŒè¯æˆåŠŸå‘é€å•†å“å¹¶æ”¹å˜æ•°æ®åº“çš„ç‰©å“å‘é€çŠ¶æ€;


<br/>
<br/>



> <h2 id='æ ¸å¿ƒä»£ç '>æ ¸å¿ƒä»£ç </h2>

```
//å¯¼å…¥æ–‡ä»¶ï¼š
#import <StoreKit/StoreKit.h>
#pragma mark -- ApplePay
//äº§å“IDå·
#define ApplePayInPurchase          @"com.tianYingXinXi.XXX"

//éµå®ˆSKPaymentTransactionObserverã€SKProductsRequestDelegateåè®®
@interface VIPMemberController ()<UITextViewDelegate, SKPaymentTransactionObserver, SKProductsRequestDelegate>



//è®¾ç½®æ”¯ä»˜æœåŠ¡
[[SKPaymentQueue defaultQueue] addTransactionObserver:self];

[self applePayWithVIP];

//ç»“æŸåä¸€å®šè¦é”€æ¯
- (void)dealloc
{
    [[SKPaymentQueue defaultQueue] removeTransactionObserver:self];
}

- (void) applePayWithVIP {
    if ([SKPaymentQueue canMakePayments]) {
        NSLog(@"yes");
        
        [self getRequestAppleProductID:@"ProductID"];
    }else {
        NSLog(@"not");
    }
}


//è¯·æ±‚è‹¹æœåå°å•†å“
- (void) getRequestAppleProductID:(NSString *)productID {
    //ApplePayInPurchaseå¯¹åº”ç€è‹¹æœåå°çš„å•†å“ID,ä»–ä»¬æ˜¯é€šè¿‡è¿™ä¸ªIDè¿›è¡Œè”ç³»çš„
    NSArray *product = [[NSArray alloc] initWithObjects:ApplePayInPurchase , nil];
    NSSet *nsset = [NSSet setWithArray:product];
    
    //åˆå§‹åŒ–è¯·æ±‚
    SKProductsRequest *request = [[SKProductsRequest alloc] initWithProductIdentifiers:nsset];
    request.delegate = self;
    
    //å¼€å§‹è¯·æ±‚
    [request start];
}


#pragma mark -- SKProductsRequestDelegate
- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response {
    NSArray *product = response.products;
    
    //æœåŠ¡å™¨æ²¡æœ‰äº§å“
    if ([product count] == 0) {
        NSLog(@"æœåŠ¡å™¨æ²¡æœ‰äº§å“");
        return;
    }
    
    SKProduct *requestProduct = nil;
    for (SKProduct *pro in product) {
        NSLog(@"%@", [pro description]);
        NSLog(@"%@", [pro localizedTitle]);
        NSLog(@"%@", [pro localizedDescription]);
        NSLog(@"%@", [pro price]);
        NSLog(@"%@", [pro productIdentifier]);
        
        //å¦‚æœåå°æ¶ˆè´¹æ¡ç›®çš„IDä¸æˆ‘è¿™é‡Œéœ€è¦è¯·æ±‚çš„ä¸€æ ·ï¼ˆç”¨äºç¡®ä¿è®¢å•çš„æ­£ç¡®æ€§ï¼‰
        if ([pro.productIdentifier isEqualToString:ApplePayInPurchase]) {
            requestProduct = pro;
        }
    }
    
    
    //å‘é€è´­ä¹°è¯·æ±‚
    SKPayment *payment = [SKPayment paymentWithProduct:requestProduct];
    [[SKPaymentQueue defaultQueue] addPayment:payment];
}



#pragma mark -- SKRequestDelegate
//è¯·æ±‚å¤±è´¥
- (void)request:(SKRequest *)request didFailWithError:(NSError *)error {
    NSLog(@"è¯·æ±‚å¤±è´¥error: %@", error);
}
//åé¦ˆè¯·æ±‚çš„äº§å“ä¿¡æ¯ç»“æŸå
- (void)requestDidFinish:(SKRequest *)request{
    NSLog(@"ä¿¡æ¯åé¦ˆç»“æŸ");
}



#pragma mark -- SKPaymentTransactionObserver
//ç›‘å¬è´­ä¹°ç»“æœ
- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray<SKPaymentTransaction *> *)transactions {
    for (SKPaymentTransaction *tran in transactions) {
        switch (tran.transactionState) {
            case SKPaymentTransactionStatePurchased://è´­ä¹°æˆåŠŸ
                NSLog(@"äº¤æ˜“å®Œæˆ");
                [self completeTransaction:tran];
                break;
                
            case SKPaymentTransactionStatePurchasing://æ­£åœ¨å¤„ç†
                NSLog(@"å•†å“æ·»åŠ è¿›åˆ—è¡¨");
                break;
                
            case SKPaymentTransactionStateRestored://æ¢å¤è´­ä¹°
                NSLog(@"å·²ç»è´­ä¹°è¿‡å•†å“");
                [[SKPaymentQueue defaultQueue] finishTransaction:tran];
                break;
                
            case SKPaymentTransactionStateFailed:
                NSLog(@"äº¤æ˜“å¤±è´¥");
                [[SKPaymentQueue defaultQueue] finishTransaction:tran];
                break;
                
            default:
                break;
        }
    }
}

//äº¤æ˜“ç»“æŸ,å½“äº¤æ˜“ç»“æŸåè¿˜è¦å»appstoreä¸ŠéªŒè¯æ”¯ä»˜ä¿¡æ¯æ˜¯å¦éƒ½æ­£ç¡®,åªæœ‰æ‰€æœ‰éƒ½æ­£ç¡®å,æˆ‘ä»¬å°±å¯ä»¥ç»™ç”¨æˆ·æ–¹æ³•æˆ‘ä»¬çš„è™šæ‹Ÿç‰©å“äº†
- (void) completeTransaction:(SKPaymentTransaction *)transaction {
    NSString *str = [[NSString alloc] initWithData:transaction.transactionReceipt encoding:NSUTF8StringEncoding];
    NSString *environment = [self environmentForReceipt:str];
    
    NSLog(@"----- å®Œæˆäº¤æ˜“è°ƒç”¨çš„æ–¹æ³•completeTransaction 1--------%@",environment);
    
    //éªŒè¯å‡­æ®ï¼Œè·å–åˆ°è‹¹æœè¿”å›çš„äº¤æ˜“å‡­æ®
    //éªŒè¯å‡­æ®ï¼Œè·å–åˆ°è‹¹æœè¿”å›çš„äº¤æ˜“å‡­æ®
    NSURL *receiptURL = [[NSBundle mainBundle] appStoreReceiptURL];
    //ä»æ²™ç›’ä¸­è·å–åˆ°è´­ä¹°å‡­æ®
    NSData *receiptData = [NSData dataWithContentsOfURL:receiptURL];
    

    //éªŒè¯è¿”å›çš„æ•°æ®ï¼Œé˜²æ­¢ç²¤è¯­(å®‰å…¨æ€§ä¸é«˜çš„å¯ä»¥ä¸ç”¨çœ‹ä¸‹é¢çš„ä»£ç )
    //å°è£…çš„éªŒè¯æ–¹æ³•
    /**
        NSString *receipt = [receiptData base64EncodedStringWithOptions:NSDataBase64Encoding64CharacterLineLength];
        if ([receipt length] > 0 && [productIdentifier length] > 0) {
        [SVProgressHUD showInfoWithStatus:@"æ”¯ä»˜æˆåŠŸ!"];
             //å¯ä»¥å°†receiptå‘ç»™æœåŠ¡å™¨è¿›è¡Œè´­ä¹°éªŒè¯
             [self dl_validateReceiptWiththeAppStore:receipt];
         }
    */

    //BASE64 å¸¸ç”¨çš„ç¼–ç æ–¹æ¡ˆï¼Œé€šå¸¸ç”¨äºæ•°æ®ä¼ è¾“ï¼Œä»¥åŠåŠ å¯†ç®—æ³•çš„åŸºç¡€ç®—æ³•ï¼Œä¼ è¾“è¿‡ç¨‹ä¸­èƒ½å¤Ÿä¿è¯æ•°æ®ä¼ è¾“çš„ç¨³å®šæ€§
    //BASE64æ˜¯å¯ä»¥ç¼–ç å’Œè§£ç çš„
    NSString *encodeStr = [receiptData base64EncodedStringWithOptions:NSDataBase64EncodingEndLineWithLineFeed];
    NSString *sendString = [NSString stringWithFormat:@"{\"receipt-data\" : \"%@\"}", encodeStr];
    NSLog(@"_____%@",sendString);
    NSURL *StoreURL=nil;
    if ([environment isEqualToString:@"environment=Sandbox"]) {
        StoreURL = [[NSURL alloc] initWithString:@"https://sandbox.itunes.apple.com/verifyReceipt"];
    }else {
        StoreURL = [[NSURL alloc] initWithString:@"https://buy.itunes.apple.com/verifyReceipt"];
    }
    
    //è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®ç”±æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼›zl
    NSData *postData = [NSData dataWithBytes:[sendString UTF8String] length:[sendString length]];
    
    NSLog(@"++++++%@",postData);
    NSMutableURLRequest *connectionRequest = [NSMutableURLRequest requestWithURL:StoreURL];
    
    [connectionRequest setHTTPMethod:@"POST"];
    [connectionRequest setTimeoutInterval:50.0];//120.0---50.0zl
    [connectionRequest setCachePolicy:NSURLRequestUseProtocolCachePolicy];
    [connectionRequest setHTTPBody:postData];
    
    //å¼€å§‹è¯·æ±‚
    NSError *error=nil;
    NSData *responseData=[NSURLConnection sendSynchronousRequest:connectionRequest returningResponse:nil error:&error];
    if (error) {
        NSLog(@"éªŒè¯è´­ä¹°è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯ï¼š%@",error.localizedDescription);
        return;
    }
    NSDictionary *dic=[NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingAllowFragments error:nil];
    NSLog(@"è¯·æ±‚æˆåŠŸåçš„æ•°æ®:%@",dic);
    
    //è¿™é‡Œå¯ä»¥ç­‰å¾…ä¸Šé¢è¯·æ±‚çš„æ•°æ®å®Œæˆåå¹¶ä¸”state = 0 éªŒè¯å‡­æ®æˆåŠŸæ¥åˆ¤æ–­åè¿›å…¥è‡ªå·±æœåŠ¡å™¨é€»è¾‘çš„åˆ¤æ–­,ä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡ŒæœåŠ¡å™¨é€»è¾‘çš„åˆ¤æ–­,éªŒè¯å‡­æ®ä¹Ÿå°±æ˜¯ä¸€ä¸ªå®‰å…¨çš„é—®é¢˜ã€‚æ¥¼ä¸»è¿™é‡Œæ²¡æœ‰ç”¨state = 0 æ¥åˆ¤æ–­ã€‚
    // [[SKPaymentQueue defaultQueue] finishTransaction: transaction];
    
    NSString *product = transaction.payment.productIdentifier;
    
    NSLog(@"transaction.payment.productIdentifier++++%@",product);
    
    if ([product length] > 0)
    {
        NSArray *tt = [product componentsSeparatedByString:@"."];
        
        NSString *bookid = [tt lastObject];
        
        if([bookid length] > 0)
        {
            
            NSLog(@"æ‰“å°bookid%@",bookid);
            //è¿™é‡Œå¯ä»¥åšæ“ä½œå§ç”¨æˆ·å¯¹åº”çš„è™šæ‹Ÿç‰©å“é€šè¿‡è‡ªå·±æœåŠ¡å™¨è¿›è¡Œä¸‹å‘æ“ä½œ,æˆ–è€…åœ¨è¿™é‡Œé€šè¿‡åˆ¤æ–­å¾—åˆ°ç”¨æˆ·å°†ä¼šå¾—åˆ°å¤šå°‘è™šæ‹Ÿç‰©å“,åœ¨åé¢ï¼ˆ[self getApplePayDataToServerRequsetWith:transaction];çš„åœ°æ–¹ï¼‰ä¸Šä¼ ä¸Šé¢è‡ªå·±çš„æœåŠ¡å™¨ã€‚
        }
    }
    //æ­¤æ–¹æ³•ä¸ºå°†è¿™ä¸€æ¬¡æ“ä½œä¸Šä¼ ç»™æˆ‘æœ¬åœ°æœåŠ¡å™¨,è®°å¾—åœ¨ä¸Šä¼ æˆåŠŸè¿‡åä¸€å®šè¦è®°å¾—é”€æ¯æœ¬æ¬¡æ“ä½œã€‚è°ƒç”¨[[SKPaymentQueue defaultQueue] finishTransaction: transaction];
//    [self getApplePayDataToServerRequsetWith:transaction];
    NSLog(@"--->> %@", transaction);
    

}

-(NSString * )environmentForReceipt:(NSString * )str
{
    str= [str stringByReplacingOccurrencesOfString:@"\r\n" withString:@""];
    
    str = [str stringByReplacingOccurrencesOfString:@"\n" withString:@""];
    
    str = [str stringByReplacingOccurrencesOfString:@"\t" withString:@""];
    
    str=[str stringByReplacingOccurrencesOfString:@" " withString:@""];
    
    str=[str stringByReplacingOccurrencesOfString:@"\"" withString:@""];
    
    NSArray * arr=[str componentsSeparatedByString:@";"];
    
    //å­˜å‚¨æ”¶æ®ç¯å¢ƒçš„å˜é‡
    NSString * environment=arr[2];
    return environment;
}


-(void)dl_validateReceiptWiththeAppStore:(NSString *)receipt
{
    NSError *error;
    NSDictionary *requestContents = @{@"receipt-data": receipt};
    NSData *requestData = [NSJSONSerialization dataWithJSONObject:requestContents options:0 error:&error];
    
    if (!requestData) {
    
    }else{
        
    }
    NSURL *storeURL;
#ifdef DEBUG
    storeURL = [NSURL URLWithString:@"https://sandbox.itunes.apple.com/verifyReceipt"];
#else
    storeURL = [NSURL URLWithString:@"https://buy.itunes.apple.com/verifyReceipt"];
#endif
    
    NSMutableURLRequest *storeRequest = [NSMutableURLRequest requestWithURL:storeURL];
    [storeRequest setHTTPMethod:@"POST"];
    [storeRequest setHTTPBody:requestData];
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    [NSURLConnection sendAsynchronousRequest:storeRequest queue:queue
                           completionHandler:^(NSURLResponse *response, NSData *data, NSError *connectionError) {
                               if (connectionError) {
                                  /* å¤„ç†error */
                               } else {
                                   NSError *error;
                                   NSDictionary *jsonResponse = [NSJSONSerialization JSONObjectWithData:data options:0 error:&error];
                                   if (!jsonResponse) {
                                       /* å¤„ç†error */
                                   }else{
                                       /* å¤„ç†éªŒè¯ç»“æœ */
                                   }
                               }
                           }];

}

```




<br/>

***
<br/>



># <h1 id='æ”¯ä»˜å®'>æ”¯ä»˜å®</h1>




- **CocoaPods ä¸‹è½½SDK**

```
//æœç´¢æœ€æ–°ç‰ˆ
$ pod search AlipaySDK-iOS

//æ‰¾åˆ°æœ€æ–°ç‰ˆæœ¬ï¼špod 'AlipaySDK-iOS', '~> 15.5.9',å°†å…¶å¤åˆ¶åˆ°Podfileæ–‡ä»¶ä¸­ã€‚
//åˆ é™¤Podfile.lockæ–‡ä»¶

//æ›´æ–°ç¬¬ä¸‰æ–¹ç±»åº“æ–‡ä»¶
$pod update --verbose

``` 



<br/>
<br/>


- **ä½¿ç”¨AlipaySDKæ–‡ä»¶**

åœ¨å®æ–‡ä»¶ä¸­å¯¼å…¥AlipaySDKï¼š`#import <AlipaySDK/AlipaySDK.h>`

**è®¾ç½®URL Type**'

ã€é¡¹ç›®æ–‡ä»¶ã€‘->ã€TARGETSã€‘->ã€é¡¹ç›®åã€‘->ã€infoã€‘->ã€URL Typesã€‘ç„¶åç‚¹å‡»â€œ + â€åœ¨URL Schemesä¸­å‘½åä¸€ä¸ªåç§°å­—ç¬¦ä¸²(æœ€å¥½æ˜¯ä¸é¡¹ç›®æœ‰å…³çš„åå­—)ã€‚

```
# FloatLaverView.m æ–‡ä»¶
//æ³¨æ„ï¼šæœ‰çš„åç«¯ä¸€è‚¡è„‘æŠŠæ•°æ®ä¼ è¿‡æ¥æ²¡å¤„ç†ï¼Œéœ€è¦å‰ç«¯å–å­—æ®µâ€œparamsâ€å’Œâ€œsignâ€
NSString *orderInfo = [NSString stringWithFormat:@"%@&sign=%@", model[@"params"], model[@"sign"]];

//æ³¨æ„ï¼šURL Typeä¸­ä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œå¦åˆ™å­—ç¬¦å®é‚£è¾¹æ— æ³•è¯†åˆ«ï¼Œå¦‚ï¼š@"taijidao://"
[[AlipaySDK defaultService] payOrder:orderInfo fromScheme:@"taijidao" callback:^(NSDictionary *resultDic) {
            //åœ¨ç‰ˆæœ¬ AlipaySDK-iOS 15.5.9 ä¸­ï¼Œè¿™é‡Œä¸æ”¯æŒå›è°ƒäº†ï¼Œéœ€è¦åœ¨AppDelegate.m æ–‡ä»¶ä¸­ï¼Œå¯¹å›è°ƒè¿›è¡Œå¤„ç†
        }];
    } failure:^(id  _Nonnull fail) {
        [SVProgressHUD showErrorWithStatus:@"æ”¯ä»˜å¼‚å¸¸!"];
    }];


# AppDelegate.m æ–‡ä»¶
- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary<UIApplicationOpenURLOptionsKey,id> *)options {
    
    if ([url.host isEqualToString:@"safepay"]) {
        //æ”¯ä»˜å®è·³è½¬æ”¯ä»˜å®é’±åŒ…è¿›è¡Œæ”¯ä»˜ï¼Œå¤„ç†æ”¯ä»˜ç»“æœ
        [[AlipaySDK defaultService] processOrderWithPaymentResult:url standbyCallback:^(NSDictionary *resultDic) {
            
            if ([resultDic[@"resultStatus"] integerValue] == 9000) {
                [SVProgressHUD showSuccessWithStatus:@"æ”¯ä»˜æˆåŠŸ!"];
                [[NSNotificationCenter defaultCenter] postNotificationName:aliPaySuccess object:nil];
            }else {
                [SVProgressHUD showSuccessWithStatus:@"æ”¯ä»˜å¼‚å¸¸!"];
                [[NSNotificationCenter defaultCenter] postNotificationName:aliPaySuccess object:nil];
            }
        }];
        
        //æˆæƒè·³è½¬æ”¯ä»˜å®é’±åŒ…è¿›è¡Œæ”¯ä»˜ï¼Œå¤„ç†æ”¯ä»˜ç»“æœ
        [[AlipaySDK defaultService] processAuth_V2Result:url standbyCallback:^(NSDictionary *resultDic) {
            //è§£æ auth Code
            NSString *result = resultDic[@"result"];
            NSString *authCode = nil;
            if (result.length > 0) {
                NSArray *resultArr = [result componentsSeparatedByString:@"&"];
                for (NSString *subResult in resultArr) {
                    if (subResult.length > 10 && [subResult hasPrefix:@"auth_code="]) {
                        authCode = [subResult substringFromIndex:10];
                        break;
                    }
                }
            }
            NSLog(@"æ”¯ä»˜å®æˆæƒç»“æœ authCode = %@", authCode?:@"");
        }];
    }
    
    return YES;
}
```


<br/>
<br/>

> <h2 id='é”™è¯¯è§£å†³'>é”™è¯¯è§£å†³</h2> 


![é˜¿é‡ŒSDKæ‹·å…¥æŠ¥é”™](https://upload-images.jianshu.io/upload_images/2959789-425451f4076cb987.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![é˜¿é‡ŒSDKåŠ å…¥ä¾èµ–åº“](https://upload-images.jianshu.io/upload_images/2959789-09b6dd62ca06f8ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

&emsp; è¿™æ˜¯è®¸å¤šå¼€å‘è€…åœ¨ä½¿ç”¨é˜¿é‡ŒSDKé‡åˆ°çš„å‘ä¹‹ä¸€ï¼Œå½“æˆ‘ä»¬æŒ‰ç…§é˜¿é‡Œçš„æŒ‡ç¤ºå°†å®ƒæ‰€è¯´çš„SDKå®å¯¼å…¥å·¥ç¨‹ä¸­ï¼Œå¹¶æŒ‰ç…§æŒ‡ç¤ºåŠ å…¥ä¾èµ–åº“ï¼Œå¦‚ï¼šã€é˜¿é‡ŒSDKåŠ å…¥ä¾èµ–åº“ã€‘æ‰€ç¤ºã€‚ç­‰åŠ å®Œä¾èµ–åº“åï¼Œæˆ‘ä»¬å‘ç°æŠ¥é”™ç»§ç»­å­˜åœ¨ï¼Œæ²¡æœ‰è§£å†³ã€‚æŠ¥é”™ä»ç„¶å¦‚å›¾ï¼šã€[é˜¿é‡ŒSDKæ‹·å…¥æŠ¥é”™ã€‘æ‰€ç¤ºï¼Œå¥½åƒé™·å…¥äº†æ­»å¾ªç¯ã€‚

&emsp; How do you do ?

&emsp; è¿™æ—¶æŸ¥ç™¾åº¦ï¼Œå‘ç°è¿™æ ·åšæ˜¯å¯ä»¥çš„ã€‚å°†åŸé˜¿é‡ŒSDKçš„ç¬¬ä¸‰æ–¹åº“åˆ é™¤æ‰”æ‰åƒåœ¾ç¯“ï¼Œå°†é˜¿é‡Œçš„Demoæ‹·å…¥åˆ°é¡¹ç›®ä¸­ï¼Œå†è¿è¡Œå‘ç°å®Œç¾è¿è¡Œã€‚é—®é¢˜è§£å†³ï¼ï¼




<br/>

***
<br/>


># <h1 id='å¾®ä¿¡æ”¯ä»˜'>å¾®ä¿¡æ”¯ä»˜</h1>






<br/>

***
<br/>
<br/>


> <h1 id='å¾®ä¿¡åˆ†äº«'>å¾®ä¿¡åˆ†äº«</h1>


<br/>

> <h2 id='åˆ†äº«æ–‡æœ¬'>åˆ†äº«æ–‡æœ¬</h2>


**AppDelegateçš„é…ç½®**

åœ¨`AppDelegate.h`æ–‡ä»¶ä¸­ï¼Œå¯¼å…¥ ï¼š**`#import WXApi æ–‡ä»¶`**

```
#import "WXApi.h"
```

**`AppDelegate.m æ–‡ä»¶ä¸­`**

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    [AppDelegate weixinShareRegister];
    
    return YES;
}

#pragma mark -- å¾®ä¿¡åˆ†äº«
+ (void) weixinShareRegister {
        //æ³¨å†ŒappID
    [WXApi registerApp:WXShareAppID enableMTA:false];
}


//ä»å¾®ä¿¡åˆ†äº«è¿‡åç‚¹å‡»è¿”å›åº”ç”¨çš„æ—¶å€™è°ƒç”¨
- (void)onResp:(BaseResp *)resp {
    
    SendMessageToWXResp *sendResp = (SendMessageToWXResp *)resp;
    
    NSString *str = [NSString stringWithFormat:@"%d", sendResp.errCode];
    UIAlertController *ac = [UIAlertController alertControllerWithTitle:@"å›è°ƒä¿¡æ¯" message:[NSString stringWithFormat:@"onResp errCode:  %@", str] preferredStyle:UIAlertControllerStyleAlert];
    
    UIAlertAction *okAction = [UIAlertAction actionWithTitle:@"OK" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        [self.window.rootViewController dismissViewControllerAnimated:YES completion:nil];
    }];
    [ac addAction:okAction];
    [self.window.rootViewController presentViewController:ac animated:YES completion:nil];
}


- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary<UIApplicationOpenURLOptionsKey,id> *)options {
    return [WXApi handleOpenURL:url delegate:self];

}

@end

```

**`HGMyController.m æ–‡ä»¶ä¸­`**

```
- (void)viewDidLoad {
    [super viewDidLoad];
    
    [self testShareFunction];
}


- (void) testShareFunction {
    CGRect frame = CGRectMake(50, 100, 100, 60);
    UIButton *button = [[UIButton alloc] initWithFrame:frame];
    button.backgroundColor = [UIColor greenColor];
    [button addTarget:self action:@selector(shareButtonClick:) forControlEvents:UIControlEventTouchUpInside];
    
    [self.view addSubview:button];
    
}


//åˆ†äº«æ–‡æœ¬åˆ°å¾®ä¿¡
- (void)shareButtonClick:(id)sender {
    SendMessageToWXReq *req = [[SendMessageToWXReq alloc]init];
    req.bText = YES;           // æŒ‡å®šä¸ºå‘é€æ–‡æœ¬
    req.text = @"hello world"; // è¦å‘é€çš„æ–‡æœ¬
    req.scene = WXSceneSession;// æŒ‡å®šå‘é€åˆ°ä¼šè¯
    [WXApi sendReq:req];
}

```


**`é…ç½®å¥½ URL typesï¼Œå¦åˆ™æ— æ³•è¿”å›è‡ªå·±çš„App`**

![é…ç½®åˆ†äº«çš„App URL types](https://upload-images.jianshu.io/upload_images/2959789-8a406946d8503fcf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

<br/>

**æ•ˆæœå›¾**

![å‡†å¤‡å‘é€å›¾ç‰‡](https://upload-images.jianshu.io/upload_images/2959789-c96cc72f327c5b29.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![å¾®ä¿¡èŠå¤©æ•ˆæœå›¾](https://upload-images.jianshu.io/upload_images/2959789-1728be22b7aec527.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


![è¿”å›App å›è°ƒçš„æ–¹æ³•](https://upload-images.jianshu.io/upload_images/2959789-43269f39225f199c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

<br/>
<br/>

># <h2 id='åˆ†äº«é“¾æ¥'>åˆ†äº«é“¾æ¥</h2> åˆ†äº«é“¾æ¥ åˆ†äº«æ–‡æœ¬

***`HGMyController.m æ–‡ä»¶`***
```
-(void)sendUrl:(NSString*)url To:(enum WXScene)scene{
    SendMessageToWXReq *req = [[SendMessageToWXReq alloc]init];
    //æ˜¯å¦æ˜¯æ–‡æ¡£
    req.bText = NO;
    req.scene = WXSceneSession;// åˆ†äº«åˆ°ä¼šè¯
    WXMediaMessage *medMessage = [WXMediaMessage message];
    medMessage.title = @"Harley's Main Page For Jian Shu"; // æ ‡é¢˜
    medMessage.description = @"Harley ç®€ä¹¦çš„ iOS å¼€å‘è¦ç‚¹é›†ç»“!!!";// æè¿°
    WXWebpageObject *webPageObj = [WXWebpageObject object];
    [medMessage setThumbImage:[UIImage imageNamed:@"icon"]];// ç¼©ç•¥å›¾
    webPageObj.webpageUrl = @"https://www.jianshu.com/u/af13309587fb";
    //å®Œæˆå‘é€å¯¹è±¡å®ä¾‹
    medMessage.mediaObject = webPageObj;
    req.message = medMessage;
    
    //å‘é€åˆ†äº«ä¿¡æ¯
    [WXApi sendReq:req];
}
```

<br/>

**æ•ˆæœå›¾ï¼š**

![å‡†å¤‡å‘é€](https://upload-images.jianshu.io/upload_images/2959789-0f86799075120eed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![æ•ˆæœå›¾](https://upload-images.jianshu.io/upload_images/2959789-21be0fb772acb335.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
å¤§å›¾ä¸ºç½‘é¡µçš„ç¼©ç•¥å›¾ã€‚



<br/>
<br/>


># <h2 id='åˆ†äº«Music'>åˆ†äº«Music</h2>  åˆ†äº«é“¾æ¥ åˆ†äº«æ–‡æœ¬ åˆ†äº«Music

**`HGMyController.m æ–‡ä»¶`**

```
- (void) wxShareMusic {
  SendMessageToWXReq *req1 = [[SendMessageToWXReq alloc]init];
    
    // æ˜¯å¦æ˜¯æ–‡æ¡£
    req1.bText =  NO;
    
    //    WXSceneSession  = 0,        /**< èŠå¤©ç•Œé¢    */
    //    WXSceneTimeline = 1,        /**< æœ‹å‹åœˆ      */
    //    WXSceneFavorite = 2,
    
    
    req1.scene = WXSceneSession;
    
    //åˆ›å»ºåˆ†äº«å†…å®¹å¯¹è±¡
    WXMediaMessage *urlMessage = [WXMediaMessage message];
    urlMessage.title = @"åˆ†äº«ä¸€é¦–æ­Œ";//åˆ†äº«æ ‡é¢˜
    urlMessage.description = @"ä¸€é¦–å°æ­Œ,æ”¾æ¾ä¸€ä¸‹";//åˆ†äº«æè¿°
    
    [urlMessage setThumbImage:[UIImage imageNamed:@"XXshar"]];//åˆ†äº«å›¾ç‰‡,ä½¿ç”¨SDKçš„setThumbImageæ–¹æ³•å¯å‹ç¼©å›¾ç‰‡å¤§å°
    
    //åˆ›å»ºå¤šåª’ä½“å¯¹è±¡
    
    static NSString *kLinkURL = @"http://bd.kuwo.cn/yinyue/718535?from=baidu";
    
    WXMusicObject *music = [WXMusicObject object];
    music.musicUrl = kLinkURL;//åˆ†äº«é“¾æ¥
    
    //å®Œæˆå‘é€å¯¹è±¡å®ä¾‹
    urlMessage.mediaObject = music;
    req1.message = urlMessage;
    
    //å‘é€åˆ†äº«ä¿¡æ¯
    [WXApi sendReq:req1];
    
}
```

<br/>

***æ•ˆæœå›¾***

![åˆ†äº«Music](https://upload-images.jianshu.io/upload_images/2959789-dedd4d1997f035d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


<br/>
<br/>

># <h2 id='åˆ†äº«Video'>åˆ†äº«Video</h2>  



***`HGMyController.m æ–‡ä»¶`***

```
- (void) wxShareVideo {
   SendMessageToWXReq *req1 = [[SendMessageToWXReq alloc]init];
    
    // æ˜¯å¦æ˜¯æ–‡æ¡£
    req1.bText =  NO;
    
    //    WXSceneSession  = 0,        /**< èŠå¤©ç•Œé¢    */
    //    WXSceneTimeline = 1,        /**< æœ‹å‹åœˆ      */
    //    WXSceneFavorite = 2,
    
    
    req1.scene = 0;
    
    //åˆ›å»ºåˆ†äº«å†…å®¹å¯¹è±¡
    WXMediaMessage *urlMessage = [WXMediaMessage message];
    urlMessage.title = @"åˆ†äº«è§†é¢‘";//åˆ†äº«æ ‡é¢˜
    urlMessage.description = @"å°è§†é¢‘";//åˆ†äº«æè¿°
    
    [urlMessage setThumbImage:[UIImage imageNamed:@"XXshar"]];//åˆ†äº«å›¾ç‰‡,ä½¿ç”¨SDKçš„setThumbImageæ–¹æ³•å¯å‹ç¼©å›¾ç‰‡å¤§å°
    
    //åˆ›å»ºå¤šåª’ä½“å¯¹è±¡
    
    static NSString *kLinkURL = @"http://baidu.wasu.cn/kan/a9OrA?fr=v.baidu.com/browse";
    
    WXVideoObject *video = [WXVideoObject object];
    video.videoUrl = kLinkURL;//åˆ†äº«é“¾æ¥
    
    //å®Œæˆå‘é€å¯¹è±¡å®ä¾‹
    urlMessage.mediaObject = video;
    req1.message = urlMessage;
    
    //å‘é€åˆ†äº«ä¿¡æ¯
    [WXApi sendReq:req1];

}

```

<br/>

***æ•ˆæœå›¾***

![åˆ†äº«Video](https://upload-images.jianshu.io/upload_images/2959789-ba4ba79b559ee50b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



<br/>
<br/>



># <h2 id='åˆ†äº«å›¾ç‰‡'>åˆ†äº«å›¾ç‰‡</h2>  

***`HGMyController.m æ–‡ä»¶`***

```
- (void) wxShareVideo {
       SendMessageToWXReq *req1 = [[SendMessageToWXReq alloc]init];
    
    // æ˜¯å¦æ˜¯æ–‡æ¡£
    req1.bText =  NO;
    
    //    WXSceneSession  = 0,        /**< èŠå¤©ç•Œé¢    */
    //    WXSceneTimeline = 1,        /**< æœ‹å‹åœˆ      */
    //    WXSceneFavorite = 2,
    
    
    req1.scene = 0;
    
    //åˆ›å»ºåˆ†äº«å†…å®¹å¯¹è±¡
    WXMediaMessage *urlMessage = [WXMediaMessage message];
    urlMessage.title = @"åˆ†äº«è§†é¢‘";//åˆ†äº«æ ‡é¢˜
    urlMessage.description = @"å°è§†é¢‘";//åˆ†äº«æè¿°
    
    [urlMessage setThumbImage:[UIImage imageNamed:@"XXshar"]];//åˆ†äº«å›¾ç‰‡,ä½¿ç”¨SDKçš„setThumbImageæ–¹æ³•å¯å‹ç¼©å›¾ç‰‡å¤§å°
    
    //åˆ›å»ºå¤šåª’ä½“å¯¹è±¡
    
    static NSString *kLinkURL = @"http://baidu.wasu.cn/kan/a9OrA?fr=v.baidu.com/browse";
    
    WXVideoObject *video = [WXVideoObject object];
    video.videoUrl = kLinkURL;//åˆ†äº«é“¾æ¥
    
    //å®Œæˆå‘é€å¯¹è±¡å®ä¾‹
    urlMessage.mediaObject = video;
    req1.message = urlMessage;
    
    //å‘é€åˆ†äº«ä¿¡æ¯
    [WXApi sendReq:req1];

}

```

<br/>

**æ•ˆæœå›¾**

![åˆ†äº«å›¾ç‰‡](https://upload-images.jianshu.io/upload_images/2959789-837c4d58aba46acd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)







<br/>
<br/>



> <h2 id=''></h2>



<br/>
<br/>



> <h2 id=''></h2>



<br/>
<br/>



> <h2 id=''></h2>



<br/>
<br/>



> <h2 id=''></h2>



<br/>
<br/>



> <h2 id=''></h2>



<br/>
<br/>



> <h2 id=''></h2>


<br/>
<br/>



> <h2 id=''></h2>


<br/>
<br/>



> <h2 id=''></h2>


<br/>
<br/>



> <h2 id=''></h2>


<br/>

***
<br/>


<br/>

***
<br/>
<br/>


> <h1 id=''></h1>



<br/>
<br/>



> <h2 id=''></h2>


- [**æ‰‹æœºæœ¬åœ°è°ƒè¯•**](#æ‰‹æœºæœ¬åœ°è°ƒè¯•)
- [**å‡½æ•°**](#å‡½æ•°)
	- [å‡½æ•°å‚æ•°è®¾ç½®é»˜è®¤å€¼](#å‡½æ•°å‚æ•°è®¾ç½®é»˜è®¤å€¼)
	- [useCallBackæ— æ³•æ ¹æ®ä¾èµ–å˜é‡æ”¹å˜è€Œè°ƒç”¨å†…éƒ¨å‡½æ•°](#useCallBackæ— æ³•æ ¹æ®ä¾èµ–å˜é‡æ”¹å˜è€Œè°ƒç”¨å†…éƒ¨å‡½æ•°)
	- [useEffecté—´æ¥è°ƒç”¨å‡½æ•°](#useEffecté—´æ¥è°ƒç”¨å‡½æ•°)
- [**ç®¡ç†Nodeç‰ˆæœ¬çš„NVM**](#ç®¡ç†Nodeç‰ˆæœ¬çš„NVM)
- [**æ–°å»ºä¸€ä¸ªReacté¡¹ç›®**](#æ–°å»ºä¸€ä¸ªReacté¡¹ç›®)
- [**JavaScripté™Œç”Ÿè¯­æ³•**](#JavaScripté™Œç”Ÿè¯­æ³•)
	- [å‡½æ•°ç»“æ„å‚æ•° methodï¼ˆvalue,({ typeSpecDic }) => {}ï¼‰](#å‡½æ•°ç»“æ„å‚æ•°)
	- [ç±»çš„å†…éƒ¨æ–¹æ³•ã€å•ä¾‹ç¼–ç ](#ç±»çš„å†…éƒ¨æ–¹æ³•ã€å•ä¾‹ç¼–ç )
		- [ä¸ºä»€ä¹ˆè¿™å°±æ˜¯å•ä¾‹](#ä¸ºä»€ä¹ˆè¿™å°±æ˜¯å•ä¾‹)
	- [ç»„ä»¶æ¨¡å—å¯¼å‡º](#ç»„ä»¶æ¨¡å—å¯¼å‡º)
	- [ç»„ä»¶çš„äº‹ä»¶å›è°ƒä¼ å‚å•ä¸ªOrå¤šä¸ª](#ç»„ä»¶çš„äº‹ä»¶å›è°ƒä¼ å‚å•ä¸ªOrå¤šä¸ª)
	- [æ•°ç»„ä¸ºnull,å¯é€‰æ“ä½œ](#æ•°ç»„ä¸ºnull,å¯é€‰æ“ä½œ)
	- [æ•°ç»„å¯¹è±¡å…ƒç´ è½¬æ¢æˆmap](#æ•°ç»„å¯¹è±¡å…ƒç´ è½¬æ¢æˆmap)
	- [è§£æ„èµ‹å€¼](#è§£æ„èµ‹å€¼)
	- [å±•å¼€è¿ç®—ç¬¦ï¼Œä¿ç•™éƒ¨åˆ†å€¼](#å±•å¼€è¿ç®—ç¬¦ï¼Œä¿ç•™éƒ¨åˆ†å€¼)
	- [æ•°ç»„reduceå¤„ç†å¤åˆjsonæ•°æ®](#æ•°ç»„reduceå¤„ç†å¤åˆjsonæ•°æ®)
 	- [å¤æ‚æ•°æ®æ›´æ–°](#å¤æ‚æ•°æ®æ›´æ–°)
	- [å¤æ‚æ•°æ®åˆå¹¶](#å¤æ‚æ•°æ®åˆå¹¶)
- [Flexå¸ƒå±€](#Flexå¸ƒå±€)
- [æ¸…ç†ç¼“å­˜å¯¼è‡´çš„é”™è¯¯](#æ¸…ç†ç¼“å­˜å¯¼è‡´çš„é”™è¯¯)
- [è·¨åŸŸé€ æˆæ— æ³•è¯·æ±‚è§£å†³](#è·¨åŸŸé€ æˆæ— æ³•è¯·æ±‚è§£å†³)
- [æ§åˆ¶èœå•å±•å¼€å’Œé€‰ä¸­é¡¹](#æ§åˆ¶èœå•å±•å¼€å’Œé€‰ä¸­é¡¹)
- [reactå…¥å£æ–‡ä»¶](#reactå…¥å£æ–‡ä»¶)
- [umiæ¡†æ¶ç”Ÿæˆreactå…¥å£æ–‡ä»¶](#umiæ¡†æ¶ç”Ÿæˆreactå…¥å£æ–‡ä»¶) 
	- [umijsç”Ÿæˆé¦–é¡µ](#umijsç”Ÿæˆé¦–é¡µ)
	- [å…¥å£æ–‡ä»¶ä¸­çš„app.tsxæ²¡æœ‰çœ‹åˆ°layoutè°ƒç”¨ï¼Ÿ](#å…¥å£æ–‡ä»¶ä¸­çš„app.tsxæ²¡æœ‰çœ‹åˆ°layoutè°ƒç”¨ï¼Ÿ)    
- [**é˜¿é‡ŒAntdæ¡†æ¶-UI**](#é˜¿é‡ŒAntdæ¡†æ¶-UI)
	- [ProLayoutå¸ƒå±€å±æ€§](#ProLayoutå¸ƒå±€å±æ€§)  
		- [å…¨å±€ä¸»é¢˜é…ç½®](#å…¨å±€ä¸»é¢˜é…ç½®) 
		- [Breadcrumbæ˜¾ç¤ºå½“å‰å¯¼èˆªè·¯å¾„](#Breadcrumbæ˜¾ç¤ºå½“å‰å¯¼èˆªè·¯å¾„)
	- [**Modalå¼¹çª—è¡¨æ ¼å±æ€§ä»‹ç»**](#Modalå¼¹çª—è¡¨æ ¼å±æ€§ä»‹ç»)
	- [Formè¡¨æ ¼ä½¿ç”¨](#Formè¡¨æ ¼ä½¿ç”¨)
		- [è¡¨å•æäº¤æ•°æ®](#è¡¨å•æäº¤æ•°æ®)
	- [ProTableåˆ—è¡¨æ‹–æ‹½æ’åº](#ProTableåˆ—è¡¨æ‹–æ‹½æ’åº)
		- [ä¿®æ”¹æŸä¸€æ–¹æŒ‰é’®çš„ç‚¹å‡»çŠ¶æ€](#ä¿®æ”¹æŸä¸€æ–¹æŒ‰é’®çš„ç‚¹å‡»çŠ¶æ€)
	- [åˆ—è¡¨Table](#åˆ—è¡¨Table)
		- [åˆ†é¡µå›è°ƒå‡½æ•°](#åˆ†é¡µå›è°ƒå‡½æ•°)
	- [Radio.Groupå•é€‰æŒ‰é’®](#Radio.Groupå•é€‰æŒ‰é’®)
	- [Selectç»„ä»¶åˆæ­¥ä½¿ç”¨](#Selectç»„ä»¶åˆæ­¥ä½¿ç”¨)
- [**ç½‘ç»œ**](#ç½‘ç»œ)
	- [æ¥å£é‡Œæºå…¥å‚æ•°](#æ¥å£é‡Œæºå…¥å‚æ•°)
- [**è·¯ç”±**](#è·¯ç”±)
	- [è·¯å¾„å‚æ•°è·³è½¬](#è·¯å¾„å‚æ•°è·³è½¬)
- [**CSSæ ·å¼**](#CSSæ ·å¼)
	- [æ¨¡å—åŒ–æ ·å¼](#æ¨¡å—åŒ–æ ·å¼)
	- [antdä¸­Radio.Groupç»„ä»¶æ— æ³•ä¿®æ”¹æ ·å¼](#antdä¸­Radio.Groupç»„ä»¶æ— æ³•ä¿®æ”¹æ ·å¼)
	- [å­—ç¬¦ä¸²è¶…å‡ºæµ®çª—æ˜¾ç¤º](#å­—ç¬¦ä¸²è¶…å‡ºæµ®çª—æ˜¾ç¤º)
	- [tsæ¨¡å—å£°æ˜æ ·å¼æ–‡ä»¶](#tsæ¨¡å—å£°æ˜æ ·å¼æ–‡ä»¶)
	- [overflowä¸é˜´å½±æ­é…](#overflowä¸é˜´å½±æ­é…)
- [æ¡ˆä¾‹](#æ¡ˆä¾‹)
	- [ä¿ç•™æ—§å¯¹è±¡å¼•ç”¨+åˆå¹¶æ–°é€‰æ‹©ç»“æœ](#ä¿ç•™æ—§å¯¹è±¡å¼•ç”¨+åˆå¹¶æ–°é€‰æ‹©ç»“æœ)
	- [åŸºäºä¸»é”®skuIdçš„æ•°ç»„å¯¹é½+æ•°æ®æºæ›¿æ¢](#åŸºäºä¸»é”®skuIdçš„æ•°ç»„å¯¹é½+æ•°æ®æºæ›¿æ¢)
	- [å¹¶å‘è¯·æ±‚å¤„ç†](#å¹¶å‘è¯·æ±‚å¤„ç†)
    - [Promise.allæ‰¹å¤„ç†ç½‘ç»œè¯·æ±‚](#Promise.allæ‰¹å¤„ç†ç½‘ç»œè¯·æ±‚)




<br/><br/><br/>

***
<br/>

># <h1 id="æ‰‹æœºæœ¬åœ°è°ƒè¯•">[æ‰‹æœºæœ¬åœ°è°ƒè¯•](./åŸºç¡€(II).md#æ‰‹æœºæœ¬åœ°è°ƒè¯•)</h1>



<br/><br/><br/>

***
<br/>

> <h1 id="å‡½æ•°">å‡½æ•°</h1>


***
<br/><br/><br/>

># <h2 id="å‡½æ•°å‚æ•°è®¾ç½®é»˜è®¤å€¼">[å‡½æ•°å‚æ•°è®¾ç½®é»˜è®¤å€¼](./../JavaScript/åŸºç¡€(I).md#å‡½æ•°è®¾ç½®é»˜è®¤å€¼)</h2>

```jsx
handleFilter = (filterKey, value, { isTime = false }) => {}

this.handleFilter('actionTypeFilter', e) è¿™æ ·è°ƒç”¨ï¼Œä¸ºä»€ä¹ˆä¼šæŠ¥é”™
```


***
<br/><br/><br/>
> <h2 id="useCallBackæ— æ³•æ ¹æ®ä¾èµ–å˜é‡æ”¹å˜è€Œè°ƒç”¨å†…éƒ¨å‡½æ•°">useCallBackæ— æ³•æ ¹æ®ä¾èµ–å˜é‡æ”¹å˜è€Œè°ƒç”¨å†…éƒ¨å‡½æ•°</h2>

```js
[cloudProfitTime, setCloudProfitTime] = useState(90)

const handleSubmit = useCallback(
    (params = {}) => {
	 
	 const submitData = {
				spuFreezeDays: cloudProfitTime,
      };
      
  },[
  cloudProfitTime,
  saveData,
],)

// æŒ‰é’®ç‚¹å‡»äº‹ä»¶
const editClick = ({ isStartEdit, action = SubmitAction.CANCEL }) => {
		
	setCloudProfitTime(9)
	setIsEdit(isStartEdit);
	if (action == SubmitAction.SAVE) {
	  setSaveData(SubmitAction.SAVE);
	}
};
```
ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ‰§è¡Œ`editClick`æ–¹æ³•åï¼Œä½†æ˜¯handleSubmit å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œæ€ä¹ˆå›äº‹ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ **React çŠ¶æ€æ›´æ–°å¼‚æ­¥ + useCallback ä¾èµ–å…³ç³»è¯¯åŒº**ï¼Œ[è§£å†³æ–¹æ¡ˆè¯·çœ‹è¿™é‡Œ](./åŸºç¡€(I).md#æ ¹æ®ä¾èµ–å‚æ•°useCallBackæ— æ³•è°ƒç”¨å†…éƒ¨å‡½æ•°)

***
<br/><br/><br/>
> <h2 id="useEffecté—´æ¥è°ƒç”¨å‡½æ•°">useEffecté—´æ¥è°ƒç”¨å‡½æ•°</h2>

```
 useEffect(() => {
    if (!visible || !merchantId || loadingSpuDetail) return;

		setLoadingSpuDetail(true);
		spuStrategyDetail({ merchantId }).then((res) => {
  
})}, [visible, merchantId]);  

const initTableData = useCallback(() =>{}, [visible, spuDetailData, initialData, merchantLevel, skuList, strategy]);
```
æˆ‘æƒ³å°†**`fetchSpuStrategyDetail`**å‡½æ•°æ‹¿å‡ºæ¥ä»**`useEffect`**ä¸­ï¼Œç„¶åæˆ‘å¯ä»¥åœ¨å¦ä¸€ä¸ªæ–¹æ³•**`initTableData`** ä¸­ç›´æ¥è°ƒç”¨ **`fetchSpuStrategyDetail`** å‡½æ•°å—ï¼Ÿ


<br/> 

**âœ… æ¨èå†™æ³•**

```jsx
// 1ï¸âƒ£ å®šä¹‰ fetchSpuStrategyDetail
const fetchSpuStrategyDetail = useCallback(async () => {
  if (!merchantId) return;
  setLoadingSpuDetail(true);
  try {
    const res = await spuStrategyDetail({ merchantId });
    // ğŸš€ è¿™é‡Œå¤„ç†è¿”å›æ•°æ®é€»è¾‘
    // setSpuDetailData(res.data);
  } catch (error) {
    console.error('fetchSpuStrategyDetail failed:', error);
  } finally {
    setLoadingSpuDetail(false);
  }
}, [merchantId]); // âœ… åªä¾èµ– merchantId å³å¯


// 2ï¸âƒ£ useEffect ä¸­ä½¿ç”¨å®ƒ
useEffect(() => {
  if (!visible || !merchantId || loadingSpuDetail) return;
  fetchSpuStrategyDetail();
}, [visible, merchantId, fetchSpuStrategyDetail, loadingSpuDetail]);


// 3ï¸âƒ£ åœ¨ initTableData ä¸­ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨
const initTableData = useCallback(() => {
  console.log('ğŸš€ åˆå§‹åŒ–è¡¨æ ¼é€»è¾‘...');
  fetchSpuStrategyDetail(); // âœ… å¯ä»¥ç›´æ¥è°ƒç”¨
}, [fetchSpuStrategyDetail]);
```

---
<br/>

**ğŸ’¡ ä¸ºä»€ä¹ˆè¿™æ ·å†™å¯è¡Œï¼Ÿ**

- 1.**`fetchSpuStrategyDetail` æ˜¯ç¨³å®šå‡½æ•°**
   å› ä¸ºå®ƒæ˜¯ç”¨ `useCallback` å®šä¹‰çš„ï¼ŒReact ä¼šä¿è¯å®ƒåœ¨ä¾èµ–ï¼ˆ`merchantId`ï¼‰ä¸å˜æ—¶å¼•ç”¨ä¹Ÿä¸å˜ã€‚
   æ‰€ä»¥ `useEffect`ã€`initTableData` éƒ½å¯ä»¥å®‰å…¨å¤ç”¨ã€‚

- 2.**ä¸ä¼šé‡å¤åˆ›å»ºé—­åŒ…æˆ–å¼•å‘æ— é™å¾ªç¯**
	* `useEffect` çš„ä¾èµ–ä¸­åŒ…æ‹¬ `fetchSpuStrategyDetail`ï¼Œä½†åªåœ¨ `merchantId` å˜æ—¶æ‰å˜åŒ–ï¼›
	* ä¸ä¼šå¯¼è‡´æ­»å¾ªç¯ã€‚

3.**å¯åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨**
   æ¯”å¦‚ï¼š

```js
const handleRefreshClick = () => {
fetchSpuStrategyDetail();
};
```

âœ… ç›´æ¥å¤ç”¨ï¼Œé€»è¾‘æ¸…æ™°ã€‚

<br/>


**âš ï¸ æ³¨æ„ç‚¹**

* `fetchSpuStrategyDetail` å†…éƒ¨å¦‚æœä½¿ç”¨äº†æ›´å¤š state æˆ– propsï¼ˆä¾‹å¦‚ `setSpuDetailData`, `merchantLevel` ç­‰ï¼‰ï¼Œä¹Ÿè¦è®°å¾—æ”¾è¿›ä¾èµ–æ•°ç»„ï¼›
* å¦‚æœ `spuStrategyDetail` æ˜¯ä¸€ä¸ªæ¥è‡ªå¤–éƒ¨æ¨¡å—çš„ç¨³å®šå‡½æ•°ï¼ˆæ¯”å¦‚ API è°ƒç”¨ï¼‰ï¼Œä¸ç”¨åŠ è¿›ä¾èµ–ï¼›
* `setLoadingSpuDetail` æ˜¯ React è‡ªå¸¦çš„ setterï¼Œä¸éœ€è¦æ”¾ä¾èµ–ã€‚

<br/>

**ğŸ§  ç®€å•æ€»ç»“**

| ç›®æ ‡                                | å®ç°æ–¹å¼                   |
| --------------------------------- | ---------------------- |
| æƒ³åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨ `fetchSpuStrategyDetail` | âœ… ç”¨ `useCallback` å®šä¹‰å‡½æ•° |
| æƒ³åœ¨ `useEffect` å’Œå…¶ä»–å‡½æ•°é‡Œå…±ç”¨           | âœ… ç›´æ¥è°ƒç”¨åŒä¸€ä¸ªå›è°ƒ            |
| é¿å…é—­åŒ…/ä¾èµ–æ··ä¹±                         | âœ… åœ¨ä¾èµ–æ•°ç»„ä¸­å‡†ç¡®å£°æ˜ä½¿ç”¨åˆ°çš„å˜é‡     |



<br/><br/><br/>

***
<br/>

> <h1 id= "ç®¡ç†Nodeç‰ˆæœ¬çš„NVM">ç®¡ç†Nodeç‰ˆæœ¬çš„NVM</h1>

NVMï¼ˆNode Version Managerï¼‰æ˜¯ä¸€ä¸ªç”¨æ¥**ç®¡ç†å¤šä¸ª Node.js ç‰ˆæœ¬çš„å·¥å…·**ã€‚å®ƒåœ¨å‰ç«¯å¼€å‘ã€ç‰¹åˆ«æ˜¯ç”¨ React ç¼–ç æ—¶éå¸¸æœ‰ç”¨ï¼ŒåŸå› å¦‚ä¸‹ï¼š

---

## ğŸ”§ NVM æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ

NVM å¯ä»¥è®©ä½ ï¼š

1. **å®‰è£…å¤šä¸ª Node.js ç‰ˆæœ¬**ï¼ˆæ¯”å¦‚ 14ã€16ã€18ã€20â€¦â€¦ï¼‰ï¼›
2. **æŒ‰é¡¹ç›®æˆ–å…¨å±€åˆ‡æ¢ Node.js ç‰ˆæœ¬**ï¼›
3. é¿å…ç³»ç»Ÿå®‰è£…å†²çªï¼Œä¸éœ€è¦ä½¿ç”¨ `sudo` æ¥è£…åŒ…ï¼›
4. å¸è½½å’Œæ›´æ–° Node.js ç‰ˆæœ¬ä¹Ÿå˜å¾—ç®€å•ï¼›

---

## ğŸš€ ä¸ºä»€ä¹ˆç”¨ React æ—¶å»ºè®®ç”¨ NVMï¼Ÿ

### 1. **React é¡¹ç›®ä¾èµ–ç‰¹å®šçš„ Node ç‰ˆæœ¬**

ä¸€äº› React é¡¹ç›®ï¼ˆç‰¹åˆ«æ˜¯è€é¡¹ç›®æˆ–ç”¨æŸäº›å·¥å…·é“¾ï¼Œå¦‚ Viteã€Next.jsã€Create React App ç­‰ï¼‰å¯èƒ½**åªæ”¯æŒæŸä¸ªèŒƒå›´å†…çš„ Node ç‰ˆæœ¬**ã€‚
å¦‚æœä½ ç›´æ¥ç”¨ç³»ç»Ÿçš„ Node ç‰ˆæœ¬ï¼Œå¾ˆå¯èƒ½ä¼šå‡ºç°ï¼š

* npm/yarn å®‰è£…æŠ¥é”™ï¼›
* æ„å»ºå¤±è´¥ï¼›
* æ’ä»¶æˆ–ä¾èµ–å…¼å®¹æ€§é—®é¢˜ã€‚

ğŸ‘‰ æœ‰äº† NVMï¼Œä½ å°±å¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ°å…¼å®¹çš„ç‰ˆæœ¬æ¥è¿è¡Œé¡¹ç›®ã€‚

---

### 2. **ä¸åŒé¡¹ç›®ç”¨ä¸åŒç‰ˆæœ¬çš„ Node**

ä½ å¯èƒ½æœ‰å¤šä¸ª React é¡¹ç›®ï¼Œå®ƒä»¬ä¾èµ–ä¸åŒç‰ˆæœ¬çš„ Nodeï¼Œæ¯”å¦‚ï¼š

* é¡¹ç›® A è¦æ±‚ Node 16
* é¡¹ç›® B ç”¨çš„æ˜¯ Node 20

ç”¨ NVMï¼Œè¿›å…¥æŸä¸ªé¡¹ç›®ç›®å½•æ—¶å¯ä»¥æ‰§è¡Œï¼š

```bash
nvm use 16
```

ç”šè‡³ä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­æ”¾ä¸€ä¸ª `.nvmrc` æ–‡ä»¶ï¼Œé‡Œé¢å†™ä¸Šéœ€è¦çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚ï¼š

```bash
16
```

ç„¶åè¿è¡Œï¼š

```bash
nvm use
```

å°±ä¼šè‡ªåŠ¨åˆ‡æ¢ã€‚

---

### 3. **å¼€å‘ç¯å¢ƒæ›´å¹²å‡€**

ä½¿ç”¨ NVM å®‰è£… Nodeï¼Œä¸ä¼šå½±å“ç³»ç»Ÿé»˜è®¤ç¯å¢ƒï¼Œä¹Ÿä¸éœ€è¦ `sudo` æƒé™ï¼Œæ›´å®‰å…¨ã€‚

---

## ğŸ§ª æ€»ç»“ä¸€å¥è¯ï¼š

> **NVM æ˜¯å‰ç«¯å¼€å‘å¿…å¤‡å·¥å…·ä¹‹ä¸€ï¼Œèƒ½å¸®ä½ çµæ´»åœ°åˆ‡æ¢ Node.js ç‰ˆæœ¬ï¼Œç¡®ä¿ React é¡¹ç›®åœ¨æ­£ç¡®çš„ç¯å¢ƒä¸‹è¿è¡Œã€‚**

***
<br/><br/><br/>
> <h2 id="å®‰è£…NVM">å®‰è£…NVM</h2>

åœ¨ Mac ä¸Šä½¿ç”¨ Homebrew å®‰è£… NVM éå¸¸ç®€å•ã€‚ä¸‹é¢æ˜¯è¯¦ç»†çš„æ­¥éª¤ï¼š

---

## ğŸº ä½¿ç”¨ Homebrew å®‰è£… NVMï¼ˆNode Version Managerï¼‰

### âœ… ç¬¬ 1 æ­¥ï¼šç¡®è®¤å·²å®‰è£… Homebrew

æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼š

```bash
brew --version
```

å¦‚æœè¾“å‡ºç‰ˆæœ¬å·ï¼Œè¯´æ˜ä½ å·²ç»å®‰è£…äº†ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯·å…ˆå» [https://brew.sh](https://brew.sh) å®‰è£… Homebrewã€‚

---

### âœ… ç¬¬ 2 æ­¥ï¼šç”¨ Brew å®‰è£… NVM

```bash
brew install nvm
```

---

### âœ… ç¬¬ 3 æ­¥ï¼šåˆ›å»º NVM çš„ç›®å½•

NVM éœ€è¦ä¸€ä¸ªç›®å½•æ¥å­˜å‚¨ä½ å®‰è£…çš„ Node.js ç‰ˆæœ¬ã€‚å¯ä»¥ç”¨è¿™ä¸ªå‘½ä»¤ï¼š

```bash
mkdir ~/.nvm
```

---

### âœ… ç¬¬ 4 æ­¥ï¼šé…ç½® shellï¼ˆzsh æˆ– bashï¼‰

ä½ éœ€è¦åœ¨ä½ çš„ shell é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼ˆå–å†³äºä½ ç”¨çš„æ˜¯ zsh è¿˜æ˜¯ bashï¼‰ï¼š

#### å¯¹äº Zsh ç”¨æˆ·ï¼ˆé»˜è®¤ macOS ç”¨ zshï¼‰ï¼š

```bash
echo 'export NVM_DIR="$HOME/.nvm"' >> ~/.zshrc
echo '[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"' >> ~/.zshrc
echo '[ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"' >> ~/.zshrc
```

ç„¶åè¿è¡Œï¼š

```bash
source ~/.zshrc
```


<br/>

**æˆ–è€…åœ¨`.bash_profile`ä¸­è¿™æ ·å®‰è£…ï¼š**

~/.bash_profile çš„å®Œæ•´å†…å®¹ï¼ˆé€‚ç”¨äº macOS M ç³»åˆ—ï¼Œå¦‚ M1/M2/M3ï¼‰ï¼š

```sh
# NVM é…ç½®å¼€å§‹
export NVM_DIR="$HOME/.nvm"
[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"  # åŠ è½½ nvm ä¸»ç¨‹åº
[ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  # å¯é€‰ï¼šå¯ç”¨è‡ªåŠ¨è¡¥å…¨
# NVM é…ç½®ç»“æŸ
```



<br/><br/>

#### å¦‚æœä½ ç”¨çš„æ˜¯ Bashï¼š

æŠŠä¸Šé¢é‚£å‡ è¡ŒåŠ åˆ° `~/.bash_profile` æˆ– `~/.bashrc`ï¼Œç„¶åæ‰§è¡Œ `source ~/.bash_profile`

---

### âœ… ç¬¬ 5 æ­¥ï¼šéªŒè¯ NVM æ˜¯å¦å®‰è£…æˆåŠŸ

```bash
nvm --version
```

å¦‚æœä½ çœ‹åˆ°ç‰ˆæœ¬å·ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼

---

### âœ… ç¬¬ 6 æ­¥ï¼šä½¿ç”¨ NVM å®‰è£… Node.js

```bash
nvm install 18
```

ç„¶ååˆ‡æ¢ä½¿ç”¨å®ƒï¼š

```bash
nvm use 18
```

è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬ï¼š

```bash
nvm alias default 18
```


<br/><br/><br/>

***
<br/>

> <h1 id= "æ–°å»ºä¸€ä¸ªReacté¡¹ç›®">æ–°å»ºä¸€ä¸ªReacté¡¹ç›®</h1>

å®‰è£…å¥½ Node.js å’Œ NVM åï¼Œä½ å°±å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ª React é¡¹ç›®äº†ã€‚ä¸‹é¢æ˜¯ **ä»é›¶å¼€å§‹ç”¨ `npm` åˆ›å»ºå¹¶å¯åŠ¨ React åº”ç”¨çš„å®Œæ•´è¯¦ç»†æ­¥éª¤**ï¼š

---

## âœ… å‰æï¼šä½ å·²ç»å®Œæˆäº†è¿™äº›

* âœ… å·²ç»é€šè¿‡ `nvm install` å®‰è£…äº† Node.jsï¼ˆå»ºè®® Node ç‰ˆæœ¬ â‰¥ 18ï¼‰
* âœ… `npm` å·²éš Node ä¸€èµ·å®‰è£…ï¼ˆå¯é€šè¿‡ `npm -v` æ£€æŸ¥ï¼‰

---

## ğŸš€ åˆ›å»ºå¹¶å¯åŠ¨ React é¡¹ç›®çš„å®Œæ•´æ­¥éª¤

### ğŸ“¦ ç¬¬ 1 æ­¥ï¼šåˆ›å»º React é¡¹ç›®

ä½¿ç”¨å®˜æ–¹æ¨èçš„è„šæ‰‹æ¶å·¥å…· `create-react-app`ï¼ˆä¸€æ¬¡æ€§ç”Ÿæˆå®Œæ•´é¡¹ç›®ç»“æ„ï¼‰ï¼š

```bash
npx create-react-app my-app
```

è§£é‡Šï¼š

* `npx` æ˜¯ `npm` é™„å¸¦çš„ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½å¹¶è¿è¡Œæœ€æ–°çš„ `create-react-app`ï¼›
* `my-app` æ˜¯ä½ çš„é¡¹ç›®æ–‡ä»¶å¤¹åï¼ˆä½ å¯ä»¥æ”¹æˆä»»ä½•åå­—ï¼‰ï¼›
* å®ƒä¼šè‡ªåŠ¨ä¸‹è½½ä¾èµ–ã€åˆ›å»ºæ–‡ä»¶å¤¹ã€é…ç½®é¡¹ç›®ç­‰ã€‚

ğŸ‘‰ å¦‚æœä½ çœ‹åˆ°è¿‡ç¨‹ä¸­æœ‰æç¤º `[âœ”] Success! Created my-app...`ï¼Œè¯´æ˜åˆ›å»ºæˆåŠŸã€‚

---

### ğŸ“ ç¬¬ 2 æ­¥ï¼šè¿›å…¥é¡¹ç›®ç›®å½•

```bash
cd my-app
```

---

### ğŸš€ ç¬¬ 3 æ­¥ï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# å®‰è£…ä¸€äº›ä¾èµ–
npm install

#å¯åŠ¨æœåŠ¡å™¨
npm start
```

è¿™æ¡å‘½ä»¤ä¼šï¼š

* å¯åŠ¨ React çš„å¼€å‘æœåŠ¡å™¨ï¼ˆåŸºäº Webpackï¼‰ï¼›
* æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://localhost:3000/`ï¼›
* å®æ—¶çƒ­æ›´æ–°ä½ å†™çš„ä»£ç ã€‚

---

### ğŸ” é¡¹ç›®ç›®å½•ç»“æ„å¤§æ¦‚é•¿è¿™æ ·ï¼š

```bash
my-app/
â”œâ”€â”€ node_modules/        # æ‰€æœ‰ä¾èµ–åŒ…
â”œâ”€â”€ public/              # é™æ€èµ„æºç›®å½•
â”œâ”€â”€ src/                 # ä½ çš„æºç ç›®å½•ï¼ˆå†™ React çš„åœ°æ–¹ï¼‰
â”‚   â”œâ”€â”€ App.js           # é»˜è®¤é¦–é¡µç»„ä»¶
â”‚   â”œâ”€â”€ index.js         # åº”ç”¨å…¥å£
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json         # é¡¹ç›®ä¿¡æ¯å’Œä¾èµ–åˆ—è¡¨
â”œâ”€â”€ README.md
```

---

## ğŸ”¨ å¼€å‘å»ºè®®

* ä½ å¯ä»¥ç¼–è¾‘ `src/App.js` æ¥ä¿®æ”¹é¡µé¢å†…å®¹ï¼›
* ä¿å­˜åæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°ï¼›
* ä½ å¯ä»¥ç”¨ä»»æ„ç¼–è¾‘å™¨ï¼ˆå¦‚ VS Codeï¼‰æ‰“å¼€è¿™ä¸ªç›®å½•å¼€å§‹å¼€å‘ï¼š

```bash
code .
```

---

## âœ… å¸¸ç”¨å‘½ä»¤æ±‡æ€»

| å‘½ä»¤              | ä½œç”¨               |
| --------------- | ---------------- |
| `npm start`     | å¯åŠ¨å¼€å‘æœåŠ¡å™¨          |
| `npm run build` | æ‰“åŒ…é¡¹ç›®ç”¨äºç”Ÿäº§ç¯å¢ƒ       |
| `npm test`      | è¿è¡Œæµ‹è¯•             |
| `npm install`   | å®‰è£…ä¾èµ–ï¼ˆæ¯”å¦‚å›¢é˜Ÿé¡¹ç›®æ‹‰ä¸‹æ¥åï¼‰ |

---

æ˜¯å¦éœ€è¦æˆ‘ä¹Ÿæ¼”ç¤ºä¸€ä¸‹ç”¨ Vite åˆ›å»ºæ›´è½»é‡æ›´å¿«çš„ React é¡¹ç›®ï¼Ÿï¼ˆæ›´ç°ä»£ã€æ›´æ¨èï¼‰

<br/><br/><br/>

***
<br/>

> <h1 id="JavaScripté™Œç”Ÿè¯­æ³•">JavaScripté™Œç”Ÿè¯­æ³•</h1>

***
<br/><br/><br/>
> <h2 id="å‡½æ•°ç»“æ„å‚æ•°">å‡½æ•°ç»“æ„å‚æ•° methodï¼ˆvalue,({ typeSpecDic }) => {}ï¼‰</h2>

[è¯¦è§£è¯·çœ‹è¿™é‡Œ](./../JavaScript/åŸºç¡€(I).md#å‡½æ•°ç»“æ„å‚æ•°)



***
<br/><br/><br/>
> <h2 id="ç±»çš„å†…éƒ¨æ–¹æ³•ã€å•ä¾‹ç¼–ç ">ç±»çš„å†…éƒ¨æ–¹æ³•ã€å•ä¾‹ç¼–ç </h2>

[**è¯·çœ‹è¿™é‡Œ**](./React/åŸºç¡€(II).md#ç±»çš„æ–¹æ³•)

***
<br/><br/><br/>
> <h3 id="ä¸ºä»€ä¹ˆè¿™å°±æ˜¯å•ä¾‹">ä¸ºä»€ä¹ˆè¿™å°±æ˜¯å•ä¾‹</h3>

[**å•ä¾‹è¯·çœ‹è¿™é‡Œ**](./React/åŸºç¡€(II).md#å•ä¾‹ç±»)

***
<br/><br/><br/>
> <h2 id="ç»„ä»¶æ¨¡å—å¯¼å‡º">ç»„ä»¶æ¨¡å—å¯¼å‡º</h2>


å°†ä¸€ä¸ªç»„ä»¶å¯¼å‡ºï¼Œ[**è¯·çœ‹è¿™é‡Œ**](./React/åŸºç¡€(II).md#ç»„ä»¶æ¨¡å—åŒ–å¯¼å‡º)


***
<br/><br/><br/>
> <h2 id="ç»„ä»¶çš„äº‹ä»¶å›è°ƒä¼ å‚å•ä¸ªOrå¤šä¸ª">ç»„ä»¶çš„äº‹ä»¶å›è°ƒä¼ å‚å•ä¸ªOrå¤šä¸ª</h2>

[**è¯·çœ‹è¿™é‡Œ**](./åŸºç¡€(II).md#ç»„ä»¶è§¦å‘å‡½æ•°ä¼ é€’å•ä¸ªorå¤šä¸ªå‚æ•°)


***
<br/><br/><br/>
> <h2 id="æ•°ç»„ä¸ºnull,å¯é€‰æ“ä½œ">æ•°ç»„ä¸ºnull,å¯é€‰æ“ä½œ</h2>

Reactä¸­æœ‰ï¼š

```jsx
state = { timeFilter: null, //æ—¶é—´è¿‡æ»¤}
```

è‹¥æ˜¯`timeFilter`æ˜¯æ•°ç»„ï¼Œç„¶åå–`timeFilter[0]`ä¼šæŠ¥é”™ï¼Œå¦‚ä½•ä½¿ç”¨å¯é€‰å–å‡ºæ•°ç»„ä¸­çš„å…ƒç´ ã€‚[**è¯·çœ‹è¿™é‡Œ**](./../JavaScript/åŸºç¡€(I).md#æ•°ç»„ä¸ºnullï¼Œå®‰å…¨å–å…ƒç´ )

***
<br/><br/><br/>
> <h2 id="æ•°ç»„å¯¹è±¡å…ƒç´ è½¬æ¢æˆmap">æ•°ç»„å¯¹è±¡å…ƒç´ è½¬æ¢æˆmap</h2>

æœ‰è¿™æ ·çš„åœºæ™¯ï¼š

```jsx
const data = [
    {
        "operateModule": "ç”Ÿäº§ç®¡ç†",
        "operateDescList": [
            "åˆ†é…è®¾å¤‡",
            "XXXX"
        ]
    }
]
```


æˆ‘æƒ³å°†è¿™ä¸ª`data`æ•°ç»„å¤„ç†æˆ ä¸€ä¸ªç±»ä¼¼`map`ï¼Œ`key`æ˜¯æ¯ä¸ªå…ƒç´ é‡Œçš„ `operateModule`ï¼Œå…¶å¯¹åº”çš„å€¼ä¸º`operateDescList`ï¼Œæ€ä¹ˆåšï¼Ÿ[è¯·çœ‹è¿™é‡Œ](./../JavaScript/åŸºç¡€(I).md#æ•°ç»„å¯¹è±¡è½¬æ¢æˆmapç±»å‹)


***
<br/><br/><br/>
> <h2 id="è§£æ„èµ‹å€¼">è§£æ„èµ‹å€¼</h2>

**Reactä¸­æœ‰ï¼š**

```js
const { RangePicker } = DatePicker; 
```

è¡¨ç¤ºå•¥æ„æ€ï¼Ÿç»™ç»„ä»¶èµ·åˆ«åå—ï¼Ÿ

è¿™ç§è¯­æ³•æ˜¯ **ES6 çš„è§£æ„èµ‹å€¼è¯­æ³•**

<br/>

* `DatePicker` æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå…¶å®æ˜¯ antd å¯¼å‡ºçš„ `DatePicker` ç»„ä»¶å¯¹è±¡ï¼‰ï¼Œé‡Œé¢ä¸ä»…æœ‰é»˜è®¤çš„ `DatePicker` ç»„ä»¶æœ¬èº«ï¼Œè¿˜æŒ‚è½½äº†ä¸€äº›å­ç»„ä»¶ï¼Œä¾‹å¦‚ï¼š

```js
DatePicker.RangePicker
DatePicker.MonthPicker
DatePicker.WeekPicker
```

* æ‰€ä»¥ `const { RangePicker } = DatePicker;` ç›¸å½“äºï¼š

```js
const RangePicker = DatePicker.RangePicker;
```

è¿™æ ·å†™åªæ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œä¸æ˜¯ç»™ç»„ä»¶èµ·åˆ«åï¼Œè€Œæ˜¯**æŠŠå¯¹è±¡é‡Œçš„å­å±æ€§è§£æ„å‡ºæ¥èµ‹å€¼ç»™å˜é‡**ã€‚

> ç”¨æ³•ç¤ºä¾‹ï¼š

```jsx
import { DatePicker } from 'antd';

const { RangePicker } = DatePicker;

function Demo() {
  return (
    <div>
      <DatePicker />   {/* å•ä¸ªæ—¥æœŸé€‰æ‹© */}
      <RangePicker />  {/* æ—¶é—´èŒƒå›´é€‰æ‹© */}
    </div>
  );
}
```


<br/><br/><br/>

***
<br/>

> <h1 id="å±•å¼€è¿ç®—ç¬¦ï¼Œä¿ç•™éƒ¨åˆ†å€¼">å±•å¼€è¿ç®—ç¬¦ï¼Œä¿ç•™éƒ¨åˆ†å€¼</h1>

```js
 const [cloudProfitTime, setCloudProfitTime] = useState({ old: 90, new: 90 });
```

ä¸ºä»€ä¹ˆ

```js
setCloudProfitTime(...cloudProfitTime, { new: value });
```

ä¼šæŠ¥é”™ï¼Œå’‹å›äº‹ï¼Ÿ

<br/>

**æˆ‘å†™çš„æ˜¯ï¼š**

```js
setCloudProfitTime(...cloudProfitTime, { new: value });
```

è¿™å…¶å®æ˜¯è¯­æ³•é”™è¯¯çš„å†™æ³•ï¼Œå› ä¸ºï¼š

1. **`setCloudProfitTime` åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼ˆæ–°çš„ state å€¼ï¼‰**ï¼›
2. ä½ å´åœ¨è¿™é‡Œä½¿ç”¨äº†ã€Œå±•å¼€è¿ç®—ç¬¦ã€`...cloudProfitTime`ï¼Œä½†å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯æ•°ç»„ï¼›
3. ä½ è¿˜ä¼ äº†ä¸¤ä¸ªå‚æ•°ï¼ˆå±•å¼€çš„ + æ–°å¯¹è±¡ï¼‰ï¼Œæ‰€ä»¥ React æŠ¥é”™ã€‚

<br/>

**æ­£ç¡®å†™æ³•ï¼šä½ æƒ³â€œä¿ç•™æ—§å€¼ï¼Œæ›´æ–°éƒ¨åˆ†å­—æ®µâ€**

åœ¨ React ä¸­ï¼Œæ›´æ–°å¯¹è±¡çŠ¶æ€æ—¶è¦**åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å‰¯æœ¬**ï¼š

```js
setCloudProfitTime({
  ...cloudProfitTime,  // ä¿ç•™åŸæ¥çš„æ‰€æœ‰å±æ€§
  new: value,          // è¦†ç›– new å­—æ®µ
});
```

âœ… è¿™æ ·æ‰æ˜¯åˆæ³•å†™æ³•ã€‚

<br/>

**å®Œæ•´ä¾‹å­ï¼š**

```jsx
const [cloudProfitTime, setCloudProfitTime] = useState({ old: 90, new: 90 });

const onChangeValue = (value) => {
  setCloudProfitTime({
    ...cloudProfitTime,
    new: value,
  });
};
```

<br/>

**æ¨èå†™æ³•ï¼ˆé˜²æ­¢é—­åŒ…æ—§å€¼ï¼‰**

åœ¨ React çš„ state æ›´æ–°ä¸­ï¼Œæœ€å¥½ç”¨å‡½æ•°å¼æ›´æ–°ï¼š

```js
setCloudProfitTime(prev => ({
  ...prev,
  new: value,
}));
```

âœ… ä¼˜ç‚¹ï¼š

* ä¸ä¾èµ–å¤–å±‚çš„é—­åŒ…ï¼›
* åœ¨å¼‚æ­¥æˆ–é¢‘ç¹æ›´æ–°æ—¶ä¿è¯æ‹¿åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚


***
<br/><br/><br/>
> <h2 id="æ•°ç»„reduceå¤„ç†å¤åˆjsonæ•°æ®">æ•°ç»„reduceå¤„ç†å¤åˆjsonæ•°æ®</h2>

æœ‰ä¸€æ®µè¿™æ ·çš„JSONæ•°æ®å¦‚ä¸‹ï¼š

```json
[
  {
    "categoryCode": "led",
    "categoryTitle": "LEDç¯",
    "items": [
      {
        "categoryCode": "led",
        "description": "ç™½å…‰ç¯ï¼Œ1:ä½ç”µå¹³æœ‰æ•ˆ 0:é«˜ç”µå¹³æœ‰æ•ˆ",
        "code": "white_light_active_low",
        "enabled": true,
        "valueType": "enum",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 0,
        "values": [
          {
            "name": "é«˜ç”µå¹³æœ‰æ•ˆ",
            "value": 0
          },
          {
            "name": "ä½ç”µå¹³æœ‰æ•ˆ",
            "value": 1
          }
        ],
        "sort": 10
      },
      {
        "categoryCode": "led",
        "description": "çº¢å¤–ç¯ï¼Œ1:ä½ç”µå¹³æœ‰æ•ˆ 0:é«˜ç”µå¹³æœ‰æ•ˆ",
        "code": "infrared_light_active_low",
        "enabled": true,
        "valueType": "enum",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 0,
        "values": [
          {
            "name": "é«˜ç”µå¹³æœ‰æ•ˆ",
            "value": 0
          },
          {
            "name": "ä½ç”µå¹³æœ‰æ•ˆ",
            "value": 1
          }
        ],
        "sort": 20
      }
    ]
  },
  {
    "categoryCode": "motor",
    "categoryTitle": "ç”µæœºé…ç½®",
    "items": [
      {
        "categoryCode": "motor",
        "description": "äº‘å°æ°´å¹³å¯è½¬åˆ°æ­¥æ•°",
        "code": "h_ptz_max_step",
        "enabled": true,
        "valueType": "int",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 0,
        "values": [],
        "sort": 110
      },
      {
        "categoryCode": "motor",
        "description": "äº‘å°å‚ç›´å¯è½¬åˆ°æ­¥æ•°",
        "code": "v_ptz_max_step",
        "enabled": true,
        "valueType": "int",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 0,
        "values": [],
        "sort": 120
      }
    ]
  },
  {
    "categoryCode": "other",
    "categoryTitle": "å…¶ä»–",
    "items": [
      {
        "categoryCode": "other",
        "description": "æ‘„åƒå¤´ä¸ªæ•°(0~10)",
        "code": "sensor_num",
        "enabled": true,
        "valueType": "int",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 10,
        "values": [],
        "sort": 510
      }
    ]
  }
]
```

<br/>

è½¬åŒ–æˆå¦‚ä¸‹ç»“æ„ï¼š

```json
TFå¡JSONæ•°æ®ï¼š

[
  {
    "categoryCode": "led",
    "categoryTitle": "LEDç¯",
    "items": [
      {
        "categoryCode": "led",
        "description": "ç™½å…‰ç¯ï¼Œ1:ä½ç”µå¹³æœ‰æ•ˆ 0:é«˜ç”µå¹³æœ‰æ•ˆ",
        "code": "white_light_active_low",
        "enabled": true,
        "valueType": "enum",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 0,
        "values": [
          {
            "name": "é«˜ç”µå¹³æœ‰æ•ˆ",
            "value": 0
          },
          {
            "name": "ä½ç”µå¹³æœ‰æ•ˆ",
            "value": 1
          }
        ],
        "sort": 10
      },
      {
        "categoryCode": "led",
        "description": "çº¢å¤–ç¯ï¼Œ1:ä½ç”µå¹³æœ‰æ•ˆ 0:é«˜ç”µå¹³æœ‰æ•ˆ",
        "code": "infrared_light_active_low",
        "enabled": true,
        "valueType": "enum",
        "defaultValue": null,
        "minValue": 0,
        "maxValue": 0,
        "values": [
          {
            "name": "é«˜ç”µå¹³æœ‰æ•ˆ",
            "value": 0
          },
          {
            "name": "ä½ç”µå¹³æœ‰æ•ˆ",
            "value": 1
          }
        ],
        "sort": 20
      }
    ]
  },
  
  Ë™Ë™Ë™Ë™Ë™Ë™Ë™
  Ë™Ë™Ë™Ë™Ë™
  .
]
```

***
<br/>

è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ã€ŒåµŒå¥—æ•°ç»„æ‰å¹³åŒ– + è‡ªå®šä¹‰é”®åæ˜ å°„ã€éœ€æ±‚ã€‚

**æˆ‘çš„ç»“æ„æ˜¯ï¼š**

```js
[
  {
    categoryCode,
    categoryTitle,
    items: [ {...}, {...}, ... ]
  },
  ...
]
```

<br/>

æƒ³å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ç»“æ„ï¼š

```js
{
  whiteLight: {...},
  redLight: {...},
  ...
}
```

---
<br/>

 **å®Œæ•´å¯è¿è¡Œçš„ JS å®ç°ç¤ºä¾‹:**

```js
const data = [ /* ä½ æä¾›çš„ JSON æ•°ç»„ */ ];

// 1ï¸âƒ£ å®šä¹‰ä¸€ä¸ªæ˜ å°„è¡¨ï¼ŒæŠŠ code å¯¹åº”æˆæƒ³è¦çš„ key
const codeMap = {
  white_light_active_low: 'whiteLight',
  infrared_light_active_low: 'redLight',
  v_ptz_max_step: 'ptz_v_stepNum',
  sensor_num: 'cameraNum',
};

// 2ï¸âƒ£ éå†æ•°æ®ç»“æ„ï¼ŒæŠŠæ‰€æœ‰ items æ‰å¹³åŒ–å¹¶æ˜ å°„åˆ°æ–°å¯¹è±¡
const result = data.reduce((acc, category) => {
  category.items.forEach(item => {
    const key = codeMap[item.code] || item.code; // è‹¥æ— æ˜ å°„åˆ™ä½¿ç”¨åŸ code
    // æ·±æ‹·è´åæŠŠ values çš„ name æ”¹æˆ labelï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    const newItem = {
      ...item,
      values: item.values.map(v => ({
        label: v.name || v.label,
        value: v.value
      }))
    };
    acc[key] = newItem;
  });
  return acc;
}, {});

console.log(result);
```

<br/>

 **è¾“å‡ºç»“æœç¤ºä¾‹ï¼ˆéƒ¨åˆ†ï¼‰**

```js
{
  whiteLight: {
    categoryCode: 'led',
    description: 'ç™½å…‰ç¯ï¼Œ1:ä½ç”µå¹³æœ‰æ•ˆ 0:é«˜ç”µå¹³æœ‰æ•ˆ',
    code: 'white_light_active_low',
    enabled: true,
    valueType: 'enum',
    defaultValue: null,
    minValue: 0,
    maxValue: 0,
    values: [
      { label: 'é«˜ç”µå¹³æœ‰æ•ˆ', value: 0 },
      { label: 'ä½ç”µå¹³æœ‰æ•ˆ', value: 1 }
    ],
    sort: 10
  },
  redLight: {
    categoryCode: 'led',
    description: 'çº¢å¤–ç¯ï¼Œ1:ä½ç”µå¹³æœ‰æ•ˆ 0:é«˜ç”µå¹³æœ‰æ•ˆ',
    code: 'infrared_light_active_low',
    ...
  },
  ...
}
```

<br/>

**âœ… å¦‚æœä½ ä¸éœ€è¦æ‰‹åŠ¨å†™ `codeMap`**

å¯ä»¥è®©é”®åè‡ªåŠ¨æ¥è‡ª `code` æœ¬èº«ï¼ˆä½†è¿™ä¼šæ¯”è¾ƒé•¿ï¼‰ï¼š

```js
const result = Object.fromEntries(
  data.flatMap(category =>
    category.items.map(item => [
      item.code,
      {
        ...item,
        values: item.values.map(v => ({ label: v.name || v.label, value: v.value }))
      }
    ])
  )
);
```

è¾“å‡ºé”®åä¼šæ˜¯ï¼š

```js
{
  white_light_active_low: {...},
  infrared_light_active_low: {...},
  ...
}
```


ä¸Šè¿°ä¸­çš„[**`reduce`**](./../JavaScript/åŸºç¡€(I).md#reduceçš„æ‰å¹³åŒ–)æ–¹æ³•å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ

***
<br/>

**å‚æ•°å›å¡«ç»„åˆï¼š**

```json
{
    "whiteLight": 1,
    "redLight": 1,
    "ptz_v_stepNum": "3",
    "cameraNum": "7"
}
```

<br/>

ç»„åˆæˆè¿™æ ·ï¼š

```json

[
  {
    "code": "white_light_active_low",
    "value": 1
  },
  {
      "code": "infrared_light_active_low",
      "value": 1
  },
  {
    "code": "v_ptz_max_step",
    "value": "3"
  },
  {
    "code": "sensor_num",
    "value": "7"
  }
]
```


<br/>

è¿™é‡Œå¯ä»¥ç”¨ä¸€è¡Œ `Object.entries()` + `find()` æˆ– `reduce()` è½»æ¾å®Œæˆã€‚
ä¸‹é¢æ˜¯å®Œæ•´ã€å‡†ç¡®ã€æ¨èçš„å†™æ³• ğŸ‘‡

---

### âœ… å®Œæ•´å¯è¿è¡Œä»£ç 

```js
const codeMap = {
    "whiteLight": "white_light_active_low",
    "redLight": "infrared_light_active_low",
    "ptz_v_stepNum": "v_ptz_max_step",
    "cameraNum": "sensor_num"
}
const source = {
    "whiteLight": 1,
    "redLight": 1,
    "ptz_v_stepNum": "3",
    "cameraNum": "7"
};

// åè½¬æ˜ å°„ï¼Œæ–¹ä¾¿ä» value æ‰¾ key
const reverseMap = Object.entries(codeMap).reduce((acc, [k, v]) => {
  acc[v] = k;
  return acc;
}, {});

// ç”Ÿæˆ items æ•°ç»„
const items = Object.entries(source).map(([key, value]) => ({
  code: reverseMap[key] || key, // æ²¡åœ¨æ˜ å°„è¡¨ä¸­çš„ä¿æŒåŸæ ·
  value,
}));

console.log(items);
```

<br/>

**è¾“å‡º**ï¼š

```js
[
  {
    "code": "white_light_active_low",
    "value": 1
  },
  {
      "code": "infrared_light_active_low",
      "value": 1
  },
  {
    "code": "v_ptz_max_step",
    "value": "3"
  },
  {
    "code": "sensor_num",
    "value": "7"
  }
]
```

---
<br/>

**âœ… è¯´æ˜**

* `Object.entries()` å°†å¯¹è±¡è½¬æˆ `[key, value]` æ•°ç»„ï¼Œæ–¹ä¾¿éå†ï¼›
* `reduce()` ç”¨äºç”Ÿæˆåå‘æ˜ å°„è¡¨ï¼›
* æœ€åé€šè¿‡ `map()` æŠŠåŸå§‹å¯¹è±¡è½¬ä¸ºä½ æƒ³è¦çš„ `{ code, value }` æ•°ç»„ï¼›
* è‹¥æŸä¸ªå­—æ®µä¸åœ¨ `codeMap` é‡Œï¼Œåˆ™ä¿æŒåŸé”®ã€‚


<br/><br/><br/>
># <h2 id="å¤æ‚æ•°æ®æ›´æ–°">å¤æ‚æ•°æ®æ›´æ–°</h2>

è‹¥è¿™ä¸ªpcbaListæ˜¯è¿™ç§æ•°æ®ç±»å‹çš„ä¸€ä¸ªå¦‚ä¸‹ï¼š
```js
{
  activityName: { value: activityModel?.activityName ?? '-', isLegal: true },
  activityTime: { value: activityModel?.activityTime ?? '-', isLegal: true },
  publishStatus: { value: activityModel?.publishStatus ?? false, isLegal: true },
  pcbaList: activityModel?.pcbaList ?? [],
  chooseMerchant: { value: {}, isLegal: true },
  pcbaList: { value: activityModel.pcbaList, isLegal: true },
  // totalSubsidyQuantity: activityModel?.totalSubsidyQuantity ?? 0,
}
```
**ä¸Šè¿°ä¿®æ”¹å…¶å®æ˜¯  pcbaList: { value: activityModel.pcbaList, isLegal: true },ä¸­çš„valueï¼Œé‚£æˆ‘å¦‚ä½•åš?**

<br/><br/>

**æ•°æ®ç»“æ„æ˜¯ï¼š**

```js
pcbaList: { 
  value: activityModel.pcbaList, 
  isLegal: true 
}
```

è¦æ›´æ–°çš„å…¶å®æ˜¯ **pcbaList.value é‡Œé¢çš„æ•°ç»„ä¸­çš„æŸä¸ªå¯¹è±¡**ã€‚

---

<br/>
**å‡è®¾ä½ è¦ä¿®æ”¹ `productIdentifier: 'imilab.ipc.11309.pmc1'` çš„ `activeSubsidy`**

```js
updatePcbaActiveSubsidy = (targetId, newSubsidy) => {
  this.setState(prevState => {
    const { pcbaList } = prevState.activityDatas;

    const newPcbaValue = pcbaList.value.map(item => {
      if (item.productIdentifier === targetId) {
        return {
          ...item,
          activeSubsidy: newSubsidy
        };
      }
      return item;
    });

    return {
      activityDatas: {
        ...prevState.activityDatas,
        pcbaList: {
          ...pcbaList,
          value: newPcbaValue
        }
      }
    };
  });
};
```
<br/>

```js
this.updatePcbaActiveSubsidy('imilab.ipc.11309.pmc1', 888);
```

<br/>

**state å¤§æ¦‚åƒè¿™æ ·ï¼š**

```js
activityDatas: {
  activityName: { value: 'xxx', isLegal: true },
  activityTime: { value: 'xxx', isLegal: true },
  pcbaList: { 
    value: [ {â€¦}, {â€¦}, {â€¦} ], 
    isLegal: true 
  },
  ...
}
```

è¦æ›´æ–°ï¼š

* æœ€å¤–å±‚çš„ activityDatas
* å…¶ä¸­çš„ pcbaList
* å…¶ä¸­çš„ valueï¼ˆæ•°ç»„ï¼‰
* æ•°ç»„ä¸­æŸä¸€ä¸ªå¯¹è±¡

æ‰€ä»¥ç»“æ„æ˜¯ï¼š

```sh
activityDatas
  â””â”€â”€ pcbaList
        â””â”€â”€ valueï¼ˆæ•°ç»„ï¼‰
              â””â”€â”€ item (ä½ çš„ PCBA æ•°æ®å¯¹è±¡)
```


<br/><br/>

```js
updatePcbaItem = (productIdentifier, patchObj) => {
  this.setState(prevState => {
    const pcbaList = prevState.activityDatas.pcbaList;

    const newValue = pcbaList.value.map(item =>
      item.productIdentifier === productIdentifier
        ? { ...item, ...patchObj }
        : item
    );

    return {
      activityDatas: {
        ...prevState.activityDatas,
        pcbaList: { ...pcbaList, value: newValue }
      }
    };
  }, () => {
    // â˜…â˜…â˜… è¿™é‡Œå°±æ˜¯æœ€æ–°çš„ state â˜…â˜…â˜…
    console.log('æœ€æ–°çš„ pcbaList:', this.state.activityDatas.pcbaList.value);
  });
};

```

<br/><br/><br/>

># <h2 id="å¤æ‚æ•°æ®åˆå¹¶">å¤æ‚æ•°æ®åˆå¹¶</h2>

è‹¥æ˜¯å¯¹äºresä¸­çš„æ•°æ®åœ¨å¦‚ä¸‹æ•°æ®ï¼š

```js



const oldValue = [
    {
        "pcbaName": "AA40",
        "productIdentifier": "imilab.ipc.116.pmc1",
        "productType": "æ™ºèƒ½æ‘„åƒæœº",
        "materialNumber": "10.19.33.6.1",
        "costPrice": "100.0",
        "currentPrice": "50.0",
        "activeSubsidy": 1
    },
    {
        "pcbaName": "AA30",
        "productIdentifier": "imilab.ipc.113.pmc1",
        "productType": "æ™ºèƒ½æ‘„åƒæœº",
        "materialNumber": "10.99.33.6.1",
        "costPrice": "100.0",
        "currentPrice": "50.0"
    }
]
```
**éœ€æ±‚ï¼šæŒ‰ productIdentifier è¿›è¡Œåˆå¹¶**ï¼š

* å¦‚æœ `oldValue` ä¸­å­˜åœ¨åŒæ ·çš„ `productIdentifier` â†’ **ä½¿ç”¨ oldValue çš„æ•´ä¸ªå¯¹è±¡ï¼ˆåŒ…æ‹¬ activeSubsidy ç­‰å­—æ®µï¼‰**
* å¦‚æœä¸å­˜åœ¨ â†’ **ä½¿ç”¨ res çš„åŸå¯¹è±¡**
* æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚

---
<br/>

**âœ… æœ€ç»ˆåˆå¹¶ä»£ç **

```js
const oldMap = Object.fromEntries(
  oldValue.map(item => [item.productIdentifier, item])
);

const finalList = res.map(item =>
  oldMap[item.productIdentifier] || item
);
```

<br/>

**ğŸ” è¾“å‡ºè§£é‡Š**

`finalList` ä¼šæ˜¯ï¼š

* å¦‚æœæŸä¸ª productIdentifier åœ¨ oldValue ä¸­å‡ºç° â†’ oldValue çš„æ•°æ®è¦†ç›– res
* å¦åˆ™ä¿ç•™ res ä¸­åŸå§‹çš„æ•°æ®

---
<br/>

**æ­¥éª¤ 1ï¼šæŠŠ oldValue è½¬æˆ Mapï¼Œæé«˜æŸ¥æ‰¾æ€§èƒ½ï¼ˆO(1)ï¼‰**

```js
const oldMap = Object.fromEntries(
  oldValue.map(item => [item.productIdentifier, item])
);
```
<br/>

å¾—åˆ°ï¼š

```js
{
  "imilab.ipc.116.pmc1": { ... oldValue å¯¹è±¡ },
  "imilab.ipc.113.pmc1": { ... oldValue å¯¹è±¡ }
}
```

<br/>

**æ­¥éª¤ 2ï¼šéå† res å¹¶å†³å®šç”¨å“ªä¸ªå¯¹è±¡**

```js
const finalList = res.map(item =>
  oldMap[item.productIdentifier] || item
);
```

* å¦‚æœ `oldMap[productIdentifier]` å­˜åœ¨ â†’ ç”¨ oldValue çš„å¯¹è±¡
* ä¸å­˜åœ¨ â†’ ç”¨ res çš„å¯¹è±¡

<br/>

**å®Œæ•´ç¤ºä¾‹ï¼ˆå¯ç›´æ¥è¿è¡Œï¼‰**

```js
const res = [
  {
    pcbaName: 'AA30',
    productIdentifier: 'imilab.ipc.113.pmc1',
    productType: 'æ™ºèƒ½æ‘„åƒæœº',
    materialNumber: '10.99.33.6.1',
    costPrice: '100.0',
    currentPrice: '50.0'
  },
  {
    pcbaName: 'AA40',
    productIdentifier: 'imilab.ipc.116.pmc1',
    productType: 'æ™ºèƒ½æ‘„åƒæœº',
    materialNumber: '10.19.33.6.1',
    costPrice: '100.0',
    currentPrice: '50.0'
  }
];

const oldValue = [
  {
    pcbaName: 'AA40',
    productIdentifier: 'imilab.ipc.116.pmc1',
    productType: 'æ™ºèƒ½æ‘„åƒæœº',
    materialNumber: '10.19.33.6.1',
    costPrice: '100.0',
    currentPrice: '50.0',
    activeSubsidy: 1
  },
  {
    pcbaName: 'AA30',
    productIdentifier: 'imilab.ipc.113.pmc1',
    productType: 'æ™ºèƒ½æ‘„åƒæœº',
    materialNumber: '10.99.33.6.1',
    costPrice: '100.0',
    currentPrice: '50.0'
  }
];

const oldMap = Object.fromEntries(
  oldValue.map(item => [item.productIdentifier, item])
);

const finalList = res.map(item =>
  oldMap[item.productIdentifier] || item
);

console.log(finalList);
```

<br/>

**æœ€ç»ˆç»“æœï¼ˆç¤ºä¾‹ï¼‰**

å› ä¸º oldValue ä¸­ä¸¤ä¸ª productIdentifier éƒ½å­˜åœ¨ï¼Œæœ€ç»ˆç»“æœä½¿ç”¨äº† oldValue çš„ä¸¤ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬ activeSubsidyã€‚


<br/><br/><br/>

***
<br/>

># <h1 id="Flexå¸ƒå±€">[Flexå¸ƒå±€](https://cloud.tencent.com/developer/article/1620305)</h1>

æ¨ªè½´å’Œçºµè½´å¸ƒå±€é€šå¸¸æŒ‡çš„æ˜¯ä½¿ç”¨ **Flexbox** æˆ– **Grid** å¸ƒå±€å®ç°çš„ä¸€ç»´ï¼ˆæ¨ªå‘æˆ–çºµå‘æ’åˆ—ï¼‰æˆ–äºŒç»´ï¼ˆåŒæ—¶æ§åˆ¶æ¨ªè½´å’Œçºµè½´ï¼‰å¸ƒå±€ã€‚æœ€å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼æ˜¯ **Flexbox** å¸ƒå±€å’Œ **CSS Grid** å¸ƒå±€ã€‚

**1.Flexbox å¸ƒå±€**

**Flexbox** å¸ƒå±€æ˜¯ä¸€ä¸ªä¸€ç»´çš„å¸ƒå±€æ¨¡å‹ï¼Œå®ƒå¯ä»¥åœ¨æ¨ªå‘æˆ–çºµå‘ä¸Šæ’åˆ—å­å…ƒç´ ã€‚é€šè¿‡è®¾ç½® `flex-direction` æ¥æ§åˆ¶æ¨ªè½´ï¼ˆä¸»è½´ï¼‰å’Œçºµè½´ï¼ˆäº¤å‰è½´ï¼‰çš„æ–¹å‘ã€‚`flex-direction` å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§å€¼ï¼š

* `row`ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå…ƒç´ æŒ‰æ¨ªå‘ï¼ˆä»å·¦åˆ°å³ï¼‰æ’åˆ—ã€‚
* `column`ï¼šå…ƒç´ æŒ‰çºµå‘ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰æ’åˆ—ã€‚
* `row-reverse`ï¼šå…ƒç´ æŒ‰æ¨ªå‘ï¼ˆä»å³åˆ°å·¦ï¼‰æ’åˆ—ã€‚
* `column-reverse`ï¼šå…ƒç´ æŒ‰çºµå‘ï¼ˆä»ä¸‹åˆ°ä¸Šï¼‰æ’åˆ—ã€‚

<br/>

**Flexbox çš„åŸºç¡€å±æ€§**ï¼š

* `justify-content`: æ§åˆ¶ä¸»è½´ï¼ˆæ¨ªè½´æ–¹å‘ï¼‰ä¸Šçš„å¯¹é½æ–¹å¼ã€‚
* `align-items`: æ§åˆ¶äº¤å‰è½´ï¼ˆçºµè½´æ–¹å‘ï¼‰ä¸Šçš„å¯¹é½æ–¹å¼ã€‚
* `flex-direction`: è®¾ç½®ä¸»è½´æ–¹å‘ã€‚
* `flex-wrap`: æ§åˆ¶å­å…ƒç´ æ˜¯å¦æ¢è¡Œã€‚

<br/>

**ç¤ºä¾‹ï¼šæ¨ªè½´å’Œçºµè½´å¸ƒå±€ï¼ˆFlexboxï¼‰**

```jsx
import React from 'react';

class FlexboxExample extends React.Component {
  render() {
    return (
      <div style={{
        display: 'flex',
        flexDirection: 'row', // æ¨ªè½´å¸ƒå±€
        justifyContent: 'space-between', // æ¨ªè½´ä¸Šçš„é¡¹ç›®ä¹‹é—´æœ‰é—´è·
        alignItems: 'center', // çºµè½´å±…ä¸­å¯¹é½
        height: '200px',
        border: '1px solid black'
      }}>
        <div style={{ width: '100px', height: '50px', backgroundColor: 'lightblue' }}>Item 1</div>
        <div style={{ width: '100px', height: '50px', backgroundColor: 'lightgreen' }}>Item 2</div>
        <div style={{ width: '100px', height: '50px', backgroundColor: 'lightcoral' }}>Item 3</div>
      </div>
    );
  }
}

export default FlexboxExample;
```

<br/>

**è§£é‡Šï¼š**

* `display: 'flex'`ï¼šå¯ç”¨ Flexbox å¸ƒå±€ã€‚
* `flexDirection: 'row'`ï¼šè®¾ç½®ä¸»è½´ä¸ºæ¨ªè½´ï¼Œå­é¡¹å°†æŒ‰æ¨ªå‘æ’åˆ—ã€‚
* `justifyContent: 'space-between'`ï¼šè®¾ç½®æ¨ªè½´ä¸Šçš„é¡¹ç›®ä¹‹é—´çš„é—´è·å‡åŒ€åˆ†å¸ƒã€‚
* `alignItems: 'center'`ï¼šè®¾ç½®çºµè½´ï¼ˆäº¤å‰è½´ï¼‰ä¸Šçš„é¡¹ç›®å±…ä¸­å¯¹é½ã€‚

<br/>

**2.CSS Grid å¸ƒå±€**

**Grid å¸ƒå±€** æ˜¯ä¸€ä¸ªäºŒç»´çš„å¸ƒå±€æ¨¡å‹ï¼Œèƒ½å¤ŸåŒæ—¶æ§åˆ¶æ¨ªè½´å’Œçºµè½´ä¸Šçš„å…ƒç´ æ’åˆ—ã€‚é€šè¿‡è®¾ç½® `grid-template-columns` å’Œ `grid-template-rows` æ¥å®šä¹‰ç½‘æ ¼çš„åˆ—å’Œè¡Œã€‚

<br/>

**Grid çš„åŸºæœ¬å±æ€§**ï¼š

* `grid-template-columns`: å®šä¹‰ç½‘æ ¼åˆ—çš„æ•°é‡å’Œå®½åº¦ã€‚
* `grid-template-rows`: å®šä¹‰ç½‘æ ¼è¡Œçš„æ•°é‡å’Œé«˜åº¦ã€‚
* `grid-gap`: å®šä¹‰è¡Œä¸åˆ—ä¹‹é—´çš„é—´è·ã€‚

<br/>

**ç¤ºä¾‹ï¼šæ¨ªè½´å’Œçºµè½´å¸ƒå±€ï¼ˆCSS Gridï¼‰**

```jsx
import React from 'react';

class GridExample extends React.Component {
  render() {
    return (
      <div style={{
        display: 'grid',
        gridTemplateColumns: 'repeat(3, 1fr)', // å®šä¹‰ä¸‰åˆ—ï¼Œæ¯åˆ—å®½åº¦ç›¸ç­‰
        gridTemplateRows: '100px 100px', // å®šä¹‰ä¸¤è¡Œï¼Œæ¯è¡Œ100pxé«˜
        gap: '10px', // åˆ—å’Œè¡Œä¹‹é—´çš„é—´è·
        border: '1px solid black'
      }}>
        <div style={{ backgroundColor: 'lightblue' }}>Item 1</div>
        <div style={{ backgroundColor: 'lightgreen' }}>Item 2</div>
        <div style={{ backgroundColor: 'lightcoral' }}>Item 3</div>
        <div style={{ backgroundColor: 'lightyellow' }}>Item 4</div>
        <div style={{ backgroundColor: 'lightpink' }}>Item 5</div>
        <div style={{ backgroundColor: 'lightgray' }}>Item 6</div>
      </div>
    );
  }
}

export default GridExample;
```

<br/>

**è§£é‡Šï¼š**

* `display: 'grid'`ï¼šå¯ç”¨ Grid å¸ƒå±€ã€‚
* `gridTemplateColumns: 'repeat(3, 1fr)'`ï¼šè®¾ç½®ä¸‰åˆ—ï¼Œæ¯åˆ—å®½åº¦ç›¸ç­‰ï¼ˆ`1fr` è¡¨ç¤ºç­‰åˆ†çš„å®½åº¦ï¼‰ã€‚
* `gridTemplateRows: '100px 100px'`ï¼šè®¾ç½®ä¸¤è¡Œï¼Œæ¯è¡Œçš„é«˜åº¦ä¸º 100pxã€‚
* `gap: '10px'`ï¼šè®¾ç½®è¡Œå’Œåˆ—ä¹‹é—´çš„é—´éš”ã€‚

<br/>

**æ€»ç»“**

* **Flexbox**ï¼šé€‚ç”¨äºä¸€ç»´å¸ƒå±€ï¼ˆæ¨ªè½´æˆ–çºµè½´ï¼‰ï¼Œå¯ä»¥æ§åˆ¶å•è¡Œæˆ–å•åˆ—çš„æ’åˆ—ï¼Œå¸¸ç”¨äºå¤„ç†ç®€å•çš„æ’åˆ—ï¼Œå¦‚æ°´å¹³æˆ–å‚ç›´å±…ä¸­ã€‚
* **Grid**ï¼šé€‚ç”¨äºäºŒç»´å¸ƒå±€ï¼Œèƒ½å¤ŸåŒæ—¶æ§åˆ¶æ¨ªè½´å’Œçºµè½´ä¸Šçš„å…ƒç´ å¸ƒå±€ï¼Œé€‚åˆå¤æ‚çš„å¸ƒå±€ï¼Œå¦‚ç½‘æ ¼å¸ƒå±€ã€æ‚å¿—æ ·å¼çš„å†…å®¹ã€‚


<br/><br/><br/>

***
<br/>

> <h1 id="æ¸…ç†ç¼“å­˜å¯¼è‡´çš„é”™è¯¯">æ¸…ç†ç¼“å­˜å¯¼è‡´çš„é”™è¯¯</h1>

**1.åˆ é™¤æ„å»ºç¼“å­˜**

```bash
rm -rf node_modules/.cache
```

<br/>

**2.é‡å¯å¼€å‘æœåŠ¡å™¨**

å…ˆå…³é—­å½“å‰è¿è¡Œçš„ `npm run dev` æˆ– `npm start`ï¼Œç„¶åé‡æ–°å¯åŠ¨ï¼š

```bash
npm run start
# æˆ–è€…
npm run dev
```

<br/>

**3.æ¸…ç†æµè§ˆå™¨ç¼“å­˜ï¼ˆå¦‚æœæœ‰é—®é¢˜å‡ºç°åœ¨æµè§ˆå™¨ï¼‰**

å¯ä»¥å°è¯•å¼ºåˆ¶åˆ·æ–°é¡µé¢ï¼š

* Windows: `Ctrl + Shift + R`
* Mac: `Cmd + Shift + R`

<br/>

**4.ç¡®ä¿ç¼–è¾‘å™¨ä¹Ÿæ²¡ç¼“å­˜è¯­æ³•åˆ†æé”™è¯¯**

æœ‰äº›ç¼–è¾‘å™¨ï¼ˆå¦‚ VS Codeï¼‰å¯èƒ½è‡ªå·±ç¼“å­˜äº† ESLint æŠ¥é”™æç¤ºï¼Œé‡å¯ç¼–è¾‘å™¨å¯ä»¥æ’é™¤è¿™ä¸ªé—®é¢˜ã€‚

<br/>

**5.æ£€æŸ¥ ESLint ç¼“å­˜ï¼ˆå¦‚æœé¡¹ç›®ç”¨äº† ESLintï¼‰**

è¿è¡Œï¼š

```bash
npx eslint . --cache --fix
```


<br/><br/><br/>

***
<br/>

> <h1 id="è·¨åŸŸé€ æˆæ— æ³•è¯·æ±‚è§£å†³">è·¨åŸŸé€ æˆæ— æ³•è¯·æ±‚è§£å†³</h1>

åœ¨é¡¹ç›®ç›®å½•ä¸­çš„`package.jsonä¸­æ·»åŠ â€Œ`

```json
devDependencies": {
Â Â Â Â "http-proxy-middleware": "^3.0.5"
Â Â }
```

<br/><br/>

ç„¶åæ–°å»º`setup.js`åœ¨æ ¹ç›®å½•:

```
const { createProxyMiddleware } = require('http-proxy-middleware');
 
module.exports = function(app) {
Â Â app.use(
Â Â Â Â '/api',
Â Â Â Â createProxyMiddleware({
Â Â Â Â Â Â target: 'https://itango.tencent.com/out/itango/myip',
Â Â Â Â Â Â changeOrigin: true,
Â Â Â Â })
Â Â );

	app.use(
	Â Â Â Â '/api1',
	Â Â Â Â createProxyMiddleware({
	Â Â Â Â Â Â target: 'https://itango.tencent.com/out/itango/myip1',
	Â Â Â Â Â Â changeOrigin: true,
	Â Â Â Â })
	Â Â );
};
```

<br/>

ç„¶ååœ¨`httpManager.js`ä¸­ç¼–ç :

```
class httpManager {
Â Â async get(url) {
Â Â Â Â try {
Â Â Â Â Â Â const response = await fetch(url);
Â Â Â Â Â Â if (!response.ok) throw new Error("Network response was not ok");
Â Â Â Â Â Â const data = await response.json(); // å¦‚æœè¿”å›çš„æ˜¯ JSON
Â Â Â Â Â Â return data;
Â Â Â Â } catch (error) {
Â Â Â Â Â Â console.error("GET è¯·æ±‚å‡ºé”™:", error);
Â Â Â Â Â Â throw error;
Â Â Â Â }
Â Â }
}

const HttpManagerInstance = new httpManager();
export default HttpManagerInstance;
```

ç„¶ååœ¨éœ€è¦çš„åœ°æ–¹è°ƒç”¨å³å¯:

```
async fetchIP() {
Â Â Â Â try {
Â Â Â Â Â Â const data = await HttpManager1.get(
Â Â Â Â Â Â Â Â "/api"
Â Â Â Â Â Â );
Â Â Â Â Â Â this.setState({ ipData: data });
Â Â Â Â } catch (error) {
Â Â Â Â Â Â this.setState({ error: "è·å– IP å¤±è´¥" });
Â Â Â Â }
Â Â }
```




<br/><br/><br/>

***
<br/>
> <h1 id="æ§åˆ¶èœå•å±•å¼€å’Œé€‰ä¸­é¡¹">æ§åˆ¶èœå•å±•å¼€å’Œé€‰ä¸­é¡¹</h1>

```js
const location = useLocation();
const queryParams = new URLSearchParams(location.search);
const [openKeys, setOpenKeys] = useState([])
// ç‰¹æ®Šèœå•æŒ‡å®šèœå•é€‰ä¸­
const specialMenu: { [key: string]: string } = {
'/product/argusProductNetwork': '/product',}
```

&emsp; è¿™æ®µ React ä»£ç ï¼Œä¸»è¦ç”¨äº**æ§åˆ¶èœå•å±•å¼€å’Œé€‰ä¸­é¡¹**ã€‚

<br/>

**âœ… 1. `const location = useLocation();`**

è¿™æ˜¯æ¥è‡ª `react-router-dom` çš„ hookï¼Œç”¨æ¥è·å–**å½“å‰è·¯ç”±ä¿¡æ¯**ã€‚

```ts
import { useLocation } from 'react-router-dom';
```


ğŸ‘‡ å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ª location å¯¹è±¡ï¼Œç±»ä¼¼è¿™æ ·ï¼š

```ts
{
  pathname: '/product/argusProductNetwork',
  search: '?type=detail&id=123',
  hash: '',
  state: null,
  key: 'abc123'
}
```

ä½ å¯ä»¥ç†è§£ä¸ºâ€œå½“å‰é¡µé¢çš„å®Œæ•´ URL ä¿¡æ¯â€ã€‚

<br/>

**âœ… 2. `const queryParams = new URLSearchParams(location.search);`**

è¿™å¥ç”¨åŸç”Ÿ `URLSearchParams` æ¥è§£æ **æŸ¥è¯¢å‚æ•°**ï¼ˆ`?xxx=yyy`ï¼‰ã€‚

```ts
const queryParams = new URLSearchParams('?type=detail&id=123');
console.log(queryParams.get('type')); // "detail"
console.log(queryParams.get('id'));   // "123"
```

åœ¨å®é™…é¡µé¢ä¸­ï¼Œå¦‚æœ URL æ˜¯ï¼š

```
https://example.com/product/argusProductNetwork?type=detail&id=123
```

é‚£ä¹ˆ `location.search` æ˜¯ `?type=detail&id=123`ï¼Œè¿™ä¸ªä»£ç å°±èƒ½è·å–å‚æ•°ä¸­çš„å†…å®¹ã€‚

<br/>

**âœ… 3. `const [openKeys, setOpenKeys] = useState([])`**

è¿™æ˜¯ React çš„ `useState` ç”¨æ³•ï¼Œç”¨æ¥ä¿å­˜**å½“å‰å±•å¼€çš„èœå•é¡¹ key æ•°ç»„**ã€‚

```ts
const [openKeys, setOpenKeys] = useState<string[]>([]);
```

* `openKeys` è¡¨ç¤ºâ€œèœå•å±•å¼€çš„ keyâ€ï¼ˆå¦‚ `/product`ï¼‰
* `setOpenKeys` æ˜¯ç”¨äºä¿®æ”¹è¿™ä¸ªçŠ¶æ€çš„æ–¹æ³•

æ¯”å¦‚ç”¨åœ¨ Ant Design çš„ `<Menu>` ç»„ä»¶ä¸­ï¼š

```jsx
<Menu openKeys={openKeys} onOpenChange={setOpenKeys} />
```

ç”¨æˆ·å±•å¼€å“ªä¸ªèœå•ï¼Œå°±æ›´æ–° `openKeys`ã€‚

<br/>

**âœ… 4. `const specialMenu: { [key: string]: string } = { ... }`**

å®šä¹‰ä¸€ä¸ª**ç‰¹æ®Šèœå•é¡¹çš„æ˜ å°„è¡¨**ï¼Œä¸»è¦ç”¨äºå¤„ç†â€œå­é¡µé¢é€‰ä¸­æ—¶ï¼Œå¼ºåˆ¶è®©çˆ¶èœå•ä¹Ÿå±•å¼€â€ã€‚

```ts
const specialMenu: { [key: string]: string } = {
  '/product/argusProductNetwork': '/product',
};
```

* æ„æ€æ˜¯ï¼šå¦‚æœå½“å‰è·¯å¾„æ˜¯ `/product/argusProductNetwork`ï¼Œé‚£å®ƒå®é™…å½’å±çš„ä¸»èœå•æ˜¯ `/product`
* å› ä¸ºå¾ˆå¤šæ—¶å€™è·¯ç”±æ˜¯å¤šçº§çš„ï¼Œèœå•åªæ¸²æŸ“ä¸€çº§æˆ–ä¸¤çº§ï¼Œä½†ä½ éœ€è¦æ ¹æ®å­é¡µé¢åæ¨å‡ºçˆ¶èœå•


***
<br/>

**âœ… ä¸¾ä¸ªå®Œæ•´åº”ç”¨åœºæ™¯ï¼š**
å½“å‰é¡µé¢è·¯å¾„æ˜¯ `/product/argusProductNetwork`ï¼Œä½†è¿™ä¸ªé¡µé¢ **å¹¶ä¸åœ¨èœå•ä¸­æœ‰å¯¹åº”é¡¹**ï¼Œæ‰€ä»¥ä½ éœ€è¦æ‰‹åŠ¨å‘Šè¯‰èœå•â€œå½“å‰è·¯å¾„å±äº `/product` èœå•â€ã€‚

**ç¤ºä¾‹ä¼ªä»£ç ï¼ˆå®Œæ•´é€»è¾‘å¯èƒ½é•¿è¿™æ ·ï¼‰ï¼š**

```tsx
useEffect(() => {
  const path = location.pathname;
  const rootPath = specialMenu[path] || path.split('/')[1]; // è·å–åº”è¯¥å±•å¼€çš„èœå•
  setOpenKeys([rootPath]);
}, [location.pathname]);
```

<br/>

**âœ… å¯è§†åŒ–ç†è§£**

```text
å®é™…é¡µé¢è·¯å¾„: /product/argusProductNetwork

èœå•ç»“æ„:
- /product
  - /product/list
  - /product/create

ä½ è¦åšçš„æ˜¯ï¼š
â¡ï¸ å½“è·¯å¾„ä¸º /product/argusProductNetwork æ—¶
â¡ï¸ æ‰‹åŠ¨è®¾ç½® openKeys = ['/product']
```


ä½¿ç”¨[Ant Design çš„ <Menu /> ç»„ä»¶åšä¾§è¾¹æ èœå•](./AntDesign.md#Menuç»„ä»¶åšä¾§è¾¹æ èœå•)




<br/><br/><br/>

***
<br/>

> <h1 id="umiæ¡†æ¶ç”Ÿæˆreactå…¥å£æ–‡ä»¶"> umiæ¡†æ¶ç”Ÿæˆreactå…¥å£æ–‡ä»¶ </h1>


 **âœ… ä¸€ã€React å…¥å£æ–‡ä»¶ä¸€å®šæ˜¯ `App.js` å—ï¼Ÿ**

**ä¸æ˜¯ã€‚**

React çš„â€œå…¥å£æ–‡ä»¶â€å¯ä»¥æ˜¯ä»»ä½•æ–‡ä»¶åï¼Œæ¯”å¦‚ï¼š

* `App.js`
* `App.tsx`
* `Main.tsx`
* `Root.tsx`

å…³é”®ä¸åœ¨äºæ–‡ä»¶åï¼Œè€Œåœ¨äºè¿™ä¸ªæ–‡ä»¶è¢«è°å¼•ç”¨ã€‚

<br/>

**âœ… çœŸå®çš„ React å¯åŠ¨æµç¨‹æ˜¯ï¼š**

é€šå¸¸åœ¨ `index.tsx` æˆ– `main.tsx` ä¸­ï¼Œåƒè¿™æ ·ï¼š

```tsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

ReactDOM.createRoot(document.getElementById('root')!).render(<App />);
```

* `App` æ˜¯ä½ è‡ªå·±å‘½åçš„ä¸»ç»„ä»¶ï¼Œå®ƒå«ä»€ä¹ˆéƒ½è¡Œï¼ˆä¸å¿…å« `App.js`ï¼‰ã€‚
* å¦‚æœä½ ç”¨çš„æ˜¯ **TypeScript é¡¹ç›®**ï¼Œæ–‡ä»¶åç¼€å°±æ˜¯ `.tsx` è€Œä¸æ˜¯ `.js`ã€‚

æ‰€ä»¥ä½ çš„é¡¹ç›®ç”¨çš„æ˜¯ `app.tsx` æ˜¯å®Œå…¨æ­£å¸¸çš„ï¼Œåªæ˜¯æ–‡ä»¶åä¸åŒè€Œå·²ã€‚

---
<br/>

**âœ… äºŒã€é‚£è¿™ä¸ª `export const layout: RunTimeLayoutConfig = (...)` æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ**

è¿™ä¸æ˜¯ React æ ‡å‡†ç”¨æ³•ï¼Œæ˜¯ **UmiJS + Ant Design Pro æ¡†æ¶çš„ç‰¹æœ‰æ‰©å±•åŠŸèƒ½**ï¼Œä¹Ÿå«ï¼š

> **è¿è¡Œæ—¶é…ç½®ï¼ˆRuntime Configurationï¼‰**

å®ƒå…è®¸ä½ åœ¨è¿è¡Œæ—¶åŠ¨æ€é…ç½®é¡µé¢ Layoutï¼Œæ¯”å¦‚ï¼š

* æ˜¯å¦æ˜¾ç¤ºä¾§è¾¹æ 
* ç”¨æˆ·ä¿¡æ¯å¦‚ä½•è·å–
* èœå•å¦‚ä½•æ¸²æŸ“
* é¡µé¢æ ‡é¢˜ã€æƒé™æ§åˆ¶ç­‰

<br/>

 **âœ… ä½¿ç”¨ä½ç½®**

é€šå¸¸å†™åœ¨æ–‡ä»¶ï¼š`src/app.tsx` æˆ– `src/app.ts` ä¸­ã€‚

è¿™ä¸ªæ–‡ä»¶ä¸æ˜¯ React å…¥å£ç»„ä»¶ï¼Œè€Œæ˜¯ umi æ¡†æ¶**è‡ªåŠ¨åŠ è½½çš„è¿è¡Œæ—¶é…ç½®æ–‡ä»¶**ã€‚

<br/>

 âœ… ç¤ºä¾‹ä»£ç è§£è¯»

```tsx
import { RunTimeLayoutConfig } from '@umijs/max';

export const layout: RunTimeLayoutConfig = ({ initialState, setInitialState }) => {
  return {
    title: 'æˆ‘çš„åå°ç³»ç»Ÿ',
    layout: 'mix',
    contentWidth: 'Fluid',
    fixedHeader: true,
    onPageChange: () => {
      const { currentUser } = initialState || {};
      if (!currentUser?.name) {
        // å¦‚æœæœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ
        history.push('/login');
      }
    },
    logout: async () => {
      // æ¸…ç©ºç™»å½•çŠ¶æ€
      setInitialState({ ...initialState, currentUser: undefined });
      history.push('/login');
    },
  };
};
```

<br/>

 **âœ… è¿™äº›æ˜¯umi è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºç”Ÿæˆ **ProLayout çš„é…ç½®é¡¹**ï¼ŒåŒ…æ‹¬ï¼š**


| å­—æ®µ                | ä½œç”¨                                |
| ----------------- | --------------------------------- |
| `title`           | é¡µé¢æ ‡é¢˜                              |
| `layout`          | å¸ƒå±€ç±»å‹ï¼Œå¦‚ `'side'`, `'top'`, `'mix'` |
| `contentWidth`    | å†…å®¹å®½åº¦ï¼šå›ºå®š/æµå¼                        |
| `onPageChange`    | é¡µé¢åˆ‡æ¢æ—¶è§¦å‘ï¼Œç”¨äºæƒé™æ§åˆ¶                    |
| `logout`          | ç‚¹å‡»é€€å‡ºæ—¶è§¦å‘çš„å›è°ƒ                        |
| `initialState`    | ä» `getInitialState` ä¸­è¿”å›çš„åˆå§‹æ•°æ®      |
| `setInitialState` | ä¿®æ”¹åˆå§‹çŠ¶æ€çš„æ–¹æ³•                         |

<br/>

 âœ… æ•´ä½“è¿è¡Œæµç¨‹å›¾ï¼š

```text
ç”¨æˆ·è®¿é—®é¡µé¢
  â†“
umi å…ˆè°ƒç”¨ src/app.ts ä¸­çš„ getInitialState()
  â†“
è¿”å›åˆå§‹çŠ¶æ€ initialStateï¼ˆæ¯”å¦‚å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼‰
  â†“
umi å†è°ƒç”¨ layout({ initialState, setInitialState })
  â†“
ç”Ÿæˆ ProLayout é…ç½®
  â†“
è‡ªåŠ¨æ¸²æŸ“é¡µé¢å¸ƒå±€ï¼Œæ§åˆ¶èœå•ã€é¢åŒ…å±‘ã€æƒé™ç­‰
```

<br/>

 **âœ… getInitialState æ˜¯ä»€ä¹ˆï¼Ÿ**

è¿™æ˜¯å¦ä¸€ä¸ª Umi æ¡†æ¶æ‰©å±•å‡½æ•°ï¼Œä¸€èˆ¬ä¹Ÿå†™åœ¨ `src/app.ts` ä¸­ï¼š

```ts
export async function getInitialState() {
  const currentUser = await fetchCurrentUser();
  return {
    currentUser,
    settings: defaultSettings,
  };
}
```

è¿”å›å€¼ä¼šä¼ å…¥ `layout()` å‡½æ•°ï¼Œè®©ä½ æ§åˆ¶ layout çš„å†…å®¹ï¼ˆå¦‚ç”¨æˆ·æƒé™åˆ¤æ–­ã€èœå•æ¸²æŸ“ç­‰ï¼‰ã€‚

<br/> 

**âœ… å¿«é€Ÿæ€»ç»“**

| ä½ çœ‹åˆ°çš„å†…å®¹                        | è§£é‡Š                                      |
| ----------------------------- | --------------------------------------- |
| `app.tsx`                     | æ˜¯ umi æ¡†æ¶çš„è¿è¡Œæ—¶é…ç½®æ–‡ä»¶ï¼ˆä¸ç­‰äº React çš„ `App.tsx`ï¼‰ |
| `layout: RunTimeLayoutConfig` | ç”¨äºåŠ¨æ€é…ç½®é¡µé¢çš„å¸ƒå±€                             |
| `initialState`                | æ˜¯ `getInitialState()` è¿”å›çš„æ•°æ®ï¼ˆå¦‚å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼‰    |
| umi / antd-pro çš„ layout é…ç½®    | æ§åˆ¶èœå•ã€å¸ƒå±€ã€æ ‡é¢˜ã€æƒé™ç­‰ UI è¡Œä¸º                    |

---
<br/>


**âœ… è¦ä¸Šæ‰‹æ€ä¹ˆåšï¼Ÿ**

ä½ åªéœ€è¦æŒæ¡è¿™ 2 ä¸ªå…³é”®æ–‡ä»¶ï¼š

- 1.**`src/app.ts`** æˆ– `app.tsx`

	* å†™ `getInitialState()` è·å–å…¨å±€æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ï¼‰
	* å†™ `layout()` åŠ¨æ€æ§åˆ¶é¡µé¢å¸ƒå±€è¡Œä¸º

- 2.**é¡µé¢ä¸­ç”¨åˆ°çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥ä» initialState æ‹¿**

```tsx
import { useModel } from '@umijs/max';

const { initialState } = useModel('@@initialState');
console.log(initialState?.currentUser);
```


***
<br/><br/><br/>
> <h2 id="umijsç”Ÿæˆé¦–é¡µ">umijsç”Ÿæˆé¦–é¡µ</h2>

ä¸‹é¢ä¸€å¥— **ã€Œæœ€å°å¯è¿è¡Œâ€¯+â€¯ç»“æ„å®Œæ•´â€¯+â€¯æµç¨‹è¯¦ç»†ã€** çš„ **Umiâ€¯4â€¯/â€¯@umijs/maxâ€¯+â€¯Antâ€¯Designâ€¯Proâ€¯å¸ƒå±€** Demoã€‚

æŒ‰ä¸‹é¢ç›®å½•å»ºå¥½æ–‡ä»¶ï¼Œ`pnpm dev`ï¼ˆæˆ–â€¯npm/yarnï¼‰å³å¯çœ‹åˆ°ç™»å½•é¡µ â†’ ç™»å½•åè‡ªåŠ¨è·³è½¬é¦–é¡µï¼Œå¹¶ä¸”ä¾§è¾¹æ èœå•ä¼šæ ¹æ®ç”¨æˆ·æƒé™åŠ¨æ€æ¸²æŸ“ã€‚æ‰€æœ‰å…³é”®ç‚¹éƒ½åœ¨æ³¨é‡Šé‡Œæ ‡å‡ºæ¥ï¼Œæ–¹ä¾¿ä½ ç…§çŒ«ç”»è™ä¿®æ”¹ã€‚

> âš™ï¸â€¯Demo åŸºäº 2025â€¯å¹´ 6â€¯æœˆæœ€æ–°ç‰ˆ `@umijs/max`ï¼Œå®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ä¿æŒä¸€è‡´ã€‚([umijs.org][1], [github.com][2], [beta-pro.ant.design][3])

<br/>


**1.é¡¹ç›®ç»“æ„ä¸€è§ˆ**

```
my-umi-app/
â”œâ”€ package.json
â”œâ”€ .umirc.ts          # Umi é…ç½®ï¼ˆä¹Ÿå¯ç”¨ config/config.tsï¼‰
â”œâ”€ src/
â”‚  â”œâ”€ app.tsx         # â¶ è¿è¡Œæ—¶é…ç½®ï¼šgetInitialState + layout
â”‚  â”œâ”€ access.ts       # â· æƒé™å®šä¹‰ï¼ˆå¯é€‰ï¼‰
â”‚  â”œâ”€ models/
â”‚  â”‚   â””â”€ global.ts   # â¸ å…¶ä»– model ç¤ºä¾‹
â”‚  â”œâ”€ pages/
â”‚  â”‚   â”œâ”€ Login.tsx
â”‚  â”‚   â”œâ”€ Dashboard.tsx
â”‚  â”‚   â””â”€ Welcome.tsx
â”‚  â””â”€ services/
â”‚      â””â”€ user.ts     # â¹ æ¨¡æ‹Ÿè¯·æ±‚
â””â”€ tsconfig.json
```

- **ä¸ºä»€ä¹ˆæ²¡æœ‰ `App.tsx`ï¼Ÿ**

	* **Umi è‡ªåŠ¨ç”Ÿæˆæ ¹ç»„ä»¶**ï¼Œ`src/app.tsx` åªç”¨æ¥å†™è¿è¡Œæ—¶é’©å­ï¼Œä¸å½“å…¥å£ã€‚çœŸæ­£æŒ‚è½½ç‚¹åœ¨ `.umi` ç›®å½•çš„ä¸´æ—¶ä»£ç é‡Œã€‚([umijs.org][4])

<br/>

**ä» Umi 4 å¼€å§‹ï¼Œæ¨èå°†é…ç½®å†™åœ¨ï¼š**

```sh
config/config.ts
```

è€Œä¸æ˜¯æ—§ç‰ˆæœ¬çš„ .umirc.tsï¼Œä½†å®ƒä»¬ä½œç”¨å®Œå…¨ä¸€æ ·ï¼Œéƒ½ç”¨äºé…ç½®è·¯ç”±ã€æ’ä»¶ã€modelã€layout ç­‰åŠŸèƒ½ã€‚

æ‰€ä»¥ï¼šä½ ç”¨çš„æ˜¯ config/config.tsï¼Œä¸æ˜¯ä½ æ²¡å†™ï¼Œè€Œæ˜¯æ›´æ–°äº†å†™æ³•ã€‚

<br/>

**2.å…³é”®æ–‡ä»¶é€ä¸ªçœ‹**

**2â€‘1Â `.umirc.ts`Â ï¼ˆè·¯ç”± & æ’ä»¶é…ç½®ï¼‰**

```ts
import { defineConfig } from '@umijs/max';

export default defineConfig({
  npmClient: 'pnpm',
  // å¼€å¯å†…ç½® layoutã€initialStateã€modelã€access ç­‰åŠŸèƒ½
  plugins: ['@umijs/plugins/dist/antd'],
  antd: {},          // è‡ªåŠ¨æŒ‰éœ€å¼•å…¥ antd@5
  model: {},         // å¯ç”¨ useModel
  initialState: {},  // å¯ç”¨ getInitialState
  access: {},        // å¯ç”¨æƒé™
  layout: {},        // å¯ç”¨ ProLayout
  routes: [
    { path: '/login', component: 'Login', layout: false },
    {
      path: '/',
      component: 'Dashboard',
      access: 'canViewDashboard',   // ç”¨ access.ts æ ¡éªŒ
    },
    { path: '/welcome', component: 'Welcome' },
  ],
});
```

<br/>

**2â€‘2Â `src/services/user.ts`Â ï¼ˆæ¨¡æ‹Ÿæ¥å£ï¼‰**

```ts
export async function fakeLogin(body: { user: string; pwd: string }) {
  return new Promise<{ token: string }>((res) =>
    setTimeout(() => res({ token: 'jwt-token' }), 600),
  );
}

export async function fetchCurrentUser() {
  return new Promise<{ name: string; role: 'admin' | 'guest' }>((res) =>
    setTimeout(() => res({ name: 'Harley', role: 'admin' }), 500),
  );
}
```

<br/>

 **2â€‘3Â `src/app.tsx`Â â€” æ ¸å¿ƒï¼šgetInitialStateâ€¯+â€¯layout**

```tsx
import type { RunTimeLayoutConfig } from '@umijs/max';
import { history } from '@umijs/max';
import { fetchCurrentUser } from '@/services/user';

// â¶ å…¨å±€åˆå§‹åŒ– â€”â€” é¡µé¢é¦–æ¬¡åŠ è½½ä¼šé˜»å¡ï¼Œæ‹‰å–ç”¨æˆ·ä¿¡æ¯
export async function getInitialState() {
  const { location } = history;
  if (location.pathname !== '/login') {
    try {
      const currentUser = await fetchCurrentUser();
      return { currentUser };
    } catch {
      history.push('/login');
    }
  }
  return { currentUser: undefined };
}

// â· Layout è¿è¡Œæ—¶é…ç½® â€”â€” åŠ¨æ€æ ‡é¢˜ / é€€å‡º / æƒé™è·³è½¬
export const layout: RunTimeLayoutConfig = ({
  initialState,
  setInitialState,
}) => {
  return {
    title: 'æ¼”ç¤ºåå°',
    fixSiderbar: true,
    // æ¯æ¬¡è·¯ç”±å˜åŒ–è§¦å‘
    onPageChange: () => {
      const { location } = history;
      // æ²¡ç™»é™†å°±å¼ºåˆ¶å» login
      if (!initialState?.currentUser && location.pathname !== '/login') {
        history.push('/login');
      }
    },
    // é€€å‡ºç™»å½•
    logout: async () => {
      setInitialState({ currentUser: undefined });
      history.push('/login');
    },
    // å³ä¸Šè§’å¤´åƒã€å›½é™…åŒ–ç­‰æ‰©å±•è§å®˜æ–¹ API
  };
};
```

> * `initialState` å°±æ˜¯ `getInitialState` è¿”å›å€¼
> * `setInitialState` å¯ä»¥åœ¨ä»»æ„ç»„ä»¶åˆ·æ–°å…¨å±€æ•°æ®ï¼ˆä¾‹å¦‚é€€å‡ºç™»å½•åæ¸…ç©ºï¼‰
> * æ‰€æœ‰å¸ƒå±€å¯ç”¨å±æ€§è¯¦è§ ProLayout æ–‡æ¡£ã€‚([umijs.org][1])

<br/> 

**2â€‘4Â `src/access.ts`Â ï¼ˆæƒé™å‡½æ•°ï¼‰**

```ts
import { InitialState } from '@umijs/max';

export default (initialState: InitialState) => ({
  canViewDashboard: !!initialState?.currentUser, // åªè¦ç™»å½•å°±èƒ½çœ‹
});
```

<br/> 

**2â€‘5Â `src/pages/Login.tsx`**

```tsx
import { Button, Form, Input, message } from 'antd';
import { history, useModel } from '@umijs/max';
import { fakeLogin } from '@/services/user';

export default () => {
  const { setInitialState } = useModel('@@initialState');

  const onFinish = async (values: { user: string; pwd: string }) => {
    try {
      await fakeLogin(values);
      // æ¨¡æ‹Ÿæ‹¿åˆ°ç”¨æˆ·ä¿¡æ¯
      setInitialState({ currentUser: { name: values.user, role: 'admin' } });
      history.push('/');
    } catch {
      message.error('ç™»å½•å¤±è´¥');
    }
  };

  return (
    <Form onFinish={onFinish} style={{ maxWidth: 300, margin: '120px auto' }}>
      <Form.Item name="user">
        <Input placeholder="ç”¨æˆ·å" />
      </Form.Item>
      <Form.Item name="pwd">
        <Input.Password placeholder="å¯†ç " />
      </Form.Item>
      <Button type="primary" htmlType="submit" block>
        ç™»å½•
      </Button>
    </Form>
  );
};
```

<br/> 

**2â€‘6Â `src/pages/Dashboard.tsx`**

```tsx
import { PageContainer } from '@ant-design/pro-components';
import { useModel } from '@umijs/max';

export default () => {
  const { initialState } = useModel('@@initialState');
  return (
    <PageContainer>
      <h2>æ¬¢è¿ {initialState?.currentUser?.name}</h2>
    </PageContainer>
  );
};
```

<br/> 

**3.è¿è¡Œ & ä½“éªŒ**

```bash
pnpm i
pnpm dev
```

1. å…ˆè·³è½¬åˆ° `/login`
2. ç™»å½•æˆåŠŸåå†™å…¥ `initialState.currentUser`
3. Layoutâ€¯`onPageChange` æ£€æµ‹åˆ°å·²ç™»å½•ï¼Œæ­£å¸¸è¿›å…¥ `/`
4. é€€å‡ºç™»å½•è§¦å‘ `layout.logout`ï¼Œé‡ç½®çŠ¶æ€å¹¶å›åˆ°ç™»å½•é¡µ

<br/>

 **4.å…³é”®æ¦‚å¿µä¸²è”**

```
getInitialState      â€”â€”>  é¡µé¢é¦–å±é˜»å¡è¯·æ±‚ï¼Œå…¨å±€æ•°æ®ï¼ˆç”¨æˆ·ï¼‰
            â”‚
            â†“
 layout()   â€”â€”>  è¯»å– initialStateï¼Œå†³å®š Layout è¡Œä¸ºï¼ˆæ ‡é¢˜ / æƒé™ / èœå•ï¼‰
            â”‚
            â†“
 useModel('@@initialState')  â€”â€”>  ä»»æ„ç»„ä»¶è¯» / å†™ å…¨å±€çŠ¶æ€
```

è¿™ä¸€å¥—æ˜¯ **Umiâ€¯Max Dataâ€¯Flow æ’ä»¶**ï¼ˆinitialâ€‘state + model + layoutï¼‰çš„å®Œæ•´é—­ç¯ã€‚([umijs.org][4])

<br/> 

**5.ä¸‹ä¸€æ­¥èƒ½åšä»€ä¹ˆï¼Ÿ**

| éœ€æ±‚         | æ€è·¯                                                                    |
| ---------- | --------------------------------------------------------------------- |
| åŠ¨æ€èœå•ï¼ˆåç«¯è¿”å›ï¼‰ | æŠŠ `menu` å®šä¹‰å†™è¿› `layout()`ï¼š`menu: { request: async () => fetchMenu() }` |
| ç»†ç²’åº¦æƒé™      | åœ¨ `access.ts` å¤šè¿”å›å‡ ä¸ªå‡½æ•°ï¼Œåœ¨è·¯ç”± `access:` å­—æ®µç»‘å®š                              |
| SSR / SSG  | Umiâ€¯4 é»˜è®¤å†…å»ºï¼Œå¯åœ¨ `config exportStatic / ssr` å¼€å…³                          |
| å›½é™…åŒ–        | æ’ä»¶ `@umijs/plugins/dist/locale`ï¼Œç»“åˆ ProLayout `locale: true`           |


***
<br/><br/><br/>
> <h2 id="å…¥å£æ–‡ä»¶ä¸­çš„app.tsxæ²¡æœ‰çœ‹åˆ°layoutè°ƒç”¨ï¼Ÿ">å…¥å£æ–‡ä»¶ä¸­çš„app.tsxæ²¡æœ‰çœ‹åˆ°layoutè°ƒç”¨ï¼Ÿ</h2>

**æé—®ï¼š** `export const layout: RunTimeLayoutConfig = (...)` è¿™ä¸ªä¸œè¥¿ **â€œåœ¨å“ªç”¨çš„ï¼Ÿâ€**ï¼Œ**ä¸ºä»€ä¹ˆæˆ‘åœ¨é¡¹ç›®ä¸­æ²¡çœ‹åˆ°å®ƒè¢«è°ƒç”¨ï¼Œä½†å®ƒå´ç”Ÿæ•ˆäº†ï¼Ÿ**

<br/>

è¿™æ˜¯ **Umi / @umijs/max æ¡†æ¶çš„è¿è¡Œæ—¶é’©å­å‡½æ•°**ï¼Œä½  **ä¸ä¼šåœ¨é¡¹ç›®ä¸­æ‰‹åŠ¨è°ƒç”¨å®ƒ**ï¼Œå®ƒæ˜¯ç”±æ¡†æ¶è‡ªåŠ¨è°ƒç”¨çš„ã€‚
åªè¦ä½ å†™åœ¨ `src/app.ts` æˆ– `src/app.tsx` ä¸­ï¼Œ**Umi å°±ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶åœ¨è¿è¡Œæ—¶è°ƒç”¨å®ƒ**ã€‚

<br/>

**âœ… èƒŒåé€»è¾‘ï¼šUmi çš„æ’ä»¶æœºåˆ¶åšäº†è¿™ä»¶äº‹**

Umi æ¡†æ¶å†…ç½®äº† `@umijs/plugin-layout` æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶åœ¨é¡¹ç›®æ„å»ºæ—¶ï¼š

1. æ£€æŸ¥ä½ æ˜¯å¦å¯ç”¨äº† layout åŠŸèƒ½ï¼ˆ`layout: {}` åœ¨ `.umirc.ts` æˆ– `config/config.ts`ï¼‰
2. è‡ªåŠ¨åŠ è½½ `src/app.ts` æ–‡ä»¶
3. æ‰¾åˆ°ä½ å¯¼å‡ºçš„è¿™ä¸ª `layout` å‡½æ•°
4. è‡ªåŠ¨å°†ä½ è¿”å›çš„å¯¹è±¡åˆå¹¶è¿› Ant Design ProLayout çš„é…ç½®ä¸­

<br/>

**âœ… æ‰€ä»¥å®ƒå°±è¿™æ ·ç”Ÿæ•ˆäº†ï¼š**

ä½ ä¸éœ€è¦æ˜¾å¼è°ƒç”¨ï¼š

```ts
layout(); // âŒ ä¸éœ€è¦ä½ å†™ï¼
```

ä½†å®é™… Umi åœ¨å†…éƒ¨ä¼šæ‰§è¡Œç±»ä¼¼è¿™æ ·çš„æµç¨‹ï¼ˆä¼ªä»£ç ï¼‰ï¼š

```ts
import { getInitialState, layout as layoutRuntime } from './app.tsx';

const initialState = await getInitialState();

const layoutConfig = layoutRuntime({ initialState, setInitialState });

render(<ProLayout {...layoutConfig} />);
```

<br/>

 **âœ… layout() èƒ½åšå“ªäº›äº‹ï¼Ÿ**

ä½ è¿”å›çš„å¯¹è±¡ï¼Œä¼šç›´æ¥ä¼ ç»™ Ant Design Pro çš„ `<ProLayout />`ï¼Œæ‰€ä»¥ä½ å¯ä»¥é…ç½®éå¸¸å¤šä¸œè¥¿ï¼š

| é…ç½®é¡¹                  | ä½œç”¨                           |
| -------------------- | ---------------------------- |
| `title`              | é¡µé¢æ ‡é¢˜                         |
| `logo`               | å·¦ä¸Šè§’ Logo                     |
| `onPageChange`       | æ¯æ¬¡è·¯ç”±å˜åŒ–æ—¶è§¦å‘ï¼ˆå¯ç”¨äºæƒé™æ£€æµ‹ï¼‰           |
| `menu`               | è‡ªå®šä¹‰èœå•æ¸²æŸ“é€»è¾‘ï¼ˆå¦‚åŠ¨æ€èœå•ï¼‰             |
| `layout`             | å¸ƒå±€ç»“æ„ï¼ˆ`side` / `mix` / `top`ï¼‰ |
| `logout`             | ç‚¹å‡»é€€å‡ºç™»å½•åæ‰§è¡Œçš„åŠ¨ä½œ                 |
| `rightContentRender` | é¡¶éƒ¨å³ä¾§æ¸²æŸ“ï¼ˆå¤´åƒã€è¯­è¨€ç­‰ï¼‰               |
| `waterMarkProps`     | æ°´å°è®¾ç½®ï¼ˆå¦‚æ˜¾ç¤ºç”¨æˆ·åï¼‰                 |



***
<br/><br/><br/>
> <h2 id="ProLayoutå¸ƒå±€å±æ€§">ProLayoutå¸ƒå±€å±æ€§</h2>


## âœ… layout() è¿”å›çš„å±æ€§è¯¦è§£ï¼ˆå«æ¡ˆä¾‹ï¼‰

è¿™äº›å±æ€§ä¼šä¼ å…¥ [ProLayout](https://procomponents.ant.design/components/layout) ç»„ä»¶ï¼Œç”¨æ¥æ§åˆ¶é¡µé¢å¸ƒå±€å¤–è§‚ã€è¡Œä¸ºã€èœå•ã€å¤´éƒ¨ã€åº•éƒ¨ç­‰ç­‰ã€‚

---

### 1. `rightContentRender`

ğŸ‘‰ æ§åˆ¶å³ä¸Šè§’åŒºåŸŸï¼ˆå¦‚å¤´åƒã€è¯­è¨€ã€é€€å‡ºæŒ‰é’®ï¼‰

```ts
rightContentRender: () => <div>ğŸ‘¤ ç”¨æˆ·</div>,
```

å¸¸è§å†™æ³•ï¼š

```tsx
rightContentRender: () => <Avatar src="/avatar.png" />
```

---

### 2. `selectedKeys` / `openKeys`

ğŸ‘‰ æ‰‹åŠ¨æ§åˆ¶èœå•çš„é€‰ä¸­é¡¹ / å±•å¼€é¡¹ï¼ˆå¦‚æœä½ ä¸ç”¨è‡ªåŠ¨èœå•ï¼‰

```ts
selectedKeys: ['/product/list'],
openKeys: ['/product'],
```

å¤šæ•°æ—¶å€™ä½ ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®ï¼Œé»˜è®¤èƒ½æ ¹æ® `location.pathname` åŒ¹é…ã€‚

---

### 3. `disableContentMargin`

ğŸ‘‰ æ˜¯å¦å…³é—­é¡µé¢å†…å®¹çš„é»˜è®¤ paddingï¼ˆé»˜è®¤ä¸º trueï¼‰

```ts
disableContentMargin: true,
```

é…åˆè‡ªå®šä¹‰ `contentStyle` å¯åšå…¨å±é¡µé¢ã€‚

---

### 4. `logo`

ğŸ‘‰ è®¾ç½®å·¦ä¸Šè§’ logoï¼ˆå¯ä¼  URLã€ç»„ä»¶æˆ– falseï¼‰

```ts
logo: '/logo.svg',
// æˆ– logo: () => <img src="/logo.svg" />
```

è®¾ç½®ä¸º `false` å¯ä»¥éšè—ã€‚

---

### 5. `bgLayoutImgList`

ğŸ‘‰ è®¾ç½®èƒŒæ™¯å›¾æ°´å°ï¼Œå¸¸ç”¨äºèŠ±å“¨ç™»å½•é¡µï¼ˆå°‘ç”¨ï¼‰

```ts
bgLayoutImgList: [
  {
    src: '/bg1.png',
    left: 85,
    bottom: 100,
    height: '303px',
  },
]
```

---

### 6. `links`

ğŸ‘‰ è®¾ç½®èœå•å·¦ä¸‹è§’çš„é“¾æ¥åŒºåŸŸï¼ˆå¸¸ç”¨äºæ–‡æ¡£ã€APIã€æ”¯æŒï¼‰

```ts
links: [
  <a href="/docs" key="doc">æ–‡æ¡£</a>,
  <a href="/api" key="api">API</a>
]
```

---

### 7. `menuHeaderRender`

ğŸ‘‰ è‡ªå®šä¹‰æ•´ä¸ª logo åŒº + æ ‡é¢˜ çš„æ¸²æŸ“

```ts
menuHeaderRender: (logoDom, titleDom, props) => (
  <div onClick={() => history.push('/')}>
    {logoDom} {titleDom}
  </div>
)
```

ä½ å¯ä»¥ç‚¹å‡» logo è‡ªåŠ¨å›é¦–é¡µç­‰ã€‚

---

### 8. `collapsedButtonRender`

ğŸ‘‰ è‡ªå®šä¹‰æ”¶èµ·èœå•æŒ‰é’®çš„æ¸²æŸ“

```ts
collapsedButtonRender: (collapsed) => (
  <span>{collapsed ? 'ğŸ‘‰ å±•å¼€' : 'ğŸ‘ˆ æ”¶èµ·'}</span>
)
```

---

### 9. `onOpenChange`

ğŸ‘‰ èœå•å±•å¼€é¡¹å˜åŒ–æ—¶è§¦å‘ï¼Œå¯ç”¨äºç¼“å­˜èœå•çŠ¶æ€

```ts
onOpenChange: (keys) => {
  localStorage.setItem('openKeys', JSON.stringify(keys));
}
```

---

### 10. `menuDataRender`

ğŸ‘‰ è‡ªå®šä¹‰èœå•ç»“æ„ï¼ˆå¦‚æƒé™è¿‡æ»¤ï¼‰

```ts
menuDataRender: (menuData) =>
  menuData.filter((item) => item.name !== 'éšè—èœå•'),
```

å¯ä»¥ç»“åˆç”¨æˆ·è§’è‰²è¿›è¡Œè¿‡æ»¤ï¼š

```ts
menuDataRender: (menuData) =>
  menuData.filter((item) =>
    item.roles?.includes(initialState?.currentUser?.role),
  ),
```

---

### 11. `childrenRender`

ğŸ‘‰ è‡ªå®šä¹‰æ•´ä¸ªé¡µé¢å†…å®¹çš„æ¸²æŸ“æ–¹å¼ï¼ˆåµŒå¥—æ°´å°ã€èƒŒæ™¯ã€åˆ‡æ¢åŠ¨ç”»ç­‰ï¼‰

```tsx
childrenRender: (dom) => (
  <div style={{ background: '#fafafa', padding: 16 }}>
    {dom}
  </div>
)
```

---

### 12. `...initialState`

ğŸ‘‰ è§£æ„æ³¨å…¥ layout é…ç½®ä¸­çš„å€¼ï¼Œç”¨äºè¯»å– `settings` ç­‰ï¼ˆå¦‚ä¸»é¢˜ã€é¢œè‰²ç­‰ï¼‰

```ts
return {
  ...initialState?.settings,
  title: 'æˆ‘çš„ç³»ç»Ÿ',
};
```

---

### 13. `footerRender`

ğŸ‘‰ è‡ªå®šä¹‰é¡µé¢åº•éƒ¨ Footer çš„æ¸²æŸ“

```tsx
footerRender: () => (
  <div style={{ textAlign: 'center' }}>Â©2025 Harley ç‰ˆæƒæ‰€æœ‰</div>
)
```

---

### 14. `contentStyle`

ğŸ‘‰ æ§åˆ¶ `PageContainer` å¤–å±‚å†…å®¹çš„æ ·å¼ï¼ˆpaddingã€èƒŒæ™¯ï¼‰

```ts
contentStyle: {
  margin: 0,
  padding: 24,
  background: '#f5f5f5',
},
```

---

### 15. `token`

ğŸ‘‰ è‡ªå®šä¹‰ ProLayout çš„ä¸»é¢˜ Tokenï¼ˆä¾‹å¦‚ä¾§è¾¹æ é¢œè‰²ã€å­—ä½“ç­‰ï¼‰

```ts
token: {
  header: {
    colorBgHeader: '#ffffff',
    colorTextRightActionsItem: '#000000',
  },
  sider: {
    colorMenuBackground: '#001529',
    colorTextMenuSelected: '#1890ff',
  },
}
```

---

## âœ… layout() ä¸­å±æ€§å¤§åˆ†ç±»å½’çº³

| åˆ†ç±»      | å±æ€§                                                           | ç¤ºä¾‹                  |
| ------- | ------------------------------------------------------------ | ------------------- |
| å¸ƒå±€ç»“æ„    | `layout`, `fixedHeader`, `fixSiderbar`                       | `layout: 'mix'`     |
| æ ‡é¢˜ Logo | `title`, `logo`, `menuHeaderRender`                          | `logo: '/logo.svg'` |
| é¡µé¢å†…å®¹    | `contentStyle`, `disableContentMargin`, `childrenRender`     |                     |
| é¡¶éƒ¨å³ä¾§    | `rightContentRender`                                         | è‡ªå®šä¹‰å¤´åƒ/é€€å‡ºæŒ‰é’®          |
| èœå•è¡Œä¸º    | `selectedKeys`, `openKeys`, `onOpenChange`, `menuDataRender` |                     |
| èƒŒæ™¯å›¾     | `bgLayoutImgList`                                            |                     |
| åº•éƒ¨      | `footerRender`                                               |                     |
| æƒé™æ§åˆ¶    | `onPageChange`, `access`, `logout`                           |                     |
| ä¸»é¢˜é£æ ¼    | `token`, `...initialState?.settings`                         |                     |

---

## âœ… ç¤ºä¾‹ï¼šè¿”å›ä¸€å¥—å®Œæ•´é…ç½®ï¼ˆç®€åŒ–ç‰ˆï¼‰

```ts
export const layout: RunTimeLayoutConfig = ({ initialState, setInitialState }) => ({
  title: 'åå°ç³»ç»Ÿ',
  layout: 'mix',
  fixSiderbar: true,
  rightContentRender: () => <Avatar src="/avatar.jpg" />,
  menuDataRender: (menu) => menu.filter((item) => item.name !== 'éšè—'),
  onPageChange: () => {
    if (!initialState?.currentUser) {
      history.push('/login');
    }
  },
  logout: async () => {
    setInitialState({ currentUser: undefined });
    history.push('/login');
  },
  footerRender: () => <div>Â©2025 Harley</div>,
  token: {
    header: {
      colorBgHeader: '#fff',
    },
    sider: {
      colorMenuBackground: '#001529',
    },
  },
});
```


<br/><br/><br/>

***
<br/>
> <h1 id="å…¨å±€ä¸»é¢˜é…ç½®">å…¨å±€ä¸»é¢˜é…ç½®</h1>


 **âœ… ä¸€ã€`<ConfigProvider theme={theme}>`**

ğŸ”¹ ä½œç”¨ï¼šå…¨å±€ä¸»é¢˜é…ç½®

Ant Design v5 èµ·æ”¯æŒâ€œ**å…¨å±€ä¸»é¢˜å®šåˆ¶**â€ï¼Œä½¿ç”¨ `<ConfigProvider theme={...}>` ä½ å¯ä»¥ï¼š

* è®¾ç½®ç³»ç»Ÿä¸»è‰²ï¼ˆprimaryColorï¼‰
* å¯ç”¨æš—é»‘æ¨¡å¼
* æ§åˆ¶åœ†è§’ã€å­—ä½“ã€é¢œè‰²ç­‰ Token
* æ§åˆ¶ç»„ä»¶é»˜è®¤è¡Œä¸ºï¼ˆå¦‚ Formã€Button ç­‰ï¼‰

<br/>

**âœ… ä½¿ç”¨æ–¹æ³•**

 **1. å¯¼å…¥ï¼š**

```tsx
import { ConfigProvider } from 'antd';
```

<br/>

**2. åŒ…è£¹ä½ çš„æ ¹ç»„ä»¶ï¼š**

```tsx
const App = () => {
  return (
    <ConfigProvider
      theme={{
        token: {
          colorPrimary: '#1890ff',
          borderRadius: 6,
          colorBgContainer: '#f0f2f5',
        },
        components: {
          Button: {
            colorPrimary: '#52c41a',
            borderRadius: 4,
          },
        },
      }}
    >
      <YourRoutesOrLayout />
    </ConfigProvider>
  );
};
```

<br/>

**âœ… å¸¸ç”¨é…ç½®é¡¹**

| é…ç½®ä½ç½®         | ç¤ºä¾‹                                           | è¯´æ˜                     |
| ------------ | -------------------------------------------- | ---------------------- |
| `token`      | `colorPrimary` / `fontSize` / `borderRadius` | è®¾ç½®å…¨å±€æ ·å¼å˜é‡               |
| `components` | é’ˆå¯¹æŸä¸ªç»„ä»¶å•ç‹¬å®šåˆ¶æ ·å¼                                 | å¦‚ Buttonã€Inputã€Table ç­‰ |

> âœ… è¿™å¯ä»¥è®©ä½ çš„æ•´ä¸ªç³»ç»Ÿæ‹¥æœ‰ç»Ÿä¸€é£æ ¼ï¼Œéå¸¸é€‚åˆåå°ç³»ç»Ÿç»Ÿä¸€å®šåˆ¶ã€‚


***
<br/><br/><br/>
> <h2 id="Breadcrumbæ˜¾ç¤ºå½“å‰å¯¼èˆªè·¯å¾„">Breadcrumbæ˜¾ç¤ºå½“å‰å¯¼èˆªè·¯å¾„</h2>

- **ğŸ”¹ ä½œç”¨ï¼šæ˜¾ç¤ºå½“å‰ä½ç½®çš„è·¯å¾„å¯¼èˆª**

å®ƒç”¨äºå¸®åŠ©ç”¨æˆ·æ˜ç¡®å½“å‰é¡µé¢åœ¨ç«™ç‚¹ç»“æ„ä¸­çš„ä½ç½®ã€‚

æ¯”å¦‚ï¼š
`é¦–é¡µ / äº§å“ç®¡ç† / äº§å“è¯¦æƒ…`

<br/>

**âœ… åŸºæœ¬ç”¨æ³•**

```tsx
import { Breadcrumb } from 'antd';
import { HomeOutlined } from '@ant-design/icons';

<Breadcrumb
  items={[
    {
      title: <HomeOutlined />,
      href: '/',
    },
    {
      title: 'äº§å“ç®¡ç†',
    },
    {
      title: 'äº§å“è¯¦æƒ…',
    },
  ]}
/>
```

<br/>

**âœ… æ­é… Umi è‡ªåŠ¨é¢åŒ…å±‘ï¼ˆProLayoutï¼‰**

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ `@umijs/max` + `layout()`ï¼Œå¹¶å¯ç”¨äº†è·¯ç”±çš„ `name` å­—æ®µï¼Œç³»ç»Ÿä¼š**è‡ªåŠ¨æ¸²æŸ“é¢åŒ…å±‘**ã€‚


```ts
{
  path: '/product',
  name: 'äº§å“ç®¡ç†',
  routes: [
    {
      path: '/product/list',
      name: 'äº§å“åˆ—è¡¨',
      component: './ProductList',
    },
  ],
}
```

<br/>

**é¡µé¢é¡¶éƒ¨å°±ä¼šè‡ªåŠ¨å‡ºç°ï¼š**

```
äº§å“ç®¡ç† / äº§å“åˆ—è¡¨
```

<br/>

**âœ… è‡ªå®šä¹‰é¢åŒ…å±‘ï¼ˆåœ¨é¡µé¢ä¸­ï¼‰**

å¦‚æœä½ æƒ³åœ¨é¡µé¢ä¸­è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥ï¼š

```tsx
import { PageContainer } from '@ant-design/pro-components';

<PageContainer
  breadcrumb={{
    items: [
      { title: 'é¦–é¡µ', href: '/' },
      { title: 'äº§å“ç®¡ç†' },
      { title: 'äº§å“åˆ—è¡¨' },
    ],
  }}
>
  {/* é¡µé¢å†…å®¹ */}
</PageContainer>
```

<br/>

**âœ… æ•ˆæœå›¾è¯´æ˜**

| ç»„ä»¶                          | ä½œç”¨              | å¸¸è§ä½ç½®          |
| --------------------------- | --------------- | ------------- |
| `<ConfigProvider theme={}>` | è®¾ç½®æ•´ä¸ªç³»ç»Ÿçš„é¢œè‰²ã€åœ†è§’ã€æ ·å¼ | App æ ¹ç»„ä»¶       |
| `<Breadcrumb />`            | æ˜¾ç¤ºé¡µé¢è·¯å¾„å¯¼èˆª        | é¡µé¢é¡¶éƒ¨ã€Header ä¸‹ |


æ•ˆæœå›¾ï¼š
![react0.0.0.0.png](./../Pictures/react0.0.0.0.png)



***
<br/><br/><br/>
> <h2 id="Modalå¼¹çª—è¡¨æ ¼å±æ€§ä»‹ç»">Modalå¼¹çª—è¡¨æ ¼å±æ€§ä»‹ç»</h2>

```js
const ModelPageView = ({
  isVisible,
  onCancel,
  onOk,
  productId,
  productVersionId,
  moduleData,
  title,
  ...restProps
}) => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [form] = Form.useForm();
  const intl = useIntl();

  useEffect(() => {
    form.setFieldsValue(moduleData);
    argusLog('moduleData', moduleData);
  }, [moduleData]);

	return (
		<div></div>
	)
 );
};

export default ModelPageView;
```

è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå…¸å‹çš„ **React å‡½æ•°ç»„ä»¶**ï¼Œç”¨äºæ¸²æŸ“ä¸€ä¸ªå¼¹çª—ã€è¡¨å•æˆ–ç¼–è¾‘è§†å›¾çš„é¡µé¢ï¼ˆçŒœæµ‹å¯èƒ½æ˜¯å¼¹çª—å½¢å¼çš„æ¨¡å—ç¼–è¾‘æˆ–è¯¦æƒ…æŸ¥çœ‹é¡µé¢ï¼‰ï¼Œå®ƒä½¿ç”¨äº† **Ant Design çš„ Formã€React Hook å’Œå›½é™…åŒ–å·¥å…·**ã€‚

<br/>

**âœ… 1. ç»„ä»¶å®šä¹‰éƒ¨åˆ†**

```tsx
const ModelPageView = ({
  isVisible,
  onCancel,
  onOk,
  productId,
  productVersionId,
  moduleData,
  title,
  ...restProps
}) => {
```

<br/>

**ğŸ” è§£é‡Šï¼š**

è¿™æ˜¯ä¸€ä¸ª **å‡½æ•°ç»„ä»¶ï¼ˆFunction Componentï¼‰**ï¼Œåå« `ModelPageView`ï¼Œå®ƒæ¥æ”¶ä¸€ç»„ propsï¼ˆå±æ€§ï¼‰ï¼Œè§£æ„å‚æ•°å¦‚ä¸‹ï¼š

| å‚æ•°å                | è¯´æ˜                                        |
| ------------------ | ----------------------------------------- |
| `isVisible`        | æ§åˆ¶å¼¹çª—æ˜¯å¦æ˜¾ç¤ºï¼ˆæ¯”å¦‚ `<Modal visible={isVisible}`ï¼‰ |
| `onCancel`         | ç‚¹å‡»â€œå–æ¶ˆâ€æŒ‰é’®æ—¶çš„å›è°ƒå‡½æ•°                            |
| `onOk`             | ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®æ—¶çš„å›è°ƒå‡½æ•°                            |
| `productId`        | äº§å“ IDï¼ˆä¸šåŠ¡å‚æ•°ï¼‰                               |
| `productVersionId` | äº§å“ç‰ˆæœ¬ IDï¼ˆä¸šåŠ¡å‚æ•°ï¼‰                             |
| `moduleData`       | æ¨¡å—æ•°æ®ï¼ˆç”¨äºè¡¨å•åˆå§‹å€¼ï¼‰                             |
| `title`            | å¼¹çª—æ ‡é¢˜æˆ–é¡µé¢æ ‡é¢˜                                 |
| `...restProps`     | å…¶ä»–é€ä¼ å±æ€§                                    |

<br/>

**âœ… 2. çŠ¶æ€å’Œè¡¨å•åˆå§‹åŒ–**

```tsx
const [isSubmitting, setIsSubmitting] = useState(false);
const [form] = Form.useForm();
const intl = useIntl();
```


**ğŸ” è§£é‡Šï¼š**

| å˜é‡             | ç±»å‹              | è¯´æ˜                                                                 |
| -------------- | --------------- | ------------------------------------------------------------------ |
| `isSubmitting` | `boolean` çŠ¶æ€    | æ§åˆ¶â€œæäº¤ä¸­â€æŒ‰é’® loading çŠ¶æ€                                               |
| `form`         | Ant Design è¡¨å•å®ä¾‹ | ç”¨äºç»‘å®š `<Form form={form}>` è¡¨å•                                       |
| `intl`         | å›½é™…åŒ–å¯¹è±¡           | æ¥è‡ª `react-intl` æˆ– `umi` çš„ `useIntl()`ï¼Œç”¨äº `formatMessage()` è·å–å¤šè¯­è¨€å†…å®¹ |

<br/>


**âœ… 3. useEffectï¼šå½“ `moduleData` å˜åŒ–æ—¶æ›´æ–°è¡¨å•å†…å®¹**

```tsx
useEffect(() => {
  form.setFieldsValue(moduleData);
  argusLog('moduleData', moduleData);
}, [moduleData]);
```


**ğŸ” è§£é‡Šï¼š**

* `useEffect(..., [moduleData])`ï¼šç›‘å¬ `moduleData` å˜åŒ–ï¼›
* `form.setFieldsValue()`ï¼šå°†æ¨¡å—æ•°æ®è®¾ç½®è¿›è¡¨å•ä¸­ï¼›
* `argusLog(...)`ï¼šç”¨äºæ‰“ç‚¹æ—¥å¿—æˆ–è°ƒè¯•ï¼ˆè‡ªå®šä¹‰çš„æ—¥å¿—å‡½æ•°ï¼‰ã€‚

<br/> 

**âœ… 4. è¿”å›éƒ¨åˆ†ï¼ˆæœªå®ç° UIï¼‰**


è¿™æ®µä»£ç ä¸­çš„è¿”å› JSX æ˜¯ç©ºçš„ `<div>`ï¼Œè¯´æ˜ **UI éƒ¨åˆ†è¿˜æ²¡å†™**ã€‚å®é™…ä¸­ä½ ä¼šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹ç»“æ„ï¼š

```tsx
return (
  <Modal
    visible={isVisible}
    title={title}
    onCancel={onCancel}
    onOk={handleSubmit}
    confirmLoading={isSubmitting}
    {...restProps}
  >
    <Form form={form} layout="vertical">
      <Form.Item name="name" label="æ¨¡å—åç§°">
        <Input />
      </Form.Item>
    </Form>
  </Modal>
);
```

<br/>

 5. **æ€»ç»“æ•´ä½“åŠŸèƒ½ï¼š**

è¿™ä¸ªç»„ä»¶ **ModelPageView** æ˜¯ä¸€ä¸ªç”¨äºæ˜¾ç¤ºæ¨¡å—ä¿¡æ¯çš„ UI é¡µé¢ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªè¡¨å•å¼¹çª—ï¼Œæœ‰ä»¥ä¸‹ç”¨é€”ï¼š

| åŠŸèƒ½      | å®ç°                               |
| ------- | -------------------------------- |
| æ•°æ®å±•ç¤ºæˆ–ç¼–è¾‘ | é€šè¿‡ `moduleData` ä¼ å…¥å·²æœ‰æ•°æ®           |
| è¡¨å•å¤„ç†    | ä½¿ç”¨ `form.setFieldsValue()` è®¾ç½®åˆå§‹å€¼ |
| ç”¨æˆ·æ“ä½œ    | é€šè¿‡ `onOk`ã€`onCancel` æ§åˆ¶äº¤äº’        |
| å›½é™…åŒ–     | ä½¿ç”¨ `useIntl()` æ”¯æŒå¤šè¯­è¨€æ–‡æœ¬           |
| æäº¤çŠ¶æ€    | `isSubmitting` æ§åˆ¶æŒ‰é’® loading æ•ˆæœ   |


***
<br/><br/><br/>
> <h2 id="Formè¡¨æ ¼ä½¿ç”¨">Formè¡¨æ ¼ä½¿ç”¨</h2>

**æœ‰å¦‚ä¸‹ä»£ç ä½¿ç”¨ï¼š**

```js
<Form
  form={form1}
  labelCol={{ span: 6 }}
  wrapperCol={{ span: 18 }}
  onFinish={onFinish}
  onValuesChange={({ isUniversal }) => {
    setIsUniversal(isUniversal);
  }}
>
```

ä¸Šè¿°çš„**Form**è¡¨å•å±æ€§å¦‚ä½•ä½¿ç”¨ï¼Ÿ[**è¯·çœ‹è¿™é‡Œ**](./CMReactNotes.md#Formè¡¨å•åŸºæœ¬å±æ€§è®²è§£)



***
<br/><br/><br/>
> <h2 id="è¡¨å•æäº¤æ•°æ®">è¡¨å•æäº¤æ•°æ®</h2>

å¯¹äºantdä¸­çš„Formç»„ä»¶ï¼Œä½ æ˜¯å¦‚ä½•æäº¤è¡¨å•ä¸­çš„æ‰€æœ‰å­—æ®µå€¼å‘¢ï¼Ÿ[**è¯·çœ‹è¿™é‡Œ**](./CMReactNotes.md#Formæäº¤å¡«å†™çš„æ•°æ®å­—æ®µå€¼)


<br/><br/><br/>

***
<br/>
> <h1 id="ProTableåˆ—è¡¨æ‹–æ‹½æ’åº">ProTableåˆ—è¡¨æ‹–æ‹½æ’åº</h1>

è¿™ç§åˆ—è¡¨å¯ä»¥é€‚åº”åµŒå¥—çš„æ•°æ®ç»“æ„ï¼Œå¹¶æ˜¾ç¤ºã€‚æä¾›çš„åˆ—è¡¨æ•°æ®å¦‚ä¸‹ï¼š

```json
{
  categoryCode: "ipc",
  categoryId: "1823258198548017154",
  categoryName: "æ‘„åƒæœº",
  children: [
    {
      categoryCode: "ipc",
      categoryId: "1937718753170132993",
      categoryName: "äº‘å°æ‘„åƒæœº",
      children: [
	      ...
	      ..
	      ,
      ]
    }
  ]
}
```

[**è¯¦ç»†è¯·çœ‹è¿™é‡Œ**](./CMReactNotes.md#ProTableåˆ—è¡¨æ‹–æ‹½æ’åº)

***
<br/><br/><br/>
> <h2 id="ä¿®æ”¹æŸä¸€æ–¹æŒ‰é’®çš„ç‚¹å‡»çŠ¶æ€">ä¿®æ”¹æŸä¸€æ–¹æŒ‰é’®çš„ç‚¹å‡»çŠ¶æ€</h2>

åœºæ™¯æ˜¯ï¼š`ProTable`çš„ä»»æ„ä¸€è¡Œç‚¹å‡»å…¶ä¸­çš„æŒ‰é’®ï¼Œå°†æŒ‰é’®çš„æ ‡é¢˜ç”±**ä¸Šæ¶**å˜æˆ**ä¸‹æ¶**ï¼Œé€šè¿‡ä¸€**Bool**å€¼è¿›è¡Œåˆ¤æ–­ï¼Œä½†æ˜¯é‡åˆ°é—®é¢˜æ˜¯ï¼š æ”¹å˜ä¸€ä¸ªå…¶ä»–çš„éƒ½æ”¹å˜äº†ï¼Œæ€ä¹ˆåŠï¼Ÿï¼Ÿ

<br/>

é€šè¿‡æ¯ä¸€æ–¹çš„ `record`æ•°æ®å¯¹ æ²¡æœ‰ `isPutaway` å­—æ®µï¼Œæƒ³å®ç°â€œ**æ¯ä¸€è¡ŒæŒ‰é’®çŠ¶æ€ç‹¬ç«‹**â€çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çŠ¶æ€å¯¹è±¡ï¼ˆMap æˆ–æ™®é€šå¯¹è±¡ï¼‰æ¥è®°å½•æ¯ä¸€è¡Œçš„çŠ¶æ€ï¼Œæ ¹æ® `record.categoryId` æ¥ç´¢å¼•ã€‚

<br/>

**âœ… ä½¿ç”¨ JavaScript ç¼–ç æ–¹å¼ï¼ˆæ²¡æœ‰ `isPutaway` å­—æ®µçš„åšæ³•ï¼‰**

```jsx
// åˆå§‹åŒ–çŠ¶æ€ï¼šç”¨ categoryId æ˜ å°„æ˜¯å¦ä¸Šæ¶
const [putawayMap, setPutawayMap] = useState({});
```

<br/>

**ğŸ” æ¸²æŸ“åˆ—ä¸­çš„æŒ‰é’®ï¼š**

```jsx
const [putawayMap, setPutawayMap] = useState({});

const columns = [
  {
    title: 'æ“ä½œ',
    key: 'action',
    valueType: 'option',
    render: (text, record) => {
      const isPutaway = putawayMap?.[record.categoryId] ?? true;

      return [
        <a
          key={'putaway' + record.categoryId}
          onClick={() => {
            setPutawayMap(prev => ({
              ...prev,
              [record.categoryId]: !isPutaway,
            }));
          }}
        >
          {isPutaway ? 'ä¸‹æ¶' : 'ä¸Šæ¶'}
        </a>,
      ];
    },
  },
];
```

<br/>

**âœ… æ•ˆæœè¯´æ˜ï¼š**

* `putawayMap` æ˜¯ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œç»“æ„å¦‚ä¸‹ï¼š

  ```js
  {
    1: true,   // categoryId = 1 æ˜¯ä¸Šæ¶
    2: false,  // categoryId = 2 æ˜¯ä¸‹æ¶
  }
  ```
* æ¯ä¸€è¡Œé€šè¿‡ `categoryId` æŸ¥æ‰¾çŠ¶æ€ï¼Œäº’ç›¸ä¸å½±å“ã€‚


<br/>

**è¯­æ³•ä¸æ‡‚åœ°æ–¹ï¼š**

ä¸‹é¢ä¸€æ®µä»£ç æ˜¯ä¸€ä¸ª **å‡½æ•°å¼æ›´æ–°å†™æ³•**ï¼Œç”¨äº React çš„ `useState` æ›´æ–°ã€‚

```js
setPutawayMap(prev => ({
  ...prev,
  [record.categoryId]: !isPutaway,
}));
```

è¿™é‡Œçš„ `prev` æ˜¯ **`putawayMap` çš„å½“å‰å€¼ï¼ˆä¹‹å‰çš„å€¼ï¼‰**ã€‚React ä¼šæŠŠæ—§çš„çŠ¶æ€å€¼ä¼ å…¥ `setPutawayMap` çš„å›è°ƒå‡½æ•°ã€‚

è¿™å«åš\*\*â€œå‡½æ•°å¼æ›´æ–°â€**ï¼Œä¼˜ç‚¹æ˜¯å¯ä»¥**é¿å…å¼‚æ­¥æ›´æ–°å¸¦æ¥çš„çŠ¶æ€ä¸ä¸€è‡´é—®é¢˜\*\*ã€‚

<br/>

**ğŸ” äºŒã€`...prev` æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ**

è¿™æ˜¯ JavaScript çš„**å¯¹è±¡æ‰©å±•è¿ç®—ç¬¦ï¼ˆå±•å¼€ç¬¦ï¼‰**ï¼Œä½œç”¨æ˜¯å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼š

```js
{
  ...prev,               // ä¿ç•™åŸæ¥çš„æ‰€æœ‰é”®å€¼å¯¹
  [record.categoryId]: newValue // æ›´æ–°æŸä¸ªé”®çš„å€¼
}
```

ç­‰ä»·äºï¼š

```js
const newMap = Object.assign({}, prev);
newMap[record.categoryId] = !isPutaway;
```

<br/>

**å‡è®¾åŸæ¥çŠ¶æ€æ˜¯è¿™æ ·ï¼š**

```js
putawayMap = {
  1: true,
  2: false,
}
```

ç°åœ¨ç‚¹å‡»äº† `categoryId = 2` çš„è¡Œï¼Œé‚£ä¹ˆï¼š

```js
setPutawayMap(prev => ({
  ...prev,
  2: true
}));
```

æ›´æ–°åçŠ¶æ€å˜ä¸ºï¼š

```js
{
  1: true,
  2: true, // åŸæ¥çš„ false è¢«æ›´æ–°äº†
}
```

<br/>

**âœ… ä¸ºä»€ä¹ˆä¸ç›´æ¥å†™ `setPutawayMap({ ...putawayMap, ... })`ï¼Ÿ**

å› ä¸º `setPutawayMap({...putawayMap, ...})` æ˜¯ç›´æ¥ç”¨å½“å‰å˜é‡ï¼Œè€Œ**çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„**ï¼Œå¦‚æœä½ åœ¨å¤šä¸ªåœ°æ–¹å¿«é€Ÿè¿ç»­ç‚¹å‡»æŒ‰é’®ï¼Œå¯èƒ½è¯»åˆ°çš„è¿˜æ˜¯æ—§å€¼ã€‚

ç”¨ `prev => {}` å‡½æ•°å¼å†™æ³•å¯ä»¥**ç¡®ä¿ä½ æ°¸è¿œæ‹¿åˆ°çš„æ˜¯æœ€æ–°çŠ¶æ€**ï¼Œè¿™æ˜¯å®˜æ–¹æ¨èå†™æ³•ã€‚



***
<br/><br/><br/>
> <h2 id="åˆ—è¡¨Table">åˆ—è¡¨Table</h2>


<br/><br/>
> <h3 id="åˆ†é¡µå›è°ƒå‡½æ•°">åˆ†é¡µå›è°ƒå‡½æ•°</h3>

ä¸‹é¢ä»£ç ä¸­æ¶‰åŠåˆ°ä½¿ç”¨åˆ†é¡µï¼Œåœ¨`pagination`å±æ€§ä¸­è°ƒç”¨ç½‘ç»œè¯·æ±‚è¿›è¡Œåˆ†é¡µï¼Œå¦‚ä¸‹ï¼š

```js
<Table 
pagination={{
		current,// å½“å‰ç¬¬å‡ é¡µ
		pageSize,//æ¯é¡µæœ‰å¤šå°‘æ¡æ•°æ®
		total,//æ€»å…±æœ‰å¤šå°‘é¡µ
		onChange: this.handlePaginationChange, // ç‚¹å‡»åˆ†é¡µæ—¶ï¼Œè¿›è¡Œè·³è½¬è°ƒç”¨ç½‘ç»œæ¥å£å‡½æ•°
		onShowSizeChange: this.handlePaginationChange,
	}}
/>

handlePaginationChange = (page, pageSize) => {
	this.setState(
	  {
	    current: page,
	    pageSize: pageSize,
	  },
	  () => {
	    this.loadData(page, pageSize);
	  },
	);
};
```

[**å›è°ƒå‡½æ•°è¯·çœ‹è¿™é‡Œ**](./../JavaScript/åŸºç¡€(II).md#å›è°ƒå‡½æ•°)





***
<br/><br/><br/>
> <h2 id="Radio.Groupå•é€‰æŒ‰é’®">Radio.Groupå•é€‰æŒ‰é’®</h2>

**å•é€‰æŒ‰é’®ç®€å•å®ç”¨ï¼Œå¦‚ä¸‹ï¼š**

```js
<Radio.Group
  name="type"
  options={typeOption}
  onChange={handleFormChange}
  optionType="button"
  buttonStyle="solid"
/>
```

é’ˆå¯¹å®ƒçš„ä½¿ç”¨ï¼Œ[**è¯·ç§»æ­¥è¿™é‡Œ**](./AntDesign.md#Radio.Groupå•é€‰æŒ‰é’®)


***
<br/><br/><br/>
> <h2 id="Selectç»„ä»¶åˆæ­¥ä½¿ç”¨">Selectç»„ä»¶åˆæ­¥ä½¿ç”¨</h2>

**ä½¿ç”¨æ—¶æœ‰å¦‚ä¸‹Code**

```js
<Select
  onChange={actionSelectChange}
  options={dataList}
  placeholder={intl.formatMessage({ id: 'pages.action.select.placeholder' })}
/>
```

å…·ä½“ä½¿ç”¨ï¼Œ[**è¯·çœ‹è¿™é‡Œ**](./AntDesign.md#ä¸‹æ‹‰ç»„ä»¶Select)



<br/><br/><br/>

***
<br/>

> <h1 id="ç½‘ç»œ">ç½‘ç»œ</h1>


***
<br/><br/><br/>
># <h2 id="æ¥å£é‡Œæºå…¥å‚æ•°">[æ¥å£é‡Œæºå…¥å‚æ•°](./åŸºç¡€(I).md#æ¥å£å­—ç¬¦ä¸²æºå…¥å ä½ç¬¦)</h2>


<br/><br/><br/>

***
<br/>

> <h1 id="è·¯ç”±">è·¯ç”±</h1>

***
<br/>
> <h2 id="è·¯å¾„å‚æ•°è·³è½¬">è·¯å¾„å‚æ•°è·³è½¬</h2>

**1.å®‰è£… history åŒ…**

```sh
npm install history
```

<br/>

**2.åˆ›å»ºä¸€ä¸ª history.js**

```SH
// history.js
import { createBrowserHistory } from "history";

const history = createBrowserHistory();

export default history;
```

<br/>

**åœ¨ä¸€ä¸ªæŒ‰é’®ç»„ä»¶ä¸­ï¼Œç‚¹å‡»åè§¦å‘è·¯ç”±è·³è½¬ï¼Œå¦‚ä¸‹ï¼š**

```js
onClick={() => {
  history.push(
    '/productionManage/product_task/NewProductOrderView?taskId=' + record.taskId,
  ); //T001
}}

```

<br/>

**ç±»ç»„ä»¶ä¸­è·å–è·¯ç”±å‚æ•°ï¼š**

```js
constructor(props) {
    super(props);
		const searchParams = new URLSearchParams(window.location.search);
		    const params = Object.fromEntries(searchParams.entries());
		    this.taskId = searchParams.get('taskId');
}
```

<br/>

**å‡½æ•°ç»„ä»¶ä¸­è·å–è·¯ç”±å‚æ•°ï¼š**

```js
onst argusResourceList = () => {
  const queryParams = new URLSearchParams(location.search);
  const resourceGroupKey = queryParams.get('resourceGroupKey');
}
```



<br/><br/><br/>

***
<br/>

> <h1 id="CSSæ ·å¼">CSSæ ·å¼</h1>


***
<br/><br/><br/>
> <h2 id="æ¨¡å—åŒ–æ ·å¼">[æ ·å¼æ¨¡å—åŒ–](./../CSS/æ ·å¼.md#æ¨¡å—åŒ–æ ·å¼)</h2>

**React** ä¸­æœ‰`index.less`æ–‡ä»¶å¦‚ä¸‹ä»£ç ï¼š

```css
.powerType {
  :global {
    .ant-radio-wrapper {
      line-height: 36px;
    }
  }
}
```


è¿™æ®µcssæ ·å¼ä»£ç ä»€ä¹ˆæ„æ€ï¼Ÿcssä¸­å¦‚ä½•å†™ï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ[è¯·çœ‹è¿™é‡Œ](./../CSS/æ ·å¼.md#æ¨¡å—åŒ–æ ·å¼)

<br/><br/>
> <h3 id="antdä¸­Radio.Groupç»„ä»¶æ— æ³•ä¿®æ”¹æ ·å¼">antdä¸­Radio.Groupç»„ä»¶æ— æ³•ä¿®æ”¹æ ·å¼</h3>

åœ¨ä½¿ç”¨antdç»„ä»¶ä¸­æœ‰è¿™æ®µä»£ç ï¼Œå¦‚ä¸‹ï¼š

**PopView.moudle.cssæ–‡ä»¶ä»£ç ï¼š**

```css
.powerType {
  :global(.ant-radio-wrapper) {
    line-height: 36px;
  }
}
```


<br/>

åœ¨**`PopView.js`**ä¸­æœ‰

```js
import CSStyle from './PopView.module.css'

render() {
	return (
		<Radio.Group  
			className={CSStyle.powerType}	
		/>
	)
}
```

<br/>

ä½†è‹¥æ˜¯å†™æˆå¦‚ä¸‹ï¼š

```css
:global {
  .powerType .ant-radio-wrapper {
    line-height: 36px;
  }
}
```

æ— æ³•å®ç°å…¶è¡¨å•ä¸­å·¦è¾¹æ ‡é¢˜ä¸å•é€‰æŒ‰é’®åœ¨åŒä¸€è¡Œçš„æ ·å¼ï¼Œè¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

<br/>

[**åŸå› å¦‚ä¸‹è¯·çœ‹è¿™é‡Œ**](./../CSS/æ ·å¼.md#å±€éƒ¨æ¨¡å—å’Œå…¨å±€æ¨¡å—åŒ–æ ·å¼åŒºåˆ«å’Œå½±å“)

***
<br/><br/><br/>
> <h2 id="å­—ç¬¦ä¸²è¶…å‡ºæµ®çª—æ˜¾ç¤º">å­—ç¬¦ä¸²è¶…å‡ºæµ®çª—æ˜¾ç¤º</h2>

**é‡åˆ°åœºæ™¯ï¼š** åˆ—è¡¨ä¸­æœ‰ä¸€åˆ—è¦æ±‚æ˜¾ç¤º**10å­—ç¬¦ä¸²å†…å®¹**ï¼Œè¶…å‡ºæœ«å°¾çœç•¥å·ï¼Œé¼ æ ‡åœç•™æœ‰å¼¹çª—å‡ºç°ï¼Œæ˜¾ç¤ºå‡ºæ‰€æœ‰å†…å®¹ã€‚

<br/>

ç”¨ antd çš„ `Tooltip` / `Popover` å¹¶æŠŠæµ®å±‚æŒ‚åˆ° `document.body`

AntD çš„ `Tooltip`/`Popover` æœ‰ `getPopupContainer`ï¼Œå¯ä»¥æŠŠå¼¹å±‚æ¸²æŸ“åˆ° `body`ï¼Œè¿™æ ·å®Œå…¨ä¸å— table cell çš„ `overflow` é™åˆ¶ï¼Œä¹Ÿä¸ç”¨æ”¹è¡¨æ ¼ CSSã€‚ä»£ç æ›´ç®€å•ã€ä¹Ÿæ›´å…¼å®¹ã€‚

```jsx
import { Tooltip } from 'antd';

{
  title: '...',
  dataIndex: 'checkItems',
  key: 'checkItems',
  render: (checkItems) => {
    const display = ProductTaskVM.getDisplayString({ arr: checkItems });
    const full = checkItems.join('ã€');

    return (
      <Tooltip
        title={<div style={{ maxWidth: 300, whiteSpace: 'normal', wordBreak: 'break-word' }}>{full}</div>}
        placement="topLeft"
        getPopupContainer={() => document.body} // â† å…³é”®ï¼šæ¸²æŸ“åœ¨ bodyï¼Œé¿å…è¢«è¡¨æ ¼è£å‰ª
        overlayInnerStyle={{ padding: 10, fontSize: 14, borderRadius: 8 }}
      >
        <span style={{ cursor: 'pointer' }}>{display}</span>
      </Tooltip>
    );
  }
}
```

**ä¼˜ç‚¹**ï¼š

* ä¸ç”¨æ”¹è¡¨æ ¼ `td` çš„ CSSï¼›
* antd çš„ Tooltip ä¼šå¤„ç†é®æŒ¡ã€å®šä½ã€åŠ¨ç”»ã€ç§»åŠ¨ç«¯è¡Œä¸ºç­‰ï¼›
* å¯é€šè¿‡ `overlayInnerStyle` æˆ– `title` çš„å†…è”æ ·å¼è‡ªå®šä¹‰å­—ä½“ã€

è‹¥æ˜¯ä¸ç”¨è¿™ä¸ªç»„ä»¶[ï¼Œå¯ä»¥ä½¿ç”¨cssçš„hoverè§£å†³](../CSS/æ ·å¼.md#æµ®çª—hoveræ•ˆæœ)



***
<br/><br/><br/>
> <h2 id="tsæ¨¡å—å£°æ˜æ ·å¼æ–‡ä»¶">tsæ¨¡å—å£°æ˜æ ·å¼æ–‡ä»¶</h2>

**åœ¨`typing.d.ts` ä¸­çš„ï¼š**

```ts
declare module '*.css';
declare module '*.less';
```

è¿™æ˜¯ **TypeScript çš„æ¨¡å—å£°æ˜**ï¼Œä½œç”¨æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼š

* å½“ä½ åœ¨ä»£ç é‡Œå†™ `import './index.css';` æˆ– `import styles from './index.less';` çš„æ—¶å€™ï¼Œè¿™äº›æ–‡ä»¶è™½ç„¶ä¸æ˜¯ `.ts/.tsx` æ–‡ä»¶ï¼Œä½†ç¼–è¯‘å™¨ä¸è¦æŠ¥é”™ï¼Œé»˜è®¤æŠŠå®ƒä»¬å½“æˆä¸€ä¸ªæ¨¡å—æ¥å¤„ç†ã€‚

> æ²¡æœ‰è¿™å¥è¯æ—¶ï¼ŒTS ä¼šæŠ¥é”™ï¼š
>
> ```
> Cannot find module './index.less'
> ```

<br/>

**å¦‚ä½•æ‰¾åˆ°å¯¹åº”çš„ `.css`ã€`.less` æ–‡ä»¶ï¼Ÿ**

* è¿™äº›å£°æ˜æœ¬èº« **ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆæˆ–æŸ¥æ‰¾æ–‡ä»¶**ï¼Œå®ƒä»¬åªæ˜¯è®© TS çŸ¥é“â€œè¿™ç±»æ–‡ä»¶æ˜¯åˆæ³•çš„æ¨¡å—â€ã€‚
* å…·ä½“åŠ è½½ `.css` æˆ– `.less` æ–‡ä»¶çš„é€»è¾‘ï¼Œæ˜¯ç”± **æ„å»ºå·¥å…·ï¼ˆWebpack / Vite / CRA å†…ç½®é…ç½®ï¼‰** æ¥å¤„ç†çš„ã€‚

  * Webpack é…ç½®é‡Œä¼šæœ‰ `css-loader`ã€`less-loader` æ¥è§£æè¿™äº›æ–‡ä»¶ã€‚
  * æ‰€ä»¥åªè¦ä½ åœ¨å·¥ç¨‹ä¸­å®é™…å†™äº†ï¼š

```js
import './App.css';
import styles from './index.less';
```

æ„å»ºå·¥å…·å°±ä¼šå»å¯¹åº”ç›®å½•ä¸‹æ‰¾æ–‡ä»¶å¹¶å¤„ç†ã€‚

æ€»ç»“ï¼š

* `declare module '*.css'` / `*.less` â†’ åªæ˜¯å‘Šè¯‰ TypeScriptï¼šå¯ä»¥ import è¿™ç±»æ–‡ä»¶ï¼Œä¸è¦æŠ¥é”™ã€‚
* çœŸæ­£çš„æ–‡ä»¶æŸ¥æ‰¾å’ŒåŠ è½½ â†’ ç”± Webpack/Vite é…ç½®å®Œæˆã€‚

[å…·ä½“åŸç†ï¼Œè¯·çœ‹è¿™é‡Œ](./../CSS/æ ·å¼.md#æ ·å¼æ–‡ä»¶å¤„ç†æµç¨‹)


***
<br/><br/><br/>
># <h2 id="overflowä¸é˜´å½±æ­é…">[overflowä¸é˜´å½±æ­é…](./../CSS/æ ·å¼.md#overflowä¸é˜´å½±æ­é…)</h2>


<br/><br/><br/>

***
<br/>

> <h1 id= "æ¡ˆä¾‹">æ¡ˆä¾‹</h1>


***
<br/><br/><br/>
> <h2 id="ä¿ç•™æ—§å¯¹è±¡å¼•ç”¨+åˆå¹¶æ–°é€‰æ‹©ç»“æœ">ä¿ç•™æ—§å¯¹è±¡å¼•ç”¨+åˆå¹¶æ–°é€‰æ‹©ç»“æœ</h2>
> å¦‚æœç”¨æˆ·é‡æ–°é€‰æ‹©æ•°æ®ï¼Œå°½é‡ä¿ç•™ä¹‹å‰å·²å­˜åœ¨å¯¹è±¡ï¼ˆé¿å…æ•°æ®ä¸¢å¤±ï¼‰

```js
const { pcbaList } = this.state.activityDatas;

const oldMap = Object.fromEntries(
  (pcbaList?.value ?? []).map((item) => [item.material, item]),
);

const finalList = value.map((item) => oldMap[item.material] || item);

obj = {
  value: finalList,
  isLegal: finalList?.length != 0,
};
```

---
<br/>

**1ï¸âƒ£ pcbaList.value**

è¿™æ˜¯**ä¹‹å‰å·²ç»é€‰ä¸­çš„æ•°æ®**

```js
pcbaList.value = [
  {
    material: 'A001',
    name: 'ä¸»æ¿A',
    extraField: 'ç”¨æˆ·ä¿®æ”¹è¿‡çš„æ•°æ®'
  },
  {
    material: 'B002',
    name: 'ä¸»æ¿B'
  }
];
```

---
<br/>

**2ï¸âƒ£ value**

è¿™æ˜¯**å½“å‰æ–°é€‰æ‹©çš„ç»“æœ**

```js
value = [
  {
    material: 'A001',
    name: 'ä¸»æ¿A'
  },
  {
    material: 'C003',
    name: 'ä¸»æ¿C'
  }
];
```

---
<br/>

**æ„å»ºæ—§æ•°æ®æ˜ å°„è¡¨**

```js
const oldMap = Object.fromEntries(
  pcbaList.value.map(item => [item.material, item])
);
```

å¾—åˆ°ï¼š

```js
oldMap = {
  A001: {
    material: 'A001',
    name: 'ä¸»æ¿A',
    extraField: 'ç”¨æˆ·ä¿®æ”¹è¿‡çš„æ•°æ®'
  },
  B002: {
    material: 'B002',
    name: 'ä¸»æ¿B'
  }
}
```

ğŸ‘‰ ä½œç”¨ï¼š
ç”¨ material ä½œä¸º keyï¼Œæ–¹ä¾¿å¿«é€ŸæŸ¥æ‰¾æ—§å¯¹è±¡ã€‚

---
<br/>

**ç¬¬äºŒæ­¥ï¼šæ„é€ æœ€ç»ˆæ•°ç»„**

```js
const finalList = value.map(item =>
  oldMap[item.material] || item
);
```

æ„æ€æ˜¯ï¼š

> å¦‚æœæ—§æ•°æ®é‡Œæœ‰è¿™ä¸ª materialï¼Œå°±ç”¨æ—§å¯¹è±¡
> å¦åˆ™ç”¨æ–°å¯¹è±¡

---
<br/>

**ä»£å…¥å®é™…ä¾‹å­**

å½“å‰æ–°é€‰æ‹©ï¼š

```js
value = [
  { material: 'A001', name: 'ä¸»æ¿A' },
  { material: 'C003', name: 'ä¸»æ¿C' }
];
```

éå†ï¼š

**ç¬¬ä¸€é¡¹ A001**

```js
oldMap['A001'] å­˜åœ¨
```

â†’ ä½¿ç”¨æ—§å¯¹è±¡ï¼š

```js
{
  material: 'A001',
  name: 'ä¸»æ¿A',
  extraField: 'ç”¨æˆ·ä¿®æ”¹è¿‡çš„æ•°æ®'
}
```

---
<br/>

**ç¬¬äºŒé¡¹ C003**

```js
oldMap['C003'] ä¸å­˜åœ¨
```

â†’ ä½¿ç”¨æ–°å¯¹è±¡ï¼š

```js
{ material: 'C003', name: 'ä¸»æ¿C' }
```

---
<br/>

**æœ€ç»ˆç»“æœ**

```js
finalList = [
  {
    material: 'A001',
    name: 'ä¸»æ¿A',
    extraField: 'ç”¨æˆ·ä¿®æ”¹è¿‡çš„æ•°æ®'
  },
  {
    material: 'C003',
    name: 'ä¸»æ¿C'
  }
];
```

---
<br/>

**æé—®ï¼šä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ**

å‡è®¾ç”¨æˆ·åœ¨ UI é‡Œï¼š

* é€‰ä¸­ A001
* ç¼–è¾‘äº†å®ƒçš„æŸäº›å­—æ®µ
* ç„¶ååˆé‡æ–°é€‰æ‹©åˆ—è¡¨

å¦‚æœä½ ç›´æ¥ç”¨ valueï¼š

```js
finalList = value;
```

é‚£ç”¨æˆ·ç¼–è¾‘è¿‡çš„ `extraField` ä¼šä¸¢å¤±ã€‚

ä½†ç°åœ¨å†™æ³•ï¼š

âœ… ä¿ç•™æ—§å¯¹è±¡
âœ… ä¿ç•™ç”¨æˆ·ä¿®æ”¹çš„æ•°æ®
âœ… åªæ–°å¢çœŸæ­£æ–°å¢çš„é¡¹

---
<br/>

```js
isLegal: finalList?.length != 0
```

ç­‰ä»·äºï¼š

```js
isLegal = finalList.length > 0
```

æ„æ€æ˜¯ï¼š

> åªè¦é€‰ä¸­ä¸ä¸ºç©º â†’ åˆæ³•

***
<br/><br/><br/>
> <h2 id="åŸºäºä¸»é”®skuIdçš„æ•°ç»„å¯¹é½+æ•°æ®æºæ›¿æ¢">åŸºäºä¸»é”®skuIdçš„æ•°ç»„å¯¹é½+æ•°æ®æºæ›¿æ¢</h2>
**æ–¹æ³•å®ç°éµå®ˆä»¥ä¸‹è§„åˆ™ï¼š**
- å¦‚æœ`chooseMerchant.value` é‡Œçš„å…ƒç´ åœ¨ `valueXX` ä¸­å­˜åœ¨ç›¸åŒ` skuId â†’ `ä¿ç•™
- å¦‚æœ`ä¸å­˜åœ¨ â†’ åˆ é™¤`
- åŒæ—¶ä¿è¯æœ€ç»ˆæ•°æ®ä»¥ `valueXX` ä¸ºä¸»ï¼ˆä¸èƒ½ä¿ç•™æ—§è„æ•°æ®ï¼‰

***
<br/>

```js
function mergeChooseMerchant(valueXX = [], chooseMerchant = {}) {
  const oldList = chooseMerchant?.value || [];

  // 1ï¸âƒ£ æŠŠæ—§æ•°æ®åšæˆ Map
  const oldMap = new Map(
    oldList.map(item => [item.skuId, item])
  );

  // 2ï¸âƒ£ ä»¥ valueXX ä¸ºåŸºå‡†æ„é€ æœ€ç»ˆæ•°ç»„
  const finalList = valueXX.map(item => {
    return oldMap.get(item.skuId) || item;
  });

  return {
    value: finalList,
    isLegal: finalList.length > 0,
  };
}
```

---
<br/>

**1ï¸âƒ£ æœ€æ–°æ•°æ®æºï¼ˆvalueXXï¼‰**

```js
const valueXX = [
  { skuId: '1001', name: 'Camera A', price: 199 },
  { skuId: '1002', name: 'Camera B', price: 299 },
];
```

è¡¨ç¤ºï¼šå½“å‰ç³»ç»Ÿä¸­åˆæ³•çš„ SKU åªæœ‰ 1001 å’Œ 1002ã€‚

---
<br/>

**2ï¸âƒ£ æ—§å·²é€‰æ•°æ®ï¼ˆchooseMerchantï¼‰**

```js
const chooseMerchant = {
  value: [
    {
      skuId: '1001',
      name: 'Camera A',
      price: 199,
      discount: 20,   // ç”¨æˆ·é¢å¤–ç¼–è¾‘å­—æ®µ
    },
    {
      skuId: '1003',
      name: 'Camera C',
      price: 399,
    }
  ]
};
```

æ³¨æ„ï¼š

* 1001 æ˜¯åˆæ³•çš„
* 1003 å·²ç»ä¸åœ¨ valueXX é‡Œäº†ï¼ˆåº”è¯¥è¢«åˆ é™¤ï¼‰

---
<br/>

**æ‰§è¡Œè¿‡ç¨‹æ‹†è§£**

<br/>

**ç¬¬ä¸€æ­¥ï¼šæ„é€  oldMap**

```js
oldMap = {
  '1001' => { skuId:'1001', name:'Camera A', price:199, discount:20 }
  '1003' => { skuId:'1003', name:'Camera C', price:399 }
}
```

<br/>

**ç¬¬äºŒæ­¥ï¼šéå† valueXX**

**éå†åˆ° 1001**

```js
oldMap.get('1001') å­˜åœ¨
```

â†’ ä½¿ç”¨æ—§å¯¹è±¡ï¼ˆä¿ç•™ discountï¼‰

ç»“æœï¼š

```js
{
  skuId: '1001',
  name: 'Camera A',
  price: 199,
  discount: 20
}
```

<br/>

**éå†åˆ° 1002**

```js
oldMap.get('1002') ä¸å­˜åœ¨
```

â†’ ä½¿ç”¨ valueXX çš„å¯¹è±¡

ç»“æœï¼š

```js
{
  skuId: '1002',
  name: 'Camera B',
  price: 299
}
```

<br/>

**âœ… æœ€ç»ˆè¿”å›ç»“æœ**

```js
{
  value: [
    {
      skuId: '1001',
      name: 'Camera A',
      price: 199,
      discount: 20   // ä¿ç•™
    },
    {
      skuId: '1002',
      name: 'Camera B',
      price: 299
    }
  ],
  isLegal: true
}
```

---
<br/>

**å¯ä»¥çœ‹åˆ°è§„åˆ™å…¨éƒ¨æ»¡è¶³**

| skuId | ç»“æœ    | åŸå›            |
| ----- | ----- | ------------ |
| 1001  | ä¿ç•™æ—§å¯¹è±¡ | å­˜åœ¨äº valueXX  |
| 1003  | åˆ é™¤    | ä¸å­˜åœ¨äº valueXX |
| 1002  | è‡ªåŠ¨åŠ å…¥  | åœ¨ valueXX ä¸­  |


***
<br/><br/><br/>
> <h2 id="å¹¶å‘è¯·æ±‚å¤„ç†">å¹¶å‘è¯·æ±‚å¤„ç†</h2>

- **éœ€æ±‚æ‹†æˆä¸‰æ­¥ï¼š**
	- ä»æ•°ç»„ä¸­æå– skuId â†’ ç»„æˆæ–°æ•°ç»„
	- éå† skuId æ•°ç»„ â†’ `é€ä¸ªè°ƒç”¨ requestSkuDays`
	- å°†è¿”å›ç»“æœç»„è£…æˆå¯¹è±¡ â†’ `å­˜å…¥ state`
	- ä½¿ç”¨ `Promise.all` å¹¶å‘å¤„ç†

```js
class DemoPage extends React.Component {

  state = {
    days: {}
  };

  // ä¸»é€»è¾‘æ–¹æ³•
  handleRequestSkuDays = (list = []) => {

    // 1ï¸âƒ£ æå– skuId æ•°ç»„
    const skuIdList = list.map(item => item.skuId).filter(Boolean);

    if (skuIdList.length === 0) {
      this.setState({ days: {} });
      return;
    }

    // 2ï¸âƒ£ å¹¶å‘è°ƒç”¨æ¥å£
    const requestList = skuIdList.map(skuId =>
      FreeiCloudStoragePolicyEditVM.requestSkuDays({ mainSkuId: skuId })
        .then(res => ({
          mainSkuId: skuId,
          data: res
        }))
    );

    // 3ï¸âƒ£ æ±‡æ€»ç»“æœ
    Promise.all(requestList)
      .then(results => {
        const aa = {};

        results.forEach(item => {
          aa[item.mainSkuId] = item.data;
        });

        this.setState({ days: aa });
      })
      .catch(err => {
        console.error('requestSkuDays error:', err);
      });
  };

}
```

<br/>

**æœ€ç»ˆå¾—åˆ°çš„ state ç»“æ„**

```js
days = {
  "279308005005066240": res1,
  "xxxx": res2,
  "yyyy": res3
}
```

***
<br/><br/><br/>
> <h2 id="Promise.allæ‰¹å¤„ç†ç½‘ç»œè¯·æ±‚">Promise.allæ‰¹å¤„ç†ç½‘ç»œè¯·æ±‚</h2>

```js
static transformSubsidyActivityData = async ({ activityModel, intl }) => {
  const { pcbaSubsidyItems, ...merchantData } = activityModel;

  // 1ï¸âƒ£ å¹¶å‘æ‰§è¡Œæ‰€æœ‰å¼‚æ­¥ä»»åŠ¡
  const [
    appOptions,
    countryOptions
  ] = await Promise.all([
    this.getSelectedAppOptions(activityModel?.belongAppId ?? ''),
    this.getSelectedCountryOptions(activityModel?.effectiveCountry ?? '', intl),
  ]);

  // 2ï¸âƒ£ æ•´ç†æœ€ç»ˆæ•°æ®
  const dataItems = {
    app: { value: appOptions, isLegal: true },
    country: { value: countryOptions, isLegal: true },
    product: { value: activityModel?.product ?? [], isLegal: true },
  };

  return dataItems;
};
```
***
<br/>


**ğŸ™‹æé—®ï¼š** ä¸ºä»€ä¹ˆå¿…é¡» Promise.allï¼Ÿ

å¦‚æœä½ å†™ï¼š

```js
const app = await this.getSelectedAppOptions(...)
const country = await this.getSelectedCountryOptions(...)
```
æ˜¯ä¸²è¡Œæ‰§è¡Œã€‚

<br/>

ä½†ä½¿ç”¨ï¼š

```js
await Promise.all([...])
```
æ˜¯å¹¶å‘æ‰§è¡Œï¼Œæ€§èƒ½æ›´å¥½ã€‚

<br/>

**ğŸ¯ è°ƒç”¨æ–¹å¼ï¼ˆReact ç±»ç»„ä»¶ï¼‰**

```js
componentDidMount() {
  this.loadData();
}

loadData = async () => {
  const dataItems =
    await FreeiCloudStoragePolicyEditVM.transformSubsidyActivityData({
      activityModel: this.props.activityModel,
      intl: this.props.intl,
    });

  this.setState(dataItems);
};
```


***
<br/>

```js
const [appOptions, countryOptions] = await Promise.all([
  this.getSelectedAppOptions(activityModel?.belongAppId ?? ''),
  this.getSelectedCountryOptions(activityModel?.effectiveCountry ?? '', intl),
]);
```

æ˜¯**ä¸¥æ ¼ä¸€ä¸€å¯¹åº”**ï¼Œé¡ºåºå®Œå…¨ç”± `Promise.all([...])` é‡Œæ•°ç»„çš„é¡ºåºå†³å®šã€‚

**ç­‰ä»·äºï¼š**

```js
const results = await Promise.all([
  PromiseA,
  PromiseB
]);

// results[0] å¯¹åº” PromiseA
// results[1] å¯¹åº” PromiseB

const appOptions = results[0];
const countryOptions = results[1];
```

---
<br/>

** 1ï¸âƒ£ Promise.all çš„è¿”å›é¡ºåº**

**è¿”å›å€¼é¡ºåºæ°¸è¿œç­‰äºä¼ å…¥æ•°ç»„é¡ºåº**

å³ä¾¿ï¼š

* ç¬¬äºŒä¸ª Promise å…ˆè¿”å›
* ç¬¬ä¸€ä¸ª Promise åè¿”å›

æœ€ç»ˆæ•°ç»„é¡ºåºä¾ç„¶ä¿æŒï¼š

```
[ç¬¬ä¸€ä¸ªPromiseç»“æœ, ç¬¬äºŒä¸ªPromiseç»“æœ]
```

---
<br/>

```js
const p1 = new Promise(resolve =>
  setTimeout(() => resolve('A'), 2000)
);

const p2 = new Promise(resolve =>
  setTimeout(() => resolve('B'), 500)
);

const result = await Promise.all([p1, p2]);

console.log(result);
```

è¾“å‡ºæ°¸è¿œæ˜¯ï¼š

```
['A', 'B']
```

å³ä½¿ B å…ˆå®Œæˆã€‚

---
<br/>

**å›åˆ°ä»£ç ä¸­**

```js
[
  this.getSelectedAppOptions(...),      // index 0
  this.getSelectedCountryOptions(...),  // index 1
]
```

æ‰€ä»¥ï¼š

| Promise index | å˜é‡             |
| ------------- | -------------- |
| 0             | appOptions     |
| 1             | countryOptions |

ä¸¥æ ¼å¯¹åº”ã€‚

---
<br/>

**å¸¸è§é”™è¯¯**

å¾ˆå¤šäººè¯¯ä»¥ä¸ºæ˜¯â€œè°å…ˆè¿”å›è°æ’å‰é¢â€ï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚

Promise.all æ˜¯ï¼š

> ç­‰å…¨éƒ¨å®Œæˆ â†’ æŒ‰ä¼ å…¥é¡ºåºç»„è£…ç»“æœ

ä¸æ˜¯æŒ‰å®Œæˆæ—¶é—´æ’åºã€‚

---
<br/>

**å¦‚æœä»¥åå‚æ•°å¾ˆå¤šæ€ä¹ˆåŠï¼Ÿ**

æ¯”å¦‚ 5 ä¸ªï¼š

```js
const [
  appOptions,
  countryOptions,
  productOptions,
  skuOptions,
  userOptions
] = await Promise.all([
  fn1(),
  fn2(),
  fn3(),
  fn4(),
  fn5()
]);
```

é¡ºåºå¿…é¡»ä¸¥æ ¼ä¸€è‡´ã€‚

---
<br/>

**æ›´å®‰å…¨å†™æ³•ï¼ˆå¯¹è±¡è§£æ„æ–¹æ¡ˆï¼Œé¿å…é¡ºåºé—®é¢˜ï¼‰**

å¦‚æœä½ æ‹…å¿ƒé¡ºåºé”™ä¹±ï¼Œå¯ä»¥å†™æˆï¼š

```js
const results = await Promise.all([
  this.getSelectedAppOptions(...),
  this.getSelectedCountryOptions(...),
]);

const appOptions = results[0];
const countryOptions = results[1];
```

æˆ–è€…å°è£…æˆï¼š

```js
const promises = {
  app: this.getSelectedAppOptions(...),
  country: this.getSelectedCountryOptions(...),
};

const [appOptions, countryOptions] =
  await Promise.all(Object.values(promises));
```

ä½†æœ¬è´¨ä¾ç„¶é é¡ºåºã€‚




---
æ³¨é‡Š: 0,61153 SHA-256 755bf853fa1f8a6a7bf0facc2e16ded7  
...
